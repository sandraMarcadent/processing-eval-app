/*! cornerstone-tools - 2.3.3 - 2018-04-25 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/cornerstoneTools */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneTools",[],t):"object"==typeof exports?exports.cornerstoneTools=t():e.cornerstoneTools=t()}(window,function(){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=127)}([function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.cornerstone,o=window.cornerstoneMath,r=window.Hammer;t.default={set cornerstone(e){n=e},get cornerstone(){return n},set cornerstoneMath(e){o=e},get cornerstoneMath(){return o},set Hammer(e){r=e},get Hammer(){return r}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={IMAGE_RENDERED:"cornerstoneimagerendered",NEW_IMAGE:"cornerstonenewimage",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",ELEMENT_DISABLED:"cornerstoneelementdisabled",MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_REMOVED:"cornerstonemeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonestackscroll",LINE_SAMPLE_UPDATED:"cornerstonelinesampleupdated"}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementToolStateManager=t.setElementToolStateManager=t.clearToolState=t.removeToolState=t.getToolState=t.addToolState=void 0;var n=l(a(1)),o=l(a(0)),r=a(22),i=l(a(5));function l(e){return e&&e.__esModule?e:{default:e}}function d(e){var t=o.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=r.globalImageIdSpecificToolStateManager),t.toolStateManager}t.addToolState=function(e,t,a){d(e).add(e,t,a);var o=n.default.MEASUREMENT_ADDED,r={toolType:t,element:e,measurementData:a};(0,i.default)(e,o,r)},t.getToolState=function(e,t){return d(e).get(e,t)},t.removeToolState=function(e,t,a){for(var o=d(e).get(e,t),r=-1,l=0;l<o.data.length;l++)o.data[l]===a&&(r=l);if(-1!==r){o.data.splice(r,1);var u=n.default.MEASUREMENT_REMOVED,s={toolType:t,element:e,measurementData:a};(0,i.default)(e,u,s)}},t.clearToolState=function(e,t){var a=d(e).get(e,t);void 0!==a&&(a.data=[])},t.setElementToolStateManager=function(e,t){o.default.cornerstone.getEnabledElement(e).toolStateManager=t},t.getElementToolStateManager=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.getToolOptions=function(e,t){if(!n[e])return{};var a=n[e].find(function(e){return e.element===t});return a?a.options:{}},t.setToolOptions=function(e,t,a){if(n[e]){var o=n[e].findIndex(function(e){return e.element===t});if(-1===o)n[e].push({element:t,options:a});else{var r=n[e][o].options||{};n[e][o].options=Object.assign(r,a)}}else n[e]=[{element:t,options:a}]},t.clearToolOptions=function(e,t){var a=n[e];a&&(n[e]=a.filter(function(e){return e.element!==t}))},t.clearToolOptionsByToolType=function(e){delete n[e]},t.clearToolOptionsByElement=function(e){for(var t in n)n[t]=n[t].filter(function(t){return t.element!==e})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return 0!=(t&1<<e-1)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=void 0;"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a);return e.dispatchEvent(n)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="white",o="greenyellow",r="transparent";var i={setFillColor:function(e){r=e},getFillColor:function(){return r},setToolColor:function(e){n=e},getToolColor:function(){return n},setActiveColor:function(e){o=e},getActiveColor:function(){return o},getColorIfActive:function(e){return e?o:n}};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o,i){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var l=r.default.getFont(),d=r.default.getFontSize(),u=r.default.getBackgroundColor();e.save(),e.font=l,e.textBaseline="top",e.strokeStyle=o;var s=0;t.forEach(function(t){var a=e.measureText(t).width;s=Math.max(s,a)}),e.fillStyle=u;var c={width:s+10,height:5+t.length*(d+5)};return i&&i.centering&&!0===i.centering.x&&(a-=c.width/2),i&&i.centering&&!0===i.centering.y&&(n-=c.height/2),c.left=a,c.top=n,i&&!0===i.debug&&(e.fillStyle="#FF0000"),e.fillRect(c.left,c.top,c.width,c.height),t.forEach(function(t,r){e.fillStyle=o,e.fillText(t,a+5,n+5+r*(d+5))}),e.restore(),c};var n,o=a(14),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=1,o=2;var r={setToolWidth:function(e){n=e},getToolWidth:function(){return n},setActiveWidth:function(e){o=e},getActiveWidth:function(){return o}};t.default=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r,l){e.strokeStyle=r,Object.keys(a).forEach(function(r){var d=a[r];if(!0!==d.drawnIndependently&&(!l||!0!==l.drawHandlesIfActive||d.active)){e.beginPath(),d.active?e.lineWidth=o.default.getActiveWidth():e.lineWidth=o.default.getToolWidth();var u=n.default.cornerstone.pixelToCanvas(t.element,d);e.arc(u.x,u.y,i,0,2*Math.PI),l&&l.fill&&(e.fillStyle=l.fill,e.fill()),e.stroke()}})};var n=r(a(0)),o=r(a(8));function r(e){return e&&e.__esModule?e:{default:e}}var i=6},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={},a=e.toolType;function h(t){var r=t.detail,i=r.element,l=(0,g.getToolOptions)(a,i);(0,f.default)(r.which,l.mouseButtonMask)&&(e.addNewMeasurement?e.addNewMeasurement(r):function(t){var r=o.default.cornerstone,i=t.element,l=e.createNewMeasurement(t);if(!l)return;(0,v.addToolState)(t.element,a,l),i.removeEventListener(n.default.MOUSE_MOVE,T),i.removeEventListener(n.default.MOUSE_DOWN,M),i.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,y),x&&i.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,x);r.updateImage(i);var s=void 0;s=1===Object.keys(l.handles).length?d.default:u.default;var f=void 0;f=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage;s(t,a,l,l.handles.end,function(){l.active=!1,l.invalidated=!0,(0,c.default)(t,l.handles)&&(0,v.removeToolState)(i,a,l),i.addEventListener(n.default.MOUSE_MOVE,T),i.addEventListener(n.default.MOUSE_DOWN,M),i.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,y),x&&i.addEventListener(n.default.MOUSE_DOUBLE_CLICK,x),r.updateImage(i)},f)}(r),t.preventDefault(),t.stopPropagation())}function p(t){var n=t.detail;r.default.setCoords(n);var i=(0,v.getToolState)(n.element,a);if(i){for(var d=!1,u=0;u<i.data.length;u++){var s=n.currentPoints.canvas,c=i.data[u];!0===(0,l.default)(n.element,c.handles,s)&&(d=!0),(e.pointNearTool(n.element,c,s)&&!c.active||!e.pointNearTool(n.element,c,s)&&c.active)&&(c.active=!c.active,d=!0)}!0===d&&o.default.cornerstone.updateImage(n.element)}}function E(t){var r=t.detail,l=void 0,u=r.element,m=(0,g.getToolOptions)(a,u);if((0,f.default)(r.which,m.mouseButtonMask)){var h=r.startPoints.canvas,p=(0,v.getToolState)(t.currentTarget,a);if(p){var E=void 0,M=void 0;for(M=!(!e.options||void 0===e.options.preventHandleOutsideImage)&&e.options.preventHandleOutsideImage,E=0;E<p.data.length;E++){l=p.data[E];var y=(0,i.default)(u,l.handles,h,6);if(y)return u.removeEventListener(n.default.MOUSE_MOVE,T),l.active=!0,(0,d.default)(r,a,l,y,O,M),t.stopImmediatePropagation(),t.stopPropagation(),void t.preventDefault()}if(e.pointNearTool){var x=e.options||{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1};for(E=0;E<p.data.length;E++)if((l=p.data[E]).active=!1,e.pointNearTool(u,l,h))return l.active=!0,u.removeEventListener(n.default.MOUSE_MOVE,T),(0,s.default)(t,l,p,a,x,O),t.stopImmediatePropagation(),t.stopPropagation(),void t.preventDefault()}}}function O(){l.invalidated=!0,(0,c.default)(r,l.handles)&&(0,v.removeToolState)(u,a,l),o.default.cornerstone.updateImage(u),u.addEventListener(n.default.MOUSE_MOVE,T)}}var T=e.mouseMoveCallback||p,M=e.mouseDownCallback||E,y=e.mouseDownActivateCallback||h,x=e.mouseDoubleClickCallback;var O={enable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,M),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,y),x&&t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,x),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.default.cornerstone.updateImage(t)},disable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,M),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,y),x&&t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,x),o.default.cornerstone.updateImage(t)},activate:function(t,r){(0,g.setToolOptions)(a,t,{mouseButtonMask:r}),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,M),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,y),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,T),t.addEventListener(n.default.MOUSE_DOWN,M),t.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,y),x&&(t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,x),t.addEventListener(n.default.MOUSE_DOUBLE_CLICK,x)),o.default.cornerstone.updateImage(t)},deactivate:function(t,r){(0,g.setToolOptions)(a,t,{mouseButtonMask:r});var i=n.default.TOOL_DEACTIVATED,l={mouseButtonMask:r,toolType:a,type:i};(0,m.default)(t,i,l),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,T),t.removeEventListener(n.default.MOUSE_DOWN,M),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,y),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,T),t.addEventListener(n.default.MOUSE_DOWN,M),x&&(t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,x),t.addEventListener(n.default.MOUSE_DOUBLE_CLICK,x)),e.deactivate&&e.deactivate(t,r),o.default.cornerstone.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e},mouseDownCallback:E,mouseMoveCallback:p,mouseDownActivateCallback:h};return e.pointNearTool&&(O.pointNearTool=e.pointNearTool),x&&(O.mouseDoubleClickCallback=x),e.addNewMeasurement&&(O.addNewMeasurement=e.addNewMeasurement),O};var n=h(a(1)),o=h(a(0)),r=h(a(32)),i=h(a(21)),l=h(a(27)),d=h(a(26)),u=h(a(25)),s=h(a(31)),c=h(a(13)),f=h(a(4)),v=a(2),m=h(a(5)),g=a(3);function h(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(1)),o=f(a(0)),r=f(a(13)),i=f(a(21)),l=f(a(47)),d=f(a(23)),u=f(a(48)),s=a(2),c=f(a(5));function f(e){return e&&e.__esModule?e:{default:e}}function v(e){Object.keys(e).forEach(function(t){e[t].active=!1})}function m(e){if(e)for(var t=0;t<e.data.length;t++){var a=e.data[t];a.active=!1,a.handles&&v(a.handles)}}t.default=function(e){function t(i){var l=i.detail;e.addNewMeasurement?e.addNewMeasurement(l):function(i){var l=o.default.cornerstone,u=i.element,c=e.createNewMeasurement(i);if(c){if((0,s.addToolState)(u,e.toolType,c),1===Object.keys(c.handles).length&&i.type===n.default.TAP)return c.active=!1,c.handles.end.active=!1,c.handles.end.highlight=!1,c.invalidated=!0,(0,r.default)(i,c.handles)&&(0,s.removeToolState)(u,e.toolType,c),void l.updateImage(u);u.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),u.removeEventListener(n.default.TAP,e.tapCallback||a),u.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),l.updateImage(u),(0,d.default)(i,e.toolType,c,c.handles.end,function(){c.active=!1,c.invalidated=!0,(0,r.default)(i,c.handles)&&(0,s.removeToolState)(u,e.toolType,c),u.addEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),u.addEventListener(n.default.TAP,e.tapCallback||a),u.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),l.updateImage(u)})}}(l),i.stopImmediatePropagation(),i.preventDefault()}function a(d){var c=d.detail,v=o.default.cornerstone,g=c.element,h=c.currentPoints.canvas,p=(0,s.getToolState)(d.currentTarget,e.toolType),E=void 0,T=void 0;function M(){m(p),(0,r.default)(c,E.handles)&&(0,s.removeToolState)(g,e.toolType,E),v.updateImage(g),g.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),g.addEventListener(n.default.TAP,e.tapCallback||a)}if(m(p),p)for(T=0;T<p.data.length;T++){E=p.data[T];var y=(0,i.default)(g,E.handles,h,25);if(y)return g.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),g.removeEventListener(n.default.TAP,e.tapCallback||a),E.active=!0,y.active=!0,v.updateImage(g),(0,l.default)(d,e.toolType,E,y,M),d.stopImmediatePropagation(),void d.preventDefault()}if(p&&e.pointNearTool)for(T=0;T<p.data.length;T++)if(E=p.data[T],e.pointNearTool(g,E,h))return g.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),g.removeEventListener(n.default.TAP,e.tapCallback||a),E.active=!0,v.updateImage(g),(0,u.default)(d,E,p,e.toolType,!0,M),d.stopImmediatePropagation(),void d.preventDefault();return e.touchDownActivateCallback?e.touchDownActivateCallback(d):t(d),!1}function f(t){var d=t.detail,v=o.default.cornerstone,m=d.element,g=d.startPoints.canvas,h=void 0,p=(0,s.getToolState)(t.currentTarget,e.toolType),E=void 0;function T(t,o){h.active=!1,h.invalidated=!0,(0,r.default)(d,h.handles)&&(0,s.removeToolState)(d.element,e.toolType,h),v.updateImage(d.element),m.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),m.addEventListener(n.default.TAP,e.tapCallback||a),e.pressCallback&&m.addEventListener(n.default.TOUCH_PRESS,e.pressCallback),t&&t.type===n.default.TOUCH_PRESS&&(0,c.default)(m,t.type,o)}if(p){for(E=0;E<p.data.length;E++){h=p.data[E];var M=(0,i.default)(d.element,h.handles,g,28);if(M)return m.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),m.removeEventListener(n.default.TAP,e.tapCallback||a),e.pressCallback&&m.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),h.active=!0,(0,l.default)(t,e.toolType,h,M,T),t.stopImmediatePropagation(),t.preventDefault(),void t.stopPropagation()}if(e.pointNearTool)for(E=0;E<p.data.length;E++)if(h=p.data[E],e.pointNearTool(d.element,h,g))return m.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),m.removeEventListener(n.default.TAP,e.tapCallback||a),e.pressCallback&&m.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),(0,u.default)(t,h,p,e.toolType,!0,T),t.stopImmediatePropagation(),t.preventDefault(),void t.stopPropagation()}}var v={enable:function(r){r.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),r.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),r.removeEventListener(n.default.TAP,e.tapCallback||a),r.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),e.doubleTapCallback&&r.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&r.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),o.default.cornerstone.updateImage(r)},disable:function(r){r.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),r.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),r.removeEventListener(n.default.TAP,e.tapCallback||a),e.doubleTapCallback&&r.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&r.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),o.default.cornerstone.updateImage(r)},activate:function(r){r.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),r.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),r.removeEventListener(n.default.TAP,e.tapCallback||a),r.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),r.addEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),r.addEventListener(n.default.TAP,e.tapCallback||a),e.doubleTapCallback&&(r.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),r.addEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback)),e.pressCallback&&(r.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),r.addEventListener(n.default.TOUCH_PRESS,e.pressCallback)),o.default.cornerstone.updateImage(r)},deactivate:function(r){var i=n.default.TOOL_DEACTIVATED,l={toolType:e.toolType,type:i};(0,c.default)(r,i,l),r.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.removeEventListener(n.default.TOUCH_START,e.touchStartCallback||f),r.removeEventListener(n.default.TOUCH_START_ACTIVE,e.touchDownActivateCallback||t),r.removeEventListener(n.default.TAP,e.tapCallback||a),r.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),r.addEventListener(n.default.TOUCH_START,e.touchStartCallback||f),e.doubleTapCallback&&r.removeEventListener(n.default.DOUBLE_TAP,e.doubleTapCallback),e.pressCallback&&r.removeEventListener(n.default.TOUCH_PRESS,e.pressCallback),o.default.cornerstone.updateImage(r)},touchStartCallback:e.touchStartCallback||f,touchDownActivateCallback:e.touchDownActivateCallback||t,tapCallback:e.tapCallback||a};return e.pointNearTool&&(v.pointNearTool=e.pointNearTool),e.doubleTapCallback&&(v.doubleTapCallback=e.doubleTapCallback),e.pressCallback&&(v.pressCallback=e.pressCallback),e.addNewMeasurement&&(v.addNewMeasurement=e.addNewMeasurement),v}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0,o=void 0,r=void 0;var i={setStartLoadHandler:function(e){n=e},getStartLoadHandler:function(){return n},setEndLoadHandler:function(e){o=e},getEndLoadHandler:function(){return o},setErrorLoadingHandler:function(e){r=e},getErrorLoadingHandler:function(){return r}};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.image,n={left:0,top:0,width:a.width,height:a.height},o=!1;return Object.keys(t).forEach(function(e){var a=t[e];!0!==a.allowedOutsideImage&&!1===r.default.cornerstoneMath.point.insideRect(a,n)&&(o=!0)}),o};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=15,o=n+"px Arial",r="transparent";var i={setFont:function(e){o=e},getFont:function(){return o},setFontSize:function(e){n=e},getFontSize:function(){return n},setBackgroundColor:function(e){r=e},getBackgroundColor:function(){return r}};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t)throw new Error("simpleMouseButtonTool: toolType is required");var a={};return{activate:function(a,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o.mouseButtonMask=n,(0,i.setToolOptions)(t,a,o),a.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,e),a.addEventListener(r.default.MOUSE_DOWN_ACTIVATE,e)},disable:function(t){t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,e)},enable:function(t){t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,e)},deactivate:function(t){t.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,e)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n},i=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=[r.default.TOUCH_DRAG];return a&&!0===a.fireOnTouchStart&&n.push(r.default.TOUCH_START),{activate:function(o){a&&a.eventData&&(0,i.setToolOptions)(t,o,a.eventData),n.forEach(function(t){o.removeEventListener(t,e),o.addEventListener(t,e)}),a&&a.activateCallback&&a.activateCallback(o)},disable:function(t){n.forEach(function(a){t.removeEventListener(a,e)}),a&&a.disableCallback&&a.disableCallback(t)},enable:function(t){n.forEach(function(a){t.removeEventListener(a,e)}),a&&a.enableCallback&&a.enableCallback(t)},deactivate:function(t){n.forEach(function(a){t.removeEventListener(a,e)}),a&&a.deactivateCallback&&a.deactivateCallback(t)}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n},i=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=r.default.cornerstoneMath;if(e instanceof t.Vector3)return e;return new t.Vector3(e[0],e[1],e[2])};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=r.default.cornerstone,n=a.metaData.get("patientStudyModule",e.imageId),o=a.metaData.get("generalSeriesModule",e.imageId);if(n&&o&&"PT"===o.modality){var l=t*e.slope+e.intercept,d=n.patientWeight;if(d){var u=a.metaData.get("petIsotopeModule",e.imageId);if(u){var s=u.radiopharmaceuticalInfo,c=s.radiopharmaceuticalStartTime,f=s.radionuclideTotalDose,v=s.radionuclideHalfLife,m=o.seriesTime;if(c&&f&&v&&m){var g=i(m.fractionalSeconds||0)+m.seconds+60*m.minutes+60*m.hours*60-(i(c.fractionalSeconds)+c.seconds+60*c.minutes+60*c.hours*60);return l*d/(f*Math.exp(-g*Math.log(2)/v))*1e3}}}}};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n};function i(e){return parseFloat("."+e)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.boundingBox)return r.default.cornerstoneMath.point.insideRect(t,e.boundingBox)};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{disable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e)},enable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e),t.addEventListener(n.default.IMAGE_RENDERED,e),o.default.cornerstone.updateImage(t)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var n=r(a(1)),o=r(a(0));function r(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r){var i=void 0;if(t)return Object.keys(t).forEach(function(l){var d=t[l];if(d.hasOwnProperty("pointNearHandle")){if(d.pointNearHandle(e,d,a))return void(i=d)}else if(!0===d.hasBoundingBox){if((0,o.default)(d,a))return void(i=d)}else{var u=n.default.cornerstone.pixelToCanvas(e,d);if(n.default.cornerstoneMath.point.distance(u,a)<=r)return void(i=d)}}),i};var n=r(a(0)),o=r(a(19));function r(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalImageIdSpecificToolStateManager=t.newImageIdSpecificToolStateManager=void 0;var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n};function i(){var e={};return{get:function(t,a){var n=r.default.cornerstone.getEnabledElement(t);if(n.image&&!1!==e.hasOwnProperty(n.image.imageId)){var o=e[n.image.imageId];if(!1!==o.hasOwnProperty(a))return o[a]}},add:function(t,a,n){var o=r.default.cornerstone.getEnabledElement(t);o.image&&!1!==e.hasOwnProperty(o.image.imageId)||(e[o.image.imageId]={});var i=e[o.image.imageId];!1===i.hasOwnProperty(a)&&(i[a]={data:[]}),i[a].data.push(n)},clear:function(t){var a=r.default.cornerstone.getEnabledElement(t);a.image&&!1!==e.hasOwnProperty(a.image.imageId)&&delete e[a.image.imageId]},saveImageIdToolState:function(t){return e[t]},restoreImageIdToolState:function(t,a){e[t]=a},saveToolState:function(){return e},restoreToolState:function(t){e=t},toolState:e}}var l=i();t.newImageIdSpecificToolStateManager=i,t.globalImageIdSpecificToolStateManager=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i,l,d){var u=o.default.cornerstone,s=e.element,c=u.pageToPixel(s,e.currentPoints.page.x,e.currentPoints.page.y+50),f={x:i.x-c.x,y:i.y-c.y};function v(e){var o=e.detail;i.x=o.currentPoints.image.x+f.x,i.y=o.currentPoints.image.y+f.y,d&&(i.x=Math.max(i.x,0),i.x=Math.min(i.x,o.image.width),i.y=Math.max(i.y,0),i.y=Math.min(i.y,o.image.height)),u.updateImage(s);var l=n.default.MEASUREMENT_MODIFIED,c={toolType:t,element:s,measurementData:a};(0,r.default)(s,l,c)}function m(e){var t=e.detail;if(s.removeEventListener(n.default.TOUCH_DRAG,v),s.removeEventListener(n.default.TOUCH_PINCH,m),s.removeEventListener(n.default.TOUCH_END,m),s.removeEventListener(n.default.TAP,m),s.removeEventListener(n.default.TOUCH_START,g),s.removeEventListener(n.default.TOOL_DEACTIVATED,h),e.type===n.default.TOUCH_PINCH||e.type===n.default.TOUCH_PRESS)return i.active=!1,u.updateImage(s),void l();i.active=!1,a.active=!1,i.x=t.currentPoints.image.x+f.x,i.y=t.currentPoints.image.y+f.y,d&&(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.image.width),i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.image.height)),u.updateImage(s),"function"==typeof l&&l()}function g(e){return e.stopImmediatePropagation(),!1}function h(){s.removeEventListener(n.default.TOUCH_DRAG,v),s.removeEventListener(n.default.TOUCH_PINCH,m),s.removeEventListener(n.default.TOUCH_END,m),s.removeEventListener(n.default.TAP,m),s.removeEventListener(n.default.TOUCH_START,g),s.removeEventListener(n.default.TOOL_DEACTIVATED,h),i.active=!1,a.active=!1,i.x=e.currentPoints.image.x+f.x,i.y=e.currentPoints.image.y+f.y,d&&(i.x=Math.max(i.x,0),i.x=Math.min(i.x,e.image.width),i.y=Math.max(i.y,0),i.y=Math.min(i.y,e.image.height)),u.updateImage(s)}i.active=!0,a.active=!0,s.addEventListener(n.default.TOUCH_DRAG,v),s.addEventListener(n.default.TOUCH_PINCH,m),s.addEventListener(n.default.TOUCH_END,m),s.addEventListener(n.default.TAP,m),s.addEventListener(n.default.TOUCH_START,g),s.addEventListener(n.default.TOOL_DEACTIVATED,h)};var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(r.default.MOUSE_WHEEL,e),t.addEventListener(r.default.MOUSE_WHEEL,e)},disable:function(t){t.removeEventListener(r.default.MOUSE_WHEEL,e)},enable:function(t){t.removeEventListener(r.default.MOUSE_WHEEL,e)},deactivate:function(t){t.removeEventListener(r.default.MOUSE_WHEEL,e)}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i,l,d){var u=o.default.cornerstone,s=e.element;function c(e){var o=e.detail;i.active=!0,i.x=o.currentPoints.image.x,i.y=o.currentPoints.image.y,d&&(i.x=Math.max(i.x,0),i.x=Math.min(i.x,o.image.width),i.y=Math.max(i.y,0),i.y=Math.min(i.y,o.image.height)),u.updateImage(s);var l=n.default.MEASUREMENT_MODIFIED,c={toolType:t,element:s,measurementData:a};(0,r.default)(s,l,c)}function f(e){s.removeEventListener(n.default.MOUSE_MOVE,f),s.removeEventListener(n.default.MOUSE_DRAG,f),s.addEventListener(n.default.MOUSE_MOVE,c),s.addEventListener(n.default.MOUSE_DRAG,c),s.addEventListener(n.default.MOUSE_CLICK,g),e.type===n.default.MOUSE_DRAG&&s.addEventListener(n.default.MOUSE_UP,g)}function v(e){e.detail.measurementData===a&&g()}function m(e){e.detail.toolType===t&&(s.removeEventListener(n.default.MOUSE_MOVE,c),s.removeEventListener(n.default.MOUSE_DRAG,c),s.removeEventListener(n.default.MOUSE_CLICK,g),s.removeEventListener(n.default.MOUSE_UP,g),s.removeEventListener(n.default.MEASUREMENT_REMOVED,v),s.removeEventListener(n.default.TOOL_DEACTIVATED,m),i.active=!1,u.updateImage(s))}function g(){s.removeEventListener(n.default.MOUSE_MOVE,c),s.removeEventListener(n.default.MOUSE_DRAG,c),s.removeEventListener(n.default.MOUSE_CLICK,g),s.removeEventListener(n.default.MOUSE_UP,g),s.removeEventListener(n.default.MEASUREMENT_REMOVED,v),s.removeEventListener(n.default.TOOL_DEACTIVATED,m),i.active=!1,u.updateImage(s),"function"==typeof l&&l()}s.addEventListener(n.default.MOUSE_DRAG,f),s.addEventListener(n.default.MOUSE_MOVE,f),s.addEventListener(n.default.MEASUREMENT_REMOVED,v),s.addEventListener(n.default.TOOL_DEACTIVATED,m)};var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i,l,d){var u=o.default.cornerstone,s=e.element,c={x:i.x-e.currentPoints.image.x,y:i.y-e.currentPoints.image.y};function f(e){var o=e.detail;!1===i.hasMoved&&(i.hasMoved=!0),i.active=!0,i.x=o.currentPoints.image.x+c.x,i.y=o.currentPoints.image.y+c.y,d&&(i.x=Math.max(i.x,0),i.x=Math.min(i.x,o.image.width),i.y=Math.max(i.y,0),i.y=Math.min(i.y,o.image.height)),u.updateImage(s);var l=n.default.MEASUREMENT_MODIFIED,f={toolType:t,element:s,measurementData:a};(0,r.default)(s,l,f)}function v(){i.active=!1,s.removeEventListener(n.default.MOUSE_DRAG,f),s.removeEventListener(n.default.MOUSE_UP,v),s.removeEventListener(n.default.MOUSE_CLICK,v),u.updateImage(s),"function"==typeof l&&l()}s.addEventListener(n.default.MOUSE_DRAG,f),s.addEventListener(n.default.MOUSE_UP,v),s.addEventListener(n.default.MOUSE_CLICK,v)};var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){n||(n=6);var o=function(e){var t=void 0;return Object.keys(e).forEach(function(a){var n=e[a];!0!==n.active||(t=n)}),t}(t),i=(0,r.default)(e,t,a,n);return o!==i&&(void 0!==i&&(i.active=!0),void 0!==o&&(o.active=!1),!0)};var n,o=a(21),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0,o={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function r(){var e=navigator.userAgent,t=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],a=void 0;return/trident/i.test(t[1])?"IE "+((a=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""):"Chrome"===t[1]&&null!==(a=e.match(/\b(OPR|Edge)\/(\d+)/))?a.slice(1).join(" ").replace("OPR","Opera"):(t=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(a=e.match(/version\/(\d+)/i))&&t.splice(1,1,a[1]),t.join(" "))}function i(){var e=r().split(" "),t=e[0],a=e[1],n=o[t];return n?n[a]?n[a]:n.default:o.default}t.getDefaultSimultaneousRequests=i,t.getMaxSimultaneousRequests=function(){return n||i()},t.setMaxSimultaneousRequests=function(e){n=e},t.getBrowserInfo=r,t.isMobileDevice=function(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a={},n=[r.default.MULTI_TOUCH_DRAG];return t&&!0===t.fireOnTouchStart&&n.push(r.default.MULTI_TOUCH_START),{activate:function(a){n.forEach(function(t){a.removeEventListener(t,e),a.addEventListener(t,e)}),t&&t.activateCallback&&t.activateCallback(a)},disable:function(a){n.forEach(function(t){a.removeEventListener(t,e)}),t&&t.disableCallback&&t.disableCallback(a)},enable:function(a){n.forEach(function(t){a.removeEventListener(t,e)}),t&&t.enableCallback&&t.enableCallback(a)},deactivate:function(a){n.forEach(function(t){a.removeEventListener(t,e)}),t&&t.deactivateCallback&&t.deactivateCallback(a)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var i=(0,o.getToolState)(e,"timeSeries");if(i&&i.data&&i.data.length){var l=n.default.cornerstone,d=i.data[0],u=d.stacks[d.currentStackIndex].currentImageIdIndex,s=d.currentStackIndex+t;if(a?(s>=d.stacks.length&&(s=0),s<0&&(s=d.stacks.length-1)):(s=Math.min(d.stacks.length-1,s),s=Math.max(0,s)),s!==d.currentStackIndex){var c=l.getViewport(e),f=d.stacks[s],v=r.default.getStartLoadHandler(),m=r.default.getEndLoadHandler(),g=r.default.getErrorLoadingHandler();v&&v(e);(!0===f.preventCache?l.loadImage(f.imageIds[u]):l.loadAndCacheImage(f.imageIds[u])).then(function(t){d.currentImageIdIndex!==u&&(f.currentImageIdIndex=u,d.currentStackIndex=s,l.displayImage(e,t,c),m&&m(e,t))},function(t){var a=f.imageIds[u];g&&g(e,a,t)})}}};var n=i(a(0)),o=a(2),r=i(a(12));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,d,u,s){var c=o.default.cornerstone,f=e.detail.element;function v(e){var a=e.detail;t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=a.deltaPoints.image.x,n.y+=a.deltaPoints.image.y,!0===u.preventHandleOutsideImage&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,a.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,a.image.height)))}),c.updateImage(f);var o=n.default.MEASUREMENT_MODIFIED,r={toolType:d,element:f,measurementData:t};(0,l.default)(f,o,r),e.preventDefault(),e.stopPropagation()}function m(e){var a=e.detail;t.invalidated=!0,f.removeEventListener(n.default.MOUSE_DRAG,v),f.removeEventListener(n.default.MOUSE_UP,m),f.removeEventListener(n.default.MOUSE_CLICK,m),!0===u.deleteIfHandleOutsideImage&&(0,r.default)(a,t.handles)&&(0,i.removeToolState)(f,d,t),c.updateImage(f),"function"==typeof s&&s()}return f.addEventListener(n.default.MOUSE_DRAG,v),f.addEventListener(n.default.MOUSE_UP,m),f.addEventListener(n.default.MOUSE_CLICK,m),!0};var n=d(a(1)),o=d(a(0)),r=d(a(13)),i=a(2),l=d(a(5));function d(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;var o={setCoords:function(e){n=e.currentPoints.canvas},getCoords:function(){return n}};t.default=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{page:r.default.cornerstoneMath.point.copy(e.page),image:r.default.cornerstoneMath.point.copy(e.image),client:r.default.cornerstoneMath.point.copy(e.client),canvas:r.default.cornerstoneMath.point.copy(e.canvas)}};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),a=Math.round(a);var i=r.default.cornerstone.getEnabledElement(e),l=[],d=0,u=i.image.getPixelData(),s=void 0,c=void 0,f=void 0;if(i.image.color)for(c=0;c<o;c++)for(f=0;f<n;f++){var v=u[s=4*((c+a)*i.image.columns+(f+t))],m=u[s+1],g=u[s+2],h=u[s+3];l[d++]=v,l[d++]=m,l[d++]=g,l[d++]=h}return l};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.width/2,n=e.height/2;if(a<=0||n<=0)return!1;var o=e.left+a,r=e.top+n,i=t.x-o,l=t.y-r;return i*i/(a*a)+l*l/(n*n)<=1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=Math.pow(10,t);return Math.round(e*a)/a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=(0,i.getToolState)(e,"stack");if(o&&o.data&&o.data.length){var l=o.data[0];l.pending||(l.pending=[]);var d=l.currentImageIdIndex+t;if(a)d%=l.imageIds.length;else d=Math.min(l.imageIds.length-1,d),d=Math.max(0,d);if(n)(0,r.default)(e,d);else{var u={index:d};l.pending.push(u),function e(t,a,n){if(t.pending[0]===a){if(t.currentImageIdIndex===a.index)return t.pending.splice(t.pending.indexOf(a),1),void(t.pending.length>0&&e(t,t.pending[0],n));n.addEventListener("cornerstonenewimage",function e(o){t.imageIds.indexOf(o.detail.image.imageId)===a.index&&(t.pending.splice(t.pending.indexOf(a),1),n.removeEventListener("cornerstonenewimage",e),t.pending.length>0&&function e(t,a,n){if(t.pending[0]===a){if(t.currentImageIdIndex===a.index)return t.pending.splice(t.pending.indexOf(a),1),void(t.pending.length>0&&e(t,t.pending[0],n));n.addEventListener("cornerstonenewimage",function o(r){t.imageIds.indexOf(r.detail.image.imageId)===a.index&&(t.pending.splice(t.pending.indexOf(a),1),n.removeEventListener("cornerstonenewimage",o),t.pending.length>0&&e(t,t.pending[0],n))}),(0,r.default)(n,a.index)}}(t,t.pending[0],n))}),(0,r.default)(n,a.index)}}(l,u,e)}}};var n,o=a(55),r=(n=o)&&n.__esModule?n:{default:n},i=a(2);function l(e,t,a){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index){e.pending.splice(e.pending.indexOf(t),1);if(e.pending.length>0){l(e,e.pending[0],a)}return}var n=function n(o){var r;if(e.imageIds.indexOf(o.detail.image.imageId)===t.index){e.pending.splice(e.pending.indexOf(t),1);a.removeEventListener("cornerstonenewimage",n);if(e.pending.length>0){l(e,e.pending[0],a)}}};a.addEventListener("cornerstonenewimage",n);(0,r.default)(a,t.index)}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n},i=a(28);var l={interaction:[],thumbnail:[],prefetch:[]},d={interaction:0,thumbnail:0,prefetch:0},u={interaction:6,thumbnail:6,prefetch:5},s=!1,c=20;function f(){s&&setTimeout(function(){m()},c)}function v(e){var t=r.default.cornerstone,a=e.type;d[a]++,s=!0;var n=e.imageId,o=e.doneCallback,i=e.failCallback,l=t.imageCache.getImageLoadObject(n);if(l)l.promise.then(function(e){d[a]--,o(e),f()},function(e){d[a]--,i(e),f()});else{var u=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e);(!0===e.preventCache?t.loadImage(n,{priority:u,type:e.type}):t.loadAndCacheImage(n,{priority:u,type:e.type})).then(function(e){d[a]--,o(e),f()},function(e){d[a]--,i(e),f()})}}function m(){var e=(0,i.getMaxSimultaneousRequests)();u={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=e-(d.interaction+d.thumbnail+d.prefetch),a=0;a<t;a++){var n=g();n&&v(n)}}function g(){return l.interaction.length&&d.interaction<u.interaction?l.interaction.shift():l.thumbnail.length&&d.thumbnail<u.thumbnail?l.thumbnail.shift():l.prefetch.length&&d.prefetch<u.prefetch?l.prefetch.shift():(l.interaction.length||l.thumbnail.length||l.prefetch.length||(s=!1),!1)}t.default={addRequest:function(e,t,a,n,o,i,d){if(!l.hasOwnProperty(a))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var u={type:a,imageId:t,preventCache:n,doneCallback:o,failCallback:i},c=r.default.cornerstone.imageCache.getImageLoadObject(t);c?c.promise.then(function(e){o(e)},function(e){i(e)}):(d?l[a].unshift(u):l[a].push(u),s=!0)}},clearRequestStack:function(e){if(!l.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");l[e]=[]},startGrabbing:m,getRequestPool:function(){return l}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.projectPatientPointToImagePlane=function(e,t){var a=(0,o.default)(t.rowCosines),n=(0,o.default)(t.columnCosines),r=(0,o.default)(t.imagePositionPatient),i=e.clone().sub(r),l=a.dot(i)/t.columnPixelSpacing,d=n.dot(i)/t.rowPixelSpacing;return{x:l,y:d}},t.imagePointToPatientPoint=i,t.planePlaneIntersection=function(e,t){var a=(0,o.default)(e.rowCosines),r=(0,o.default)(e.columnCosines),l=(0,o.default)(e.imagePositionPatient),d=(0,o.default)(t.rowCosines),u=(0,o.default)(t.columnCosines),s=(0,o.default)(t.imagePositionPatient),c=a.clone().cross(r),f=new n.default.cornerstoneMath.Plane;f.setFromNormalAndCoplanarPoint(c,l);var v=d.clone().cross(u),m=new n.default.cornerstoneMath.Plane;m.setFromNormalAndCoplanarPoint(v,s);var g=m.clone().intersectPlane(f),h=g.origin,p=g.direction,E=i({x:t.columns,y:t.rows},t),T=s.distanceTo(E),M=new n.default.cornerstoneMath.Line3;M.start=h,M.end=h.clone().add(p.multiplyScalar(T));var y=function(e){var t=i({x:0,y:0},e),a=i({x:e.columns,y:0},e),o=i({x:0,y:e.rows},e),r=i({x:e.columns,y:e.rows},e);return{top:new n.default.cornerstoneMath.Line3(t,a),left:new n.default.cornerstoneMath.Line3(t,o),right:new n.default.cornerstoneMath.Line3(a,r),bottom:new n.default.cornerstoneMath.Line3(o,r)}}(t),x=function(e,t){var a=[];return Object.keys(t).forEach(function(n){var o=t[n],r=e.intersectLine(o);r&&a.push(r)}),a}(M,y);if(2!==x.length)return;return{start:x[0],end:x[1]}};var n=r(a(0)),o=r(a(17));function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var a=(0,o.default)(t.rowCosines),n=(0,o.default)(t.columnCosines),r=(0,o.default)(t.imagePositionPatient),i=a.clone().multiplyScalar(e.x);i.multiplyScalar(t.columnPixelSpacing);var l=n.clone().multiplyScalar(e.y);l.multiplyScalar(t.rowPixelSpacing);var d=i.add(l);return d.add(r),d}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawBrushOnCanvas=t.drawBrushPixels=void 0;var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n};t.drawBrushPixels=function(e,t,a,n){e.forEach(function(e){var o,r=(o=e[0],e[1]*n+o);t[r]=a})},t.drawBrushOnCanvas=function(e,t,a,n){var o=r.default.cornerstone.pixelToCanvas(n,{x:0,y:0}),i=r.default.cornerstone.pixelToCanvas(n,{x:1,y:1}),l=i.x-o.x,d=i.y-o.y;t.save(),t.fillStyle=a,e.forEach(function(e){var a=r.default.cornerstone.pixelToCanvas(n,{x:e[0],y:e[1]});t.fillRect(a.x,a.y,l,d)}),t.restore()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=Math.round(n),i=Math.round(o);if(1===e)return[[r,i]];for(var l=[],d=0,u=-e;u<=e;u++){var s=i+u;if(!(s>t||s<0))for(var c=-e;c<=e;c++){var f=r+c;f>a||f<0||c*c+u*u<e*e&&(l[d++]=[r+c,i+u])}}return l}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.toolType;function a(t){e.onMouseMove(t)}function u(t){var o=t.detail,r=o.element;e.onMouseUp(t),r.removeEventListener(n.default.MOUSE_DRAG,a),r.removeEventListener(n.default.MOUSE_DRAG,f),r.removeEventListener(n.default.MOUSE_UP,u),r.removeEventListener(n.default.MOUSE_CLICK,u)}function f(t){return e.onDrag(t),!1}function v(o){var r=o.detail,i=r.element,s=(0,d.getToolOptions)(t,i);if((0,l.default)(r.which,s.mouseButtonMask))return i.addEventListener(n.default.MOUSE_DRAG,f),i.addEventListener(n.default.MOUSE_UP,u),i.addEventListener(n.default.MOUSE_CLICK,u),e.onMouseDown(o),!1;i.addEventListener(n.default.MOUSE_DRAG,a),i.addEventListener(n.default.MOUSE_UP,u)}function m(t){var a=t.detail,n=a.element,i=(0,r.getToolState)(n,s),l=void 0;i?l=i.data[0].pixelData:(l=new Uint8ClampedArray(a.image.width*a.image.height),(0,r.addToolState)(n,s,{pixelData:l}));var d=o.default.cornerstone.getLayer(a.element,c);d.image.setPixelData(l),d.invalid=!0,o.default.cornerstone.updateImage(n),e.onImageRendered(t)}var g=(0,i.default)({mouseMoveCallback:a,mouseDownActivateCallback:v,onImageRendered:m,deactivate:function(e){e.removeEventListener(n.default.IMAGE_RENDERED,m),e.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,v),e.removeEventListener(n.default.MOUSE_MOVE,a)}});return g.activate=function(e,i){(0,d.setToolOptions)(t,e,{mouseButtonMask:i}),e.removeEventListener(n.default.IMAGE_RENDERED,m),e.addEventListener(n.default.IMAGE_RENDERED,m),e.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,v),e.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,v),e.removeEventListener(n.default.MOUSE_MOVE,a),e.addEventListener(n.default.MOUSE_MOVE,a);var l=o.default.cornerstone.getEnabledElement(e),u=l.image,f=u.width,h=u.height,p=new Uint8ClampedArray(f*h),E=g.getConfiguration(),T=E.colormapId;if(!T){T="BrushColorMap";var M=o.default.cornerstone.colors.getColormap(T);M.setNumberOfColors(2),M.setColor(0,[0,0,0,0]),M.setColor(1,[255,0,0,255])}var y={minPixelValue:0,maxPixelValue:1,slope:1,intercept:0,getPixelData:function(){return p},rows:l.image.height,columns:l.image.width,height:h,width:f,pixelData:p,setPixelData:function(e){p=e},colormap:T,color:!1,rgba:!1,labelmap:!0,invert:!1,columnPixelSpacing:1,rowPixelSpacing:1,sizeInBytes:l.image.width*l.image.height},x=void 0;c&&(x=o.default.cornerstone.getLayer(e,c)),x||(c=o.default.cornerstone.addLayer(e,y,{viewport:{pixelReplication:!0}})),(0,r.addToolState)(e,s,{pixelData:p}),E.brushLayerId=c,g.setConfiguration(E),o.default.cornerstone.updateImage(e)},g};var n=u(a(1)),o=u(a(0)),r=a(2),i=u(a(10)),l=u(a(4)),d=a(3);function u(e){return e&&e.__esModule?e:{default:e}}var s="brush",c=void 0},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(r.default.TOUCH_PINCH,e),t.addEventListener(r.default.TOUCH_PINCH,e)},disable:function(t){t.removeEventListener(r.default.TOUCH_PINCH,e)},enable:function(t){t.removeEventListener(r.default.TOUCH_PINCH,e)},deactivate:function(t){t.removeEventListener(r.default.TOUCH_PINCH,e)}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=e.toolType;function m(o){var r=o.detail,i=r.element,l=(0,v.getToolOptions)(a,i);if((0,c.default)(r.which,l.mouseButtonMask))return function(o){var r=o.element,i=e.createNewMeasurement(o);i&&((0,f.addToolState)(o.element,a,i),r.removeEventListener(n.default.MOUSE_MOVE,g),(0,d.default)(o,a,i,i.handles.end,function(){i.active=!1,(0,s.default)(o,i.handles)&&(0,f.removeToolState)(o.element,a,i),r.addEventListener(n.default.MOUSE_MOVE,g)},t))}(r),!1}function g(t){var n=t.detail;r.default.setCoords(n);var i=(0,f.getToolState)(n.element,a);if(void 0!==i){for(var d=!1,u=n.currentPoints.canvas,s=0;s<i.data.length;s++){var c=i.data[s];!0===(0,l.default)(n.element,c.handles,u)&&(d=!0),(e.pointInsideRect(n.element,c,u)&&!c.active||!e.pointInsideRect(n.element,c,u)&&c.active)&&(c.active=!c.active,d=!0)}!0===d&&o.default.cornerstone.updateImage(n.element)}}function h(r){var l=r.detail,m=l.element,h=o.default.cornerstone,p=void 0,E=(0,v.getToolOptions)(a,m);if((0,c.default)(l.which,E.mouseButtonMask)){var T=l.startPoints.canvas,M=(0,f.getToolState)(r.currentTarget,a),y=void 0;if(void 0!==M)for(y=0;y<M.data.length;y++){p=M.data[y];var x=(0,i.default)(l.element,p.handles,T,25);if(void 0!==x)return m.removeEventListener(n.default.MOUSE_MOVE,g),p.active=!0,(0,d.default)(l,a,p,x,_,t),r.stopImmediatePropagation(),!1}var O={deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:t};if(void 0!==M&&void 0!==e.pointInsideRect)for(y=0;y<M.data.length;y++)if(p=M.data[y],e.pointInsideRect(l.element,p,T))return m.removeEventListener(n.default.MOUSE_MOVE,g),(0,u.default)(r,p,M,a,O,_),m.addEventListener(n.default.MOUSE_MOVE,g),r.stopImmediatePropagation(),!1}function _(){p.active=!1,(0,s.default)(l,p.handles)&&(0,f.removeToolState)(l.element,a,p),h.updateImage(l.element),m.addEventListener(n.default.MOUSE_MOVE,g)}}return{enable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,h),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),o.default.cornerstone.updateImage(t)},disable:function(t){t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,h),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),o.default.cornerstone.updateImage(t)},activate:function(t,r){(0,v.setToolOptions)(a,t,{mouseButtonMask:r}),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,h),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,g),t.addEventListener(n.default.MOUSE_DOWN,h),t.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),o.default.cornerstone.updateImage(t)},deactivate:function(t,r){(0,v.setToolOptions)(a,t,{mouseButtonMask:r}),t.removeEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.removeEventListener(n.default.MOUSE_MOVE,g),t.removeEventListener(n.default.MOUSE_DOWN,h),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,m),t.addEventListener(n.default.IMAGE_RENDERED,e.onImageRendered),t.addEventListener(n.default.MOUSE_MOVE,g),t.addEventListener(n.default.MOUSE_DOWN,h),o.default.cornerstone.updateImage(t)}}};var n=m(a(1)),o=m(a(0)),r=m(a(32)),i=m(a(21)),l=m(a(27)),d=m(a(26)),u=m(a(31)),s=m(a(13)),c=m(a(4)),f=a(2),v=a(3);function m(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{activate:function(t){t.removeEventListener(r.default.DOUBLE_TAP,e),t.addEventListener(r.default.DOUBLE_TAP,e)},disable:function(t){t.removeEventListener(r.default.DOUBLE_TAP,e)},enable:function(t){t.removeEventListener(r.default.DOUBLE_TAP,e)},deactivate:function(t){t.removeEventListener(r.default.DOUBLE_TAP,e)}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=2e3,o={mouse:0,touch:1},r=void 0,i=void 0;function l(e,t){var a=Date.now();if(e!==r){if(a-i<=n)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;r=e}i=a}var d=l.bind(null,o.mouse),u=l.bind(null,o.touch);function s(e,t,a){var n=a?d:u;t.forEach(function(t){e.addEventListener(t,n)})}function c(e,t,a){var n=a?d:u;t.forEach(function(t){e.removeEventListener(t,n)})}var f=["mousedown","mouseup"],v=["touchstart","touchend"];function m(e){c(e,f,o.mouse),c(e,v,o.touch)}var g={enable:function(e){m(e),s(e,f,o.mouse),s(e,v,o.touch)},disable:m};t.default=g},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i,u){l.value=!0;var s=e.detail,c=o.default.cornerstone,f=s.element,v=c.getEnabledElement(f),m=((new Date).getTime(),-57),g={x:s.currentPoints.page.x,y:s.currentPoints.page.y+m},h=c.pageToPixel(f,g.x,g.y);function p(e){var o=e.detail;l.value=!1,!1===i.hasMoved&&(i.hasMoved=!0),i.active=!0;var d=o.currentPoints,u={x:d.page.x,y:d.page.y+m};h=c.pageToPixel(f,u.x,u.y),i.x=h.x,i.y=h.y,c.updateImage(f);var s=n.default.MEASUREMENT_MODIFIED,v={toolType:t,element:f,measurementData:a};(0,r.default)(f,s,v)}function E(e){var t=e.detail;l.value=!1,i.active=!1,f.removeEventListener(n.default.TOUCH_DRAG,p),d.forEach(function(e){f.removeEventListener(e,E)}),c.updateImage(f),e.type===n.default.TOUCH_PRESS&&(t.handlePressed=a,i.x=s.currentPoints.image.x,i.y=s.currentPoints.image.y),"function"==typeof u&&u(e)}f.addEventListener(n.default.TOUCH_DRAG,p),d.forEach(function(e){f.addEventListener(e,E)}),function e(t,a,n,r,i){if(!n.value)return;var l=o.default.cornerstone;var d=(new Date).getTime();var u=Math.abs(a.y-i.y);var s=u/10;if(u<1)return a.y=i.y,void(n.value=!1);a.y>i.y?a.y-=s:a.y<i.y&&(a.y+=s);l.updateImage(r.element);l.requestAnimationFrame(function(){e(d,a,n,r,i)})}(0,i,l,v,h)};var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}var l={value:!1},d=[n.default.TOUCH_END,n.default.TOUCH_DRAG_END,n.default.TOUCH_PINCH,n.default.TOUCH_PRESS,n.default.TAP]},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,d,u,s){var c=e.detail.element,f=o.default.cornerstone;function v(e){var a=e.detail;t.active=!0,Object.keys(t.handles).forEach(function(e){var n=t.handles[e];!0!==n.movesIndependently&&(n.x+=a.deltaPoints.image.x,n.y+=a.deltaPoints.image.y)}),f.updateImage(c);var o=n.default.MEASUREMENT_MODIFIED,r={toolType:d,element:c,measurementData:t};(0,l.default)(c,o,r),e.preventDefault(),e.stopPropagation()}function m(e){var a=e.detail;t.active=!1,t.invalidated=!1,c.removeEventListener(n.default.TOUCH_DRAG,v),c.removeEventListener(n.default.TOUCH_PINCH,m),c.removeEventListener(n.default.TOUCH_PRESS,m),c.removeEventListener(n.default.TOUCH_END,m),c.removeEventListener(n.default.TOUCH_DRAG_END,m),c.removeEventListener(n.default.TAP,m);var o=(0,r.default)(a,t.handles);!0===u&&!0===o&&(0,i.removeToolState)(c,d,t),f.updateImage(c),"function"==typeof s&&s(e)}return c.addEventListener(n.default.TOUCH_DRAG,v),c.addEventListener(n.default.TOUCH_PINCH,m),c.addEventListener(n.default.TOUCH_PRESS,m),c.addEventListener(n.default.TOUCH_END,m),c.addEventListener(n.default.TOUCH_DRAG_END,m),c.addEventListener(n.default.TAP,m),!0};var n=d(a(1)),o=d(a(0)),r=d(a(13)),i=a(2),l=d(a(5));function d(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return{activate:function(t){t.removeEventListener(r.default.KEY_DOWN,e),t.addEventListener(r.default.KEY_DOWN,e)},disable:function(t){t.removeEventListener(r.default.KEY_DOWN,e)},enable:function(t){t.removeEventListener(r.default.KEY_DOWN,e)},deactivate:function(t){t.removeEventListener(r.default.KEY_DOWN,e)},getConfiguration:function(){return t},setConfiguration:function(e){t=e}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var a=0,n=0,o=0,i=0,l=t.top;l<t.top+t.height;l++)for(var d=t.left;d<t.left+t.width;d++){var u={x:d,y:l};(0,r.default)(t,u)&&(a+=e[i],n+=e[i]*e[i],o++),i++}if(0===o)return{count:o,mean:0,variance:0,stdDev:0};var s=a/o,c=n/o-s*s;return{count:o,mean:s,variance:c,stdDev:Math.sqrt(c)}};var n,o=a(35),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){var r=Math.atan2(a.y-t.y,a.x-t.x);e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(a.x,a.y),e.strokeStyle=n,e.lineWidth=o,e.stroke(),e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(a.x-10*Math.cos(r-Math.PI/7),a.y-10*Math.sin(r-Math.PI/7)),e.lineTo(a.x-10*Math.cos(r+Math.PI/7),a.y-10*Math.sin(r+Math.PI/7)),e.lineTo(a.x,a.y),e.lineTo(a.x-10*Math.cos(r-Math.PI/7),a.y-10*Math.sin(r-Math.PI/7)),e.strokeStyle=n,e.lineWidth=o,e.stroke(),e.fillStyle=n,e.fill()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){e.beginPath(),e.strokeStyle=a,e.lineWidth=n,e.arc(t.x,t.y,6,0,2*Math.PI),e.stroke()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){var r=n/2*.5522848,i=o/2*.5522848,l=t+n,d=a+o,u=t+n/2,s=a+o/2;e.beginPath(),e.moveTo(t,s),e.bezierCurveTo(t,s-i,u-r,a,u,a),e.bezierCurveTo(u+r,a,l,s-i,l,s),e.bezierCurveTo(l,s+i,u+r,d,u,d),e.bezierCurveTo(u-r,d,t,s+i,t,s),e.closePath(),e.stroke()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n,o){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),a=Math.round(a);var i=r.default.cornerstone.getEnabledElement(e).image,l=[],d=0,u=i.getPixelData(),s=void 0,c=void 0,f=void 0;if(i.color)for(c=0;c<o;c++)for(f=0;f<n;f++){var v=u[s=4*((c+a)*i.columns+(f+t))],m=u[s+1],g=u[s+2];l[d++]=.2126*v+.7152*m+.0722*g}else for(c=0;c<o;c++)for(f=0;f<n;f++)s=(c+a)*i.columns+(f+t),l[d++]=u[s]*i.slope+i.intercept;return l};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=(0,r.getToolState)(e,"stack");if(a&&a.data&&a.data.length){var u=o.default.cornerstone,s=void 0;if(a.data.length>1){var c=(0,r.getToolState)(e,"stackRenderer");c&&c.data&&c.data.length&&(s=c.data[0])}var f=a.data[0];t<0&&(t+=f.imageIds.length);var v=l.default.getStartLoadHandler(),m=l.default.getEndLoadHandler(),g=l.default.getErrorLoadingHandler();if(t!==f.currentImageIdIndex){v&&v(e);var h={newImageIdIndex:t,direction:t-f.currentImageIdIndex};f.currentImageIdIndex=t;var p=f.imageIds[t];(Boolean(f.preventCache)?u.loadImage(p):u.loadAndCacheImage(p)).then(function(n){if(f.currentImageIdIndex===t){try{u.getEnabledElement(e)}catch(e){return}s?(s.currentImageIdIndex=t,s.render(e,a.data)):u.displayImage(e,n),m&&m(e,n)}},function(a){var n=f.imageIds[t];g&&g(e,n,a)}),i.default.startGrabbing(),(0,d.default)(e,n.default.STACK_SCROLL,h)}}};var n=u(a(1)),o=u(a(0)),r=a(2),i=u(a(38)),l=u(a(12)),d=u(a(5));function u(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(124)),o=r(a(123));function r(e){return e&&e.__esModule?e:{default:e}}var i={getOrientationString:n.default,invertOrientationString:o.default};t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,d){var u=n.default.cornerstone,s=u.getEnabledElement(a).image,c=u.getEnabledElement(d).image;if(s&&c){var f=u.metaData.get("imagePlaneModule",s.imageId),v=u.metaData.get("imagePlaneModule",c.imageId);if(f&&v&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&v.rowCosines&&v.columnCosines&&v.imagePositionPatient&&f.frameOfReferenceUID===v.frameOfReferenceUID){f.rowCosines=(0,l.default)(f.rowCosines),f.columnCosines=(0,l.default)(f.columnCosines),f.imagePositionPatient=(0,l.default)(f.imagePositionPatient),v.rowCosines=(0,l.default)(v.rowCosines),v.columnCosines=(0,l.default)(v.columnCosines),v.imagePositionPatient=(0,l.default)(v.imagePositionPatient);var m=f.rowCosines.clone().cross(f.columnCosines),g=v.rowCosines.clone().cross(v.columnCosines),h=m.angleTo(g);if(!((h=Math.abs(h))<.5)){var p=(0,o.default)(f,v);if(p){var E=u.pixelToCanvas(t.element,p.start),T=u.pixelToCanvas(t.element,p.end),M=r.default.getActiveColor(),y=i.default.getToolWidth();e.setTransform(1,0,0,1,0,0),e.save(),e.beginPath(),e.strokeStyle=M,e.lineWidth=y,e.moveTo(E.x,E.y),e.lineTo(T.x,T.y),e.stroke(),e.restore()}}}}};var n=d(a(0)),o=d(a(58)),r=d(a(6)),i=d(a(8)),l=d(a(17));function d(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=(0,n.planePlaneIntersection)(e,t);if(a)return{start:(0,n.projectPatientPointToImagePlane)(a.start,e),end:(0,n.projectPatientPointToImagePlane)(a.end,e)}};var n=a(39)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="2.3.3"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adaptiveBrush=void 0;var n=d(a(0)),o=a(2),r=d(a(42)),i=d(a(41)),l=a(40);function d(e){return e&&e.__esModule?e:{default:e}}var u="brush",s={draw:1,radius:3,tolerance:5,minRadius:1,hoverColor:"green",dragColor:"yellow"},c=void 0,f=void 0,v=void 0,m=void 0,g=void 0;function h(e){var t=E.getConfiguration(),a=e.element,r=n.default.cornerstone.getLayer(a,t.brushLayerId),d=n.default.cornerstone.getLayers(a)[0],s=r.image,g=s.rows,h=s.columns,p=(0,o.getToolState)(a,u).data[0];m=function(e,t,a,n){for(var o=E.getConfiguration(),r=o.draw,d=Math.round(c.x),u=Math.round(c.y),s=null,m=[],g=o.radius;0!==s&&g>o.minRadius;){s=0,m=(0,i.default)(g,a,n,d,u);for(var h=0;h<m.length;h++){var p=m[h][0],T=e[m[h][1]*n+p];if(T>f||T<v){s++;break}}g--}return 0===s&&(0,l.drawBrushPixels)(m,t,r,n),g}(d.image.getPixelData(),p.pixelData,g,h),r.invalid=!0,n.default.cornerstone.updateImage(a)}function p(e){var t=E.getConfiguration(),a=e.element,r=n.default.cornerstone.getLayer(a,t.brushLayerId),d=r.image,s=d.rows,c=d.columns,f=e.currentPoints.image,v=f.x,m=f.y,g=(0,o.getToolState)(a,u).data[0].pixelData,h=t.draw,p=t.radius;if(!(v<0||v>c||m<0||m>s)){var T=(0,i.default)(p,s,c,v,m);(0,l.drawBrushPixels)(T,g,h,c),r.invalid=!0,n.default.cornerstone.updateImage(a)}}var E=(0,r.default)({onMouseMove:function(e){var t=e.detail;c=t.currentPoints.image,n.default.cornerstone.updateImage(t.element)},onMouseDown:function(e){var t=e.detail,a=t.element,o=E.getConfiguration(),r=n.default.cornerstone.getLayer(a,o.brushLayerId),l=n.default.cornerstone.getLayers(a)[0],d=t.currentPoints.image,u=d.x,s=d.y,m=r.image,T=m.rows,M=m.columns,y=(0,i.default)(o.radius,T,M,u,s);0===o.draw?p(t):(function(e,t,a){var n=E.getConfiguration().tolerance,o=Number.MAX_VALUE,r=-Number.MAX_VALUE;e.forEach(function(e){var n=e[1]*a+e[0],i=t[n];o=Math.min(i,o),r=Math.max(i,r)}),v=o-n,f=r+n}(y,l.image.getPixelData(),M),h(t)),g=!0,c=t.currentPoints.image},onMouseUp:function(e){var t=e.detail;c=t.currentPoints.image;var a=E.getConfiguration();g=!1,m=a.radius,n.default.cornerstone.updateImage(t.element)},onDrag:function(e){var t=e.detail;0===s.draw?p(t):h(t),g=!0,c=t.currentPoints.image},toolType:"adaptiveBrush",onImageRendered:function(e){var t=e.detail;if(c){var a=t.image,n=a.rows,o=a.columns,r=c,d=r.x,u=r.y;if(!(d<0||d>o||u<0||u>n)){var s=E.getConfiguration(),f=t.canvasContext,v=g?s.dragColor:s.hoverColor,h=t.element;m=m||s.radius,f.setTransform(1,0,0,1,0,0);var p=(0,i.default)(m,n,o,d,u);(0,l.drawBrushOnCanvas)(p,f,v,h)}}}});E.setConfiguration(s),t.adaptiveBrush=E},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.brush=void 0;var n=d(a(0)),o=a(2),r=d(a(42)),i=d(a(41)),l=a(40);function d(e){return e&&e.__esModule?e:{default:e}}var u="brush",s=void 0,c=!1;function f(e){var t=v.getConfiguration(),a=e.element,r=n.default.cornerstone.getLayer(a,t.brushLayerId),d=r.image,s=d.rows,c=d.columns,f=e.currentPoints.image,m=f.x,g=f.y,h=(0,o.getToolState)(a,u).data[0].pixelData,p=t.draw,E=t.radius;if(!(m<0||m>c||g<0||g>s)){var T=(0,i.default)(E,s,c,m,g);(0,l.drawBrushPixels)(T,h,p,c),r.invalid=!0,n.default.cornerstone.updateImage(a)}}var v=(0,r.default)({onMouseMove:function(e){var t=e.detail;s=t.currentPoints.image,n.default.cornerstone.updateImage(t.element)},onMouseDown:function(e){var t=e.detail;f(t),c=!0,s=t.currentPoints.image},onMouseUp:function(e){var t=e.detail;s=t.currentPoints.image,c=!1},onDrag:function(e){var t=e.detail;f(t),c=!0,s=t.currentPoints.image},toolType:"brush",onImageRendered:function(e){var t=e.detail;if(s){var a=t.image,n=a.rows,o=a.columns,r=s,d=r.x,u=r.y;if(!(d<0||d>o||u<0||u>n)){var f=v.getConfiguration(),m=f.radius,g=t.canvasContext,h=c?f.dragColor:f.hoverColor,p=t.element;g.setTransform(1,0,0,1,0,0);var E=(0,i.default)(m,n,o,d,u);(0,l.drawBrushOnCanvas)(E,g,h,p)}}}});v.setConfiguration({draw:1,radius:3,hoverColor:"green",dragColor:"yellow"}),t.brush=v},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zoomTouchDrag=t.zoomTouchPinch=t.zoomWheel=t.zoom=void 0;var n=c(a(1)),o=c(a(0)),r=c(a(15)),i=c(a(4)),l=c(a(24)),d=c(a(43)),u=c(a(16)),s=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var f="zoom",v=void 0;function m(e,t){var a=T.getConfiguration(),n=Math.log(e.scale)/Math.log(1.7)+t,o=Math.pow(1.7,n);return a.maxScale&&o>a.maxScale?e.scale=a.maxScale:a.minScale&&o<a.minScale?e.scale=a.minScale:e.scale=o,e}function g(e,t){if(t.hflip&&(e.x*=-1),t.vflip&&(e.y*=-1),0!==t.rotation){var a=t.rotation*Math.PI/180,n=Math.cos(a),o=Math.sin(a),r=e.x*n-e.y*o,i=e.x*o+e.y*n;e.x=r,e.y=i}return e}function h(e,t){var a=o.default.cornerstone,n=e.element,r=m(e.viewport,t);a.setViewport(n,r);var i=a.pageToPixel(n,e.startPoints.page.x,e.startPoints.page.y),l={x:e.startPoints.image.x-i.x,y:e.startPoints.image.y-i.y};l=g(l,r),r.translation.x-=l.x,r.translation.y-=l.y,a.setViewport(n,r)}function p(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,E),t.removeEventListener(n.default.MOUSE_UP,p),t.removeEventListener(n.default.MOUSE_CLICK,p)}function E(e){var t=e.detail;if(!t.deltaPoints.page.y)return!1;var a=t.deltaPoints.page.y/100;T.strategy(t,a),e.preventDefault(),e.stopPropagation()}var T=(0,r.default)(function(e){var t=e.detail,a=t.element,o=(0,s.getToolOptions)(f,a);(0,i.default)(t.which,o.mouseButtonMask)&&(v=t.startPoints,a.addEventListener(n.default.MOUSE_DRAG,E),a.addEventListener(n.default.MOUSE_UP,p),a.addEventListener(n.default.MOUSE_CLICK,p),e.preventDefault(),e.stopPropagation())},f);T.strategies={default:h,translate:function(e,t){var a,n,r,i=e.element,l=e.image,d=T.getConfiguration(),u=m(e.viewport,t),s={x:0,y:0};if(t<0)u.scale<3&&(Math.abs(u.translation.x)<.01?u.translation.x=0:s.x=u.translation.x/8,Math.abs(u.translation.y)<.01?u.translation.y=0:s.y=u.translation.y/8);else{d&&d.preventZoomOutsideImage&&(v.image=(a=v.image,n=l.width,r=l.height,a.x=Math.max(a.x,0),a.y=Math.max(a.y,0),a.x=Math.min(a.x,n),a.y=Math.min(a.y,r),a));var c={x:l.width/2-v.image.x,y:l.height/2-v.image.y};c=g(c,u);var f={x:u.translation.x-c.x,y:u.translation.y-c.y};Math.abs(f.x)<.01?u.translation.x=c.x:s.x=f.x/8,Math.abs(f.y)<.01?u.translation.y=c.y:s.y=f.y/8}u.translation.x-=s.x,u.translation.y-=s.y,o.default.cornerstone.setViewport(i,u)},zoomToCenter:function(e,t){var a=e.element,n=m(e.viewport,t);o.default.cornerstone.setViewport(a,n)}},T.strategy=h;var M=(0,l.default)(function(e){var t=e.detail,a=-t.direction/4,n=T.getConfiguration();n&&n.invert&&(a*=-1);var r=m(t.viewport,a);o.default.cornerstone.setViewport(t.element,r)}),y=(0,d.default)(function(e){var t=e.detail,a=o.default.cornerstone,n=T.getConfiguration(),r=t.viewport,i=t.element;r.scale+=t.scaleChange*r.scale,n.maxScale&&r.scale>n.maxScale?r.scale=n.maxScale:n.minScale&&r.scale<n.minScale&&(r.scale=n.minScale),a.setViewport(i,r);var l=a.pageToPixel(i,t.startPoints.page.x,t.startPoints.page.y),d={x:t.startPoints.image.x-l.x,y:t.startPoints.image.y-l.y};d=g(d,r),r.translation.x-=d.x,r.translation.y-=d.y,a.setViewport(i,r)}),x=(0,u.default)(E,f);t.zoom=T,t.zoomWheel=M,t.zoomTouchPinch=y,t.zoomTouchDrag=x},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcRegionTouch=t.wwwcRegion=void 0;var n=c(a(1)),o=c(a(0)),r=c(a(8)),i=c(a(6)),l=a(2),d=c(a(54)),u=c(a(4)),s=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var f="wwwcRegion",v={minWindowWidth:10};function m(e){var t=e.detail.element,a=(0,l.getToolState)(t,f);a&&a.data&&(a.data=[]),t.removeEventListener(n.default.MOUSE_MOVE,M),t.removeEventListener(n.default.MOUSE_DRAG,M),t.removeEventListener(n.default.MOUSE_UP,g),t.removeEventListener(n.default.MOUSE_CLICK,g),t.addEventListener(n.default.MOUSE_DOWN,E)}function g(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.MOUSE_MOVE,M),a.removeEventListener(n.default.MOUSE_DRAG,M),a.removeEventListener(n.default.MOUSE_UP,g),a.removeEventListener(n.default.MOUSE_CLICK,g),a.addEventListener(n.default.MOUSE_DOWN,E);var o=(0,l.getToolState)(t.element,f);o&&o.data&&o.data.length&&(o.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},h(t))}function h(e){var t=o.default.cornerstone,a=(0,l.getToolState)(e.element,f);if(a&&a.data&&a.data.length){var n=a.data[0].startPoint,r=a.data[0].endPoint,i=Math.abs(n.x-r.x),u=Math.abs(n.y-r.y),s=Math.min(n.x,r.x),c=Math.min(n.y,r.y);s=Math.max(s,0),s=Math.min(s,e.image.width),c=Math.max(c,0),c=Math.min(c,e.image.height),i=Math.floor(Math.min(i,Math.abs(e.image.width-s))),u=Math.floor(Math.min(u,Math.abs(e.image.height-c)));var v=function(e,t,a){var n=e.length;if(n<2)return{min:t,max:a,mean:(t+a)/2};for(var o=a,r=t,i=0,l=0;l<n;l++){var d=e[l];o=Math.min(o,d),r=Math.max(r,d),i+=d}return{min:o,max:r,mean:i/n}}((0,d.default)(e.element,s,c,i,u),e.image.minPixelValue,e.image.maxPixelValue),m=_.getConfiguration(),g=t.getViewport(e.element);void 0===m.minWindowWidth&&(m.minWindowWidth=10),g.voi.windowWidth=Math.max(Math.abs(v.max-v.min),m.minWindowWidth),g.voi.windowCenter=v.mean,t.setViewport(e.element,g),a.data=[],t.updateImage(e.element)}}function p(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_MOVE,p),t.removeEventListener(n.default.MOUSE_DRAG,p),t.addEventListener(n.default.MOUSE_MOVE,M),t.addEventListener(n.default.MOUSE_DRAG,M),t.addEventListener(n.default.MOUSE_CLICK,g),e.type===n.default.MOUSE_DRAG&&t.addEventListener(n.default.MOUSE_UP,g)}function E(e){var t=e.detail,a=t.element,o=(0,s.getToolOptions)(f,a);if((0,u.default)(t.which,o.mouseButtonMask))return a.addEventListener(n.default.MOUSE_DRAG,p),a.addEventListener(n.default.MOUSE_MOVE,p),a.removeEventListener(n.default.MOUSE_DOWN,E),T(t),!1}function T(e){var t=(0,l.getToolState)(e.element,f);t&&t.data&&(t.data=[]);var a={startPoint:{x:e.currentPoints.image.x,y:e.currentPoints.image.y}};(0,l.addToolState)(e.element,f,a)}function M(e){var t=e.detail,a=t.element,n=(0,l.getToolState)(a,f);n&&n.data&&n.data.length&&(n.data[0].endPoint={x:t.currentPoints.image.x,y:t.currentPoints.image.y},o.default.cornerstone.updateImage(a))}function y(e){var t=e.detail,a=t.element,n=t.canvasContext,d=o.default.cornerstone,u=(0,l.getToolState)(t.element,f);if(u&&u.data&&u.data.length){var s=u.data[0].startPoint,c=u.data[0].endPoint;if(s&&c){n.setTransform(1,0,0,1,0,0);var v=i.default.getActiveColor(),m=d.pixelToCanvas(a,s),g=d.pixelToCanvas(a,c),h=Math.min(m.x,g.x),p=Math.min(m.y,g.y),E=Math.abs(m.x-g.x),T=Math.abs(m.y-g.y),M=r.default.getToolWidth(),y=_.getConfiguration();n.save(),y&&y.shadow&&(n.shadowColor=y.shadowColor||"#000000",n.shadowOffsetX=y.shadowOffsetX||1,n.shadowOffsetY=y.shadowOffsetY||1),n.beginPath(),n.strokeStyle=v,n.lineWidth=M,n.rect(h,p,E,T),n.stroke(),n.restore()}}}function x(e){e.removeEventListener(n.default.MOUSE_DOWN,E),e.removeEventListener(n.default.MOUSE_UP,g),e.removeEventListener(n.default.MOUSE_CLICK,g),e.removeEventListener(n.default.MOUSE_DRAG,M),e.removeEventListener(n.default.MOUSE_MOVE,M),e.removeEventListener(n.default.IMAGE_RENDERED,y),e.removeEventListener(n.default.NEW_IMAGE,m),o.default.cornerstone.updateImage(e)}function O(e){e.removeEventListener(n.default.TOUCH_DRAG,M),e.removeEventListener(n.default.TOUCH_START,T),e.removeEventListener(n.default.TOUCH_DRAG_END,h),e.removeEventListener(n.default.IMAGE_RENDERED,y)}var _={activate:function(e,t){(0,s.setToolOptions)(f,e,{mouseButtonMask:t}),(0,l.getToolState)(e,f)||(0,l.addToolState)(e,f,[]);e.removeEventListener(n.default.MOUSE_DOWN,E),e.removeEventListener(n.default.MOUSE_UP,g),e.removeEventListener(n.default.MOUSE_CLICK,g),e.removeEventListener(n.default.MOUSE_DRAG,M),e.removeEventListener(n.default.MOUSE_MOVE,M),e.removeEventListener(n.default.IMAGE_RENDERED,y),e.removeEventListener(n.default.NEW_IMAGE,m),e.addEventListener(n.default.MOUSE_DOWN,E),e.addEventListener(n.default.IMAGE_RENDERED,y),e.addEventListener(n.default.NEW_IMAGE,m),o.default.cornerstone.updateImage(e)},deactivate:x,disable:x,setConfiguration:function(e){v=e},getConfiguration:function(){return v}},b={activate:function(e){(0,l.getToolState)(e,f)||(0,l.addToolState)(e,f,[]);e.removeEventListener(n.default.TOUCH_DRAG,M),e.removeEventListener(n.default.TOUCH_START,T),e.removeEventListener(n.default.TOUCH_DRAG_END,h),e.removeEventListener(n.default.IMAGE_RENDERED,y),e.addEventListener(n.default.TOUCH_DRAG,M),e.addEventListener(n.default.TOUCH_START,T),e.addEventListener(n.default.TOUCH_DRAG_END,h),e.addEventListener(n.default.IMAGE_RENDERED,y)},deactivate:O,disable:O};t.wwwcRegion=_,t.wwwcRegionTouch=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wwwcTouchDrag=t.wwwc=void 0;var n=u(a(1)),o=u(a(0)),r=u(a(15)),i=u(a(16)),l=u(a(4)),d=a(3);function u(e){return e&&e.__esModule?e:{default:e}}var s="wwwc";function c(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,v),t.removeEventListener(n.default.MOUSE_UP,c),t.removeEventListener(n.default.MOUSE_CLICK,c)}function f(e){var t=(e.image.maxPixelValue*e.image.slope+e.image.intercept-(e.image.minPixelValue*e.image.slope+e.image.intercept))/1024,a=e.deltaPoints.page.x*t,n=e.deltaPoints.page.y*t;e.viewport.voi.windowWidth+=a,e.viewport.voi.windowCenter+=n}function v(e){var t=e.detail;m.strategy(t),o.default.cornerstone.setViewport(t.element,t.viewport)}var m=(0,r.default)(function(e){var t=e.detail,a=t.element,o=(0,d.getToolOptions)(s,a);(0,l.default)(t.which,o.mouseButtonMask)&&(a.addEventListener(n.default.MOUSE_DRAG,v),a.addEventListener(n.default.MOUSE_UP,c),a.addEventListener(n.default.MOUSE_CLICK,c),e.preventDefault(),e.stopPropagation())},s);m.strategies={default:f},m.strategy=f;var g=(0,i.default)(function(e){var t=e.detail;e.stopImmediatePropagation();var a=t,n=(a.image.maxPixelValue*a.image.slope+a.image.intercept-(a.image.minPixelValue*a.image.slope+a.image.intercept))/1024,r=a.deltaPoints.page.x*n,i=a.deltaPoints.page.y*n,l=m.getConfiguration();l.orientation?0===l.orientation?(a.viewport.voi.windowWidth+=r,a.viewport.voi.windowCenter+=i):(a.viewport.voi.windowWidth+=i,a.viewport.voi.windowCenter+=r):(a.viewport.voi.windowWidth+=r,a.viewport.voi.windowCenter+=i),o.default.cornerstone.setViewport(a.element,a.viewport)});t.wwwc=m,t.wwwcTouchDrag=g},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textMarkerTouch=t.textMarker=void 0;var n=v(a(1)),o=v(a(0)),r=v(a(10)),i=v(a(11)),l=v(a(19)),d=v(a(6)),u=v(a(4)),s=v(a(7)),c=a(2),f=a(3);function v(e){return e&&e.__esModule?e:{default:e}}var m="textMarker";function g(e){var t=E.getConfiguration();if(t.current){var a={visible:!0,active:!0,text:t.current,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},n={left:0,top:0,width:e.image.width,height:e.image.height};if(o.default.cornerstoneMath.point.insideRect(a.handles.end,n)){var r=t.markers.indexOf(t.current);return t.ascending?(r+=1)>=t.markers.length&&(t.loop?r-=t.markers.length:r=-1):(r-=1)<0&&(t.loop?r+=t.markers.length:r=-1),t.current=t.markers[r],a}}}function h(e,t,a){if(!1===t.visible)return!1;if(t.handles.end.boundingBox){var n=o.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,a),r=(0,l.default)(t.handles.end,a);return n<10||r}}function p(e){var t=e.detail,a=(0,c.getToolState)(t.element,m);if(a){var n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);for(var r=E.getConfiguration(),i=0;i<a.data.length;i++){var l=a.data[i];if(!1!==l.visible){var u=d.default.getToolColor();l.active&&(u=d.default.getActiveColor()),n.save(),r&&r.shadow&&(n.shadowColor=r.shadowColor||"#000000",n.shadowOffsetX=r.shadowOffsetX||1,n.shadowOffsetY=r.shadowOffsetY||1),n.fillStyle=u;var f=n.measureText(l.text);l.textWidth=f.width+10;var v=o.default.cornerstone.pixelToCanvas(t.element,l.handles.end);l.handles.end.boundingBox=(0,s.default)(n,l.text,v.x,v.y-10,u,{centering:{x:!0,y:!0}}),n.restore()}}}}var E=(0,r.default)({createNewMeasurement:g,onImageRendered:p,pointNearTool:h,toolType:m,mouseDoubleClickCallback:function(e){var t=e.detail,a=o.default.cornerstone,r=t.element,i=void 0,l=(0,f.getToolOptions)(m,r);if((0,u.default)(t.which,l.mouseButtonMask)){var d=E.getConfiguration(),s=t.currentPoints.canvas,v=(0,c.getToolState)(r,m);if(v){for(var g=0;g<v.data.length;g++)if(h(0,i=v.data[g],s))return i.active=!0,a.updateImage(r),r.removeEventListener(n.default.MOUSE_MOVE,E.mouseMoveCallback),r.removeEventListener(n.default.MOUSE_DOWN,E.mouseDownCallback),r.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,E.mouseDownActivateCallback),r.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,E.mouseDoubleClickCallback),d.changeTextCallback(i,t,p),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();e.preventDefault(),e.stopPropagation()}}function p(e,t,o){!0===o?(0,c.removeToolState)(r,m,e):e.text=t,e.active=!1,a.updateImage(r),r.addEventListener(n.default.MOUSE_MOVE,E.mouseMoveCallback),r.addEventListener(n.default.MOUSE_DOWN,E.mouseDownCallback),r.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,E.mouseDownActivateCallback),r.addEventListener(n.default.MOUSE_DOUBLE_CLICK,E.mouseDoubleClickCallback)}}}),T=(0,i.default)({createNewMeasurement:g,onImageRendered:p,pointNearTool:h,toolType:m,pressCallback:function(e){var t=e.detail,a=o.default.cornerstone,r=t.element,i=void 0;function l(e,t,o){!0===o?(0,c.removeToolState)(r,m,e):e.text=t,e.active=!1,a.updateImage(r),r.addEventListener(n.default.TOUCH_DRAG,T.touchMoveCallback),r.addEventListener(n.default.TOUCH_START_ACTIVE,T.touchDownActivateCallback),r.addEventListener(n.default.TOUCH_START,T.touchStartCallback),r.addEventListener(n.default.TAP,T.tapCallback),r.addEventListener(n.default.TOUCH_PRESS,T.pressCallback)}var d=E.getConfiguration(),u=t.currentPoints.canvas,s=(0,c.getToolState)(r,m);if(!s)return!1;if(t.handlePressed)return t.handlePressed.active=!0,a.updateImage(r),r.removeEventListener(n.default.TOUCH_DRAG,T.touchMoveCallback),r.removeEventListener(n.default.TOUCH_START_ACTIVE,T.touchDownActivateCallback),r.removeEventListener(n.default.TOUCH_START,T.touchStartCallback),r.removeEventListener(n.default.TAP,T.tapCallback),r.removeEventListener(n.default.TOUCH_PRESS,T.pressCallback),d.changeTextCallback(t.handlePressed,t,l),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();for(var f=0;f<s.data.length;f++)if(h(0,i=s.data[f],u))return i.active=!0,a.updateImage(r),r.removeEventListener(n.default.TOUCH_DRAG,T.touchMoveCallback),r.removeEventListener(n.default.TOUCH_START_ACTIVE,T.touchDownActivateCallback),r.removeEventListener(n.default.TOUCH_START,T.touchStartCallback),r.removeEventListener(n.default.TAP,T.tapCallback),r.removeEventListener(n.default.TOUCH_PRESS,T.pressCallback),d.changeTextCallback(i,t,l),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation();e.preventDefault(),e.stopPropagation()}});t.textMarker=E,t.textMarkerTouch=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simpleAngleTouch=t.simpleAngle=void 0;var n=p(a(1)),o=p(a(0)),r=p(a(10)),i=p(a(7)),l=p(a(36)),d=p(a(14)),u=p(a(8)),s=p(a(6)),c=p(a(13)),f=p(a(25)),v=p(a(23)),m=p(a(9)),g=p(a(11)),h=a(2);function p(e){return e&&e.__esModule?e:{default:e}}var E="simpleAngle";function T(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function M(e,t,a){if(!1===t.visible)return!1;var n=o.default.cornerstone,r={start:n.pixelToCanvas(e,t.handles.start),end:n.pixelToCanvas(e,t.handles.middle)},i=o.default.cornerstoneMath.lineSegment.distanceToPoint(r,a);return i<25||(r.start=n.pixelToCanvas(e,t.handles.middle),r.end=n.pixelToCanvas(e,t.handles.end),(i=o.default.cornerstoneMath.lineSegment.distanceToPoint(r,a))<25)}function y(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function x(e){var t=e.detail,a=(0,h.getToolState)(e.currentTarget,E);if(a){var n=o.default.cornerstone,r=t.enabledElement,c=t.canvasContext.canvas.getContext("2d");c.setTransform(1,0,0,1,0,0);for(var f=void 0,v=u.default.getToolWidth(),g=d.default.getFont(),p=O.getConfiguration(),T=0;T<a.data.length;T++){c.save(),p&&p.shadow&&(c.shadowColor=p.shadowColor||"#000000",c.shadowOffsetX=p.shadowOffsetX||1,c.shadowOffsetY=p.shadowOffsetY||1);var M=a.data[T];if(!1!==M.visible){f=M.active?s.default.getActiveColor():s.default.getToolColor();var x=n.pixelToCanvas(t.element,M.handles.start),_=n.pixelToCanvas(t.element,M.handles.middle),b=n.pixelToCanvas(t.element,M.handles.end);c.beginPath(),c.strokeStyle=f,c.lineWidth=v,c.moveTo(x.x,x.y),c.lineTo(_.x,_.y),c.lineTo(b.x,b.y),c.stroke();var S={drawHandlesIfActive:p&&p.drawHandlesOnHover};(0,m.default)(c,t,M.handles,f,S),c.fillStyle=f;var P=t.image.columnPixelSpacing||1,C=t.image.rowPixelSpacing||1,I="";t.image.rowPixelSpacing&&t.image.columnPixelSpacing||(I=" (isotropic)");var w={x:(Math.ceil(M.handles.middle.x)-Math.ceil(M.handles.start.x))*P,y:(Math.ceil(M.handles.middle.y)-Math.ceil(M.handles.start.y))*C},L={x:(Math.ceil(M.handles.end.x)-Math.ceil(M.handles.middle.x))*P,y:(Math.ceil(M.handles.end.y)-Math.ceil(M.handles.middle.y))*C},D={x:(Math.ceil(M.handles.end.x)-Math.ceil(M.handles.start.x))*P,y:(Math.ceil(M.handles.end.y)-Math.ceil(M.handles.start.y))*C},U=y(w),A=y(L),R=y(D),k=Math.acos((Math.pow(U,2)+Math.pow(A,2)-Math.pow(R,2))/(2*U*A));k*=180/Math.PI;var j=(0,l.default)(k,2);if(j){var H=j.toString()+String.fromCharCode(parseInt("00B0",16))+I,N=void 0;if(M.handles.textBox.hasMoved)N=n.pixelToCanvas(t.element,M.handles.textBox);else{N={x:_.x,y:_.y},c.font=g;var V=c.measureText(H).width;_.x<x.x?N.x-=15+V+10:N.x+=15;var B=n.internal.getTransform(r);B.invert();var W=B.transformPoint(N.x,N.y);M.handles.textBox.x=W.x,M.handles.textBox.y=W.y}var G=(0,i.default)(c,H,N.x,N.y,f,{centering:{x:!1,y:!0}});if(M.handles.textBox.boundingBox=G,M.handles.textBox.hasMoved){var F={start:{},end:{}},Y=[x,b,_];F.end.x=N.x,F.end.y=N.y,F.start=o.default.cornerstoneMath.point.findClosestPoint(Y,F.end);var z=[{x:G.left+G.width/2,y:G.top},{x:G.left,y:G.top+G.height/2},{x:G.left+G.width/2,y:G.top+G.height},{x:G.left+G.width,y:G.top+G.height/2}];F.end=o.default.cornerstoneMath.point.findClosestPoint(z,F.start),c.beginPath(),c.strokeStyle=f,c.lineWidth=v,c.setLineDash([2,3]),c.moveTo(F.start.x,F.start.y),c.lineTo(F.end.x,F.end.y),c.stroke()}}c.restore()}}}}var O=(0,r.default)({createNewMeasurement:T,addNewMeasurement:function(e){var t=o.default.cornerstone,a=T(e),r=e.element;(0,h.addToolState)(r,E,a),r.removeEventListener(n.default.MOUSE_MOVE,O.mouseMoveCallback),r.removeEventListener(n.default.MOUSE_DRAG,O.mouseMoveCallback),r.removeEventListener(n.default.MOUSE_DOWN,O.mouseDownCallback),r.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,O.mouseDownActivateCallback),t.updateImage(r),(0,f.default)(e,E,a,a.handles.middle,function(){if(a.active=!1,(0,c.default)(e,a.handles))return(0,h.removeToolState)(r,E,a),r.addEventListener(n.default.MOUSE_MOVE,O.mouseMoveCallback),r.addEventListener(n.default.MOUSE_DRAG,O.mouseMoveCallback),r.addEventListener(n.default.MOUSE_DOWN,O.mouseDownCallback),r.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,O.mouseDownActivateCallback),void t.updateImage(r);a.handles.end.active=!0,t.updateImage(r),(0,f.default)(e,E,a,a.handles.end,function(){a.active=!1,(0,c.default)(e,a.handles)&&(0,h.removeToolState)(r,E,a),r.addEventListener(n.default.MOUSE_MOVE,O.mouseMoveCallback),r.addEventListener(n.default.MOUSE_DRAG,O.mouseMoveCallback),r.addEventListener(n.default.MOUSE_DOWN,O.mouseDownCallback),r.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,O.mouseDownActivateCallback),t.updateImage(r)})})},onImageRendered:x,pointNearTool:M,toolType:E}),_=(0,g.default)({createNewMeasurement:T,addNewMeasurement:function(e){var t=o.default.cornerstone,a=T(e),r=e.element;(0,h.addToolState)(r,E,a),r.removeEventListener(n.default.TOUCH_DRAG,_.touchMoveCallback),r.removeEventListener(n.default.TOUCH_START_ACTIVE,_.touchDownActivateCallback),r.removeEventListener(n.default.TOUCH_START,_.touchStartCallback),r.removeEventListener(n.default.TAP,_.tapCallback),t.updateImage(r),(0,v.default)(e,E,a,a.handles.middle,function(){if((0,c.default)(e,a.handles))return(0,h.removeToolState)(r,E,a),r.addEventListener(n.default.TOUCH_DRAG,_.touchMoveCallback),r.addEventListener(n.default.TOUCH_START,_.touchStartCallback),r.addEventListener(n.default.TOUCH_START_ACTIVE,_.touchDownActivateCallback),r.addEventListener(n.default.TAP,_.tapCallback),void t.updateImage(r);(0,v.default)(e,E,a,a.handles.end,function(){(0,c.default)(e,a.handles)&&((0,h.removeToolState)(r,E,a),t.updateImage(r)),r.addEventListener(n.default.TOUCH_DRAG,_.touchMoveCallback),r.addEventListener(n.default.TOUCH_START,_.touchStartCallback),r.addEventListener(n.default.TOUCH_START_ACTIVE,_.touchDownActivateCallback),r.addEventListener(n.default.TAP,_.tapCallback)})})},onImageRendered:x,pointNearTool:M,toolType:E});t.simpleAngle=O,t.simpleAngleTouch=_},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.seedAnnotateTouch=t.seedAnnotate=void 0;var n=T(a(1)),o=T(a(0)),r=T(a(10)),i=T(a(11)),l=T(a(7)),d=T(a(14)),u=T(a(8)),s=T(a(6)),c=T(a(13)),f=T(a(26)),v=T(a(9)),m=T(a(52)),g=T(a(4)),h=T(a(19)),p=a(2),E=a(3);function T(e){return e&&e.__esModule?e:{default:e}}var M="seedAnnotate";var y={getTextCallback:function(e){e(prompt("Enter your annotation:"))},changeTextCallback:function(e,t,a){a(prompt("Change your annotation:"))},drawHandles:!1,drawHandlesOnHover:!0,currentLetter:"A",currentNumber:0,showCoordinates:!0,countUp:!0};function x(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function O(e,t,a){if(!1===t.visible)return!1;if(t.handles.end){var n=o.default.cornerstone.pixelToCanvas(e,t.handles.end);return o.default.cornerstoneMath.point.distance(n,a)<25}}function _(e){var t=e.detail,a=(0,p.getToolState)(e.currentTarget,M);if(a){var n=o.default.cornerstone,r=t.enabledElement,i=t.canvasContext.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0);for(var c=t.canvasContext.canvas.width,f=void 0,g=u.default.getToolWidth(),h=d.default.getFont(),E=b.getConfiguration(),T=0;T<a.data.length;T++){i.save(),E&&E.shadow&&(i.shadowColor=E.shadowColor||"#000000",i.shadowOffsetX=E.shadowOffsetX||1,i.shadowOffsetY=E.shadowOffsetY||1);var y=a.data[T];if(!1!==y.visible){f=y.active?s.default.getActiveColor():s.default.getToolColor();var x=n.pixelToCanvas(t.element,y.handles.end);(0,m.default)(i,x,f,g);var O={drawHandlesIfActive:E&&E.drawHandlesOnHover};if(E.drawHandles&&(0,v.default)(i,t,x,f,O),y.text&&""!==y.text){i.font=h;var _="";_=E.showCoordinates?y.text+" x: "+Math.round(y.handles.end.x)+" y: "+Math.round(y.handles.end.y):y.text;var S=i.measureText(_).width+10,P=d.default.getFontSize()+10,C=Math.max(S,P)/2+5;x.x>c/2&&(C=-C);var I=void 0;if(!y.handles.textBox.hasMoved){I={x:x.x-S/2+C,y:x.y-P/2};var w=n.internal.getTransform(r);w.invert();var L=w.transformPoint(I.x,I.y);y.handles.textBox.x=L.x,y.handles.textBox.y=L.y}I=n.pixelToCanvas(t.element,y.handles.textBox);var D=(0,l.default)(i,_,I.x,I.y,f);if(y.handles.textBox.boundingBox=D,y.handles.textBox.hasMoved){var U={start:{},end:{}};U.end.x=I.x,U.end.y=I.y,U.start=x;var A=[{x:D.left+D.width/2,y:D.top},{x:D.left,y:D.top+D.height/2},{x:D.left+D.width/2,y:D.top+D.height},{x:D.left+D.width,y:D.top+D.height/2}];U.end=o.default.cornerstoneMath.point.findClosestPoint(A,U.start),i.beginPath(),i.strokeStyle=f,i.lineWidth=g,i.setLineDash([2,3]),i.moveTo(U.start.x,U.start.y),i.lineTo(U.end.x,U.end.y),i.stroke()}}i.restore()}}}}var b=(0,r.default)({addNewMeasurement:function(e){var t=o.default.cornerstone,a=e.element,n=b.getConfiguration(),r=x(e);function i(e){null===e?(0,p.removeToolState)(a,M,r):r.text=e,r.active=!1,t.updateImage(a)}(0,p.addToolState)(a,M,r),t.updateImage(a),(0,f.default)(e,M,r,r.handles.end,function(){(0,c.default)(e,r.handles)&&(0,p.removeToolState)(a,M,r),void 0===r.text&&n.getTextCallback(i),t.updateImage(a)})},createNewMeasurement:x,onImageRendered:_,pointNearTool:O,toolType:M,mouseDoubleClickCallback:function(e){var t=e.detail,a=o.default.cornerstone,n=t.element,r=void 0,i=(0,E.getToolOptions)(M,n);if((0,g.default)(t.which,i.mouseButtonMask)){var l=b.getConfiguration(),d=t.currentPoints.canvas,u=(0,p.getToolState)(n,M);if(u){for(var s=0;s<u.data.length;s++)if(r=u.data[s],O(n,r,d)||(0,h.default)(r.handles.textBox,d))return r.active=!0,a.updateImage(n),l.changeTextCallback(r,t,c),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}}function c(e,t,o){!0===o?(0,p.removeToolState)(n,M,e):e.text=t,e.active=!1,a.updateImage(n)}}});b.setConfiguration(y);var S=(0,i.default)({addNewMeasurement:function(e){var t=o.default.cornerstone,a=e.element,n=b.getConfiguration(),r=x(e);function i(e){null===e?(0,p.removeToolState)(a,M,r):r.text=e,r.active=!1,t.updateImage(a)}(0,p.addToolState)(a,M,r),t.updateImage(a),(0,f.default)(e,M,r,r.handles.end,function(){(0,c.default)(e,r.handles)&&(0,p.removeToolState)(a,M,r),void 0===r.text&&n.getTextCallback(i),t.updateImage(a)})},createNewMeasurement:x,onImageRendered:_,pointNearTool:O,toolType:M,pressCallback:function(e){var t=e.detail,a=o.default.cornerstone,r=t.element,i=void 0;function l(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,p.removeToolState)(r,M,e):e.text=t,e.active=!1,a.updateImage(r),r.addEventListener(n.default.TOUCH_START,S.touchStartCallback),r.addEventListener(n.default.TOUCH_START_ACTIVE,S.touchDownActivateCallback),r.addEventListener(n.default.TAP,S.tapCallback)}var d=b.getConfiguration(),u=t.currentPoints.canvas,s=(0,p.getToolState)(r,M);if(!s)return!1;if(t.handlePressed)return r.removeEventListener(n.default.TOUCH_START,S.touchStartCallback),r.removeEventListener(n.default.TOUCH_START_ACTIVE,S.touchDownActivateCallback),r.removeEventListener(n.default.TAP,S.tapCallback),d.changeTextCallback(t.handlePressed,t,l),e.stopImmediatePropagation(),!1;for(var c=0;c<s.data.length;c++)if(i=s.data[c],O(r,i,u)||(0,h.default)(i.handles.textBox,u))return i.active=!0,a.updateImage(r),r.removeEventListener(n.default.TOUCH_START,S.touchStartCallback),r.removeEventListener(n.default.TOUCH_START_ACTIVE,S.touchDownActivateCallback),r.removeEventListener(n.default.TAP,S.tapCallback),d.changeTextCallback(i,t,l),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}});t.seedAnnotate=b,t.seedAnnotateTouch=S},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(20)),o=i(a(1)),r=i(a(0));function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t,a){e.moveTo(t.x,t.y),e.lineTo(a.x,a.y)}function d(e,t){var a={x:t.verticalLine.start.x,y:t.verticalLine.start.y},n={x:t.verticalLine.end.x,y:t.verticalLine.end.y};e.beginPath(),e.strokeStyle=t.color,e.lineWidth=t.lineWidth,l(e,a,n),function(e,t){for(var a=0;t.verticalLine.start.y+a*t.verticalMinorTick<=t.vscaleBounds.bottomRight.y;){var n={x:t.verticalLine.start.x,y:t.verticalLine.start.y+a*t.verticalMinorTick},o={x:0,y:t.verticalLine.start.y+a*t.verticalMinorTick};o.x=a%5==0?t.verticalLine.start.x-t.majorTickLength:t.verticalLine.start.x-t.minorTickLength,l(e,n,o),a++}}(e,t),e.stroke()}function u(e,t){l(e,{x:t.horizontalLine.start.x,y:t.horizontalLine.start.y},{x:t.horizontalLine.end.x,y:t.horizontalLine.end.y}),function(e,t){for(var a=0;t.horizontalLine.start.x+a*t.horizontalMinorTick<=t.hscaleBounds.bottomRight.x;){var n={x:t.horizontalLine.start.x+a*t.horizontalMinorTick,y:t.horizontalLine.start.y},o={x:t.horizontalLine.start.x+a*t.horizontalMinorTick,y:0};o.y=a%5==0?t.horizontalLine.start.y-t.majorTickLength:t.horizontalLine.start.y-t.minorTickLength,l(e,n,o),a++}}(e,t)}function s(e,t,a,n,o){var r={left:0,top:0,width:t.width,height:t.height},i=n*Math.min(1e3,t.width),l=o*Math.min(1e3,t.height);return{topLeft:{x:(r={left:r.left+i,top:r.top+l,width:r.width-2*i,height:r.height-2*l}).left,y:r.top},bottomRight:{x:r.left+r.width,y:r.top+r.height}}}function c(e){var t=e.detail,a=t.canvasContext.canvas.getContext("2d"),n=t.image,o=t.viewport,i=r.default.cornerstone.metaData.get("imagePlaneModule",n.imageId),l=void 0,c=void 0;if(i?(l=i.rowPixelSpacing||i.rowImagePixelSpacing,c=i.columnPixelSpacing||i.colImagePixelSpacing):(l=n.rowPixelSpacing,c=n.columnPixelSpacing),l&&c){var v={width:a.canvas.width,height:a.canvas.height},m={width:n.width,height:n.height},g=10/l*o.scale,h=10/c*o.scale,p=s(0,v,0,.25,.05),E=s(0,v,0,.05,.15);if(v.width&&v.height&&m.width&&m.height&&p&&E){var T=f.getConfiguration(),M=Object.assign({},{hscaleBounds:p,vscaleBounds:E,verticalMinorTick:g,horizontalMinorTick:h,minorTickLength:12.5,majorTickLength:25,verticalLine:{start:{x:E.bottomRight.x,y:E.topLeft.y},end:{x:E.bottomRight.x,y:E.bottomRight.y}},horizontalLine:{start:{x:p.topLeft.x,y:p.bottomRight.y},end:{x:p.bottomRight.x,y:p.bottomRight.y}}},T);a.setTransform(1,0,0,1,0,0),a.save(),function(e,t){e.shadowColor=t.shadowColor,e.shadowBlur=t.shadowBlur,e.strokeStyle=t.color,e.lineWidth=t.lineWidth,e.beginPath(),d(e,t),u(e,t),e.stroke()}(a,M),a.restore()}}}var f=(0,n.default)(c);f.setConfiguration({color:"white",lineWidth:2,shadowColor:"black",shadowBlur:4}),f.disable=function(e){e.removeEventListener(o.default.IMAGE_RENDERED,c),r.default.cornerstone.updateImage(e)},t.default=f},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",n=e.querySelector("canvas"),o=document.createElement("a");if(o.download=t,o.href=n.toDataURL(a,1),document.createEvent){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r)}else o.fireEvent&&o.fireEvent("onclick")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(1)),o=r(a(0));function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e.detail;return t.viewport.rotation+=t.rotation,o.default.cornerstone.setViewport(t.element,t.viewport),!1}var l={activate:function(e){e.removeEventListener(n.default.TOUCH_ROTATE,i),e.addEventListener(n.default.TOUCH_ROTATE,i)},disable:function(e){e.removeEventListener(n.default.TOUCH_ROTATE,i)}};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t)throw new Error("simpleTouchTool: toolType is required");var a={};return{activate:function(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.setToolOptions)(t,a,n),a.removeEventListener(r.default.TOUCH_START,e),a.addEventListener(r.default.TOUCH_START,e)},disable:function(t){t.removeEventListener(r.default.TOUCH_START,e)},enable:function(t){t.removeEventListener(r.default.TOUCH_START,e)},deactivate:function(t){t.removeEventListener(r.default.TOUCH_START,e)},getConfiguration:function(){return a},setConfiguration:function(e){a=e}}};var n,o=a(1),r=(n=o)&&n.__esModule?n:{default:n},i=a(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rotateTouchDrag=t.rotate=void 0;var n=u(a(1)),o=u(a(0)),r=u(a(15)),i=u(a(71)),l=u(a(4)),d=a(3);function u(e){return e&&e.__esModule?e:{default:e}}var s="rotate";function c(e,t,a){var n=e.element.getBoundingClientRect(e.element),r=e.element.clientWidth,i=e.element.clientHeight,l={x:n.left+r/2,y:n.top+i/2},d=t,u={x:e.currentPoints.client.x,y:e.currentPoints.client.y},s=Math.sqrt(Math.pow(l.x-d.x,2)+Math.pow(l.y-d.y,2)),c=Math.sqrt(Math.pow(l.x-u.x,2)+Math.pow(l.y-u.y,2)),f=Math.sqrt(Math.pow(d.x-u.x,2)+Math.pow(d.y-u.y,2)),v=180*Math.acos((Math.pow(s,2)+Math.pow(c,2)-Math.pow(f,2))/(2*s*c))/Math.PI;(d.x-l.x)*(u.y-l.y)-(d.y-l.y)*(u.x-l.x)<0&&(v=-v),e.viewport.rotation=a+v,o.default.cornerstone.setViewport(e.element,e.viewport)}function f(e,t,a){var n=a.detail;v.strategy(n,e,t),o.default.cornerstone.setViewport(n.element,n.viewport),a.preventDefault(),a.stopPropagation()}var v=(0,r.default)(function(e){var t=e.detail,a=t.element,o=(0,d.getToolOptions)(s,a),r={x:t.currentPoints.client.x,y:t.currentPoints.client.y},i=t.viewport.rotation;if((0,l.default)(t.which,o.mouseButtonMask)){var u=f.bind({},r,i),c=function e(t){var a=t.detail.element;a.removeEventListener(n.default.MOUSE_DRAG,u),a.removeEventListener(n.default.MOUSE_UP,e),a.removeEventListener(n.default.MOUSE_CLICK,e)};a.addEventListener(n.default.MOUSE_DRAG,u),a.addEventListener(n.default.MOUSE_UP,c),a.addEventListener(n.default.MOUSE_CLICK,c),e.preventDefault(),e.stopPropagation()}},s);v.strategies={default:c,horizontal:function(e){e.viewport.rotation+=e.deltaPoints.page.x/e.viewport.scale,o.default.cornerstone.setViewport(e.element,e.viewport)},vertical:function(e){e.viewport.rotation+=e.deltaPoints.page.y/e.viewport.scale,o.default.cornerstone.setViewport(e.element,e.viewport)}},v.strategy=c;var m=(0,i.default)(function(e){var t=e.detail,a=t.element,o={x:t.currentPoints.client.x,y:t.currentPoints.client.y},r=t.viewport.rotation,i=f.bind({},o,r);a.addEventListener(n.default.TOUCH_DRAG,i),a.addEventListener(n.default.TOUCH_END,function e(t){var a=t.detail.element;a.removeEventListener(n.default.TOUCH_DRAG,i),a.removeEventListener(n.default.TOUCH_END,e)}),e.preventDefault(),e.stopPropagation()},s);t.rotate=v,t.rotateTouchDrag=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleRoiTouch=t.rectangleRoi=void 0;var n=f(a(0)),o=f(a(10)),r=f(a(11)),i=f(a(8)),l=f(a(6)),d=f(a(9)),u=f(a(7)),s=f(a(18)),c=a(2);function f(e){return e&&e.__esModule?e:{default:e}}var v="rectangleRoi";function m(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function g(e,t,a){if(!1===t.visible)return!1;var o=n.default.cornerstone,r=o.pixelToCanvas(e,t.handles.start),i=o.pixelToCanvas(e,t.handles.end),l={left:Math.min(r.x,i.x),top:Math.min(r.y,i.y),width:Math.abs(r.x-i.x),height:Math.abs(r.y-i.y)};return n.default.cornerstoneMath.rect.distanceToPoint(l,a)<5}function h(e,t){for(var a=0,n=0,o=0,r=0,i=t.top;i<t.top+t.height;i++)for(var l=t.left;l<t.left+t.width;l++)a+=e[r],n+=e[r]*e[r],o++,r++;if(0===o)return{count:o,mean:0,variance:0,stdDev:0};var d=a/o,u=n/o-d*d;return{count:o,mean:d,variance:u,stdDev:Math.sqrt(u)}}function p(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function E(e){var t=e.detail,a=(0,c.getToolState)(e.currentTarget,v);if(a){var o=n.default.cornerstone,r=t.image,f=t.element,m=i.default.getToolWidth(),g=T.getConfiguration(),E=t.canvasContext.canvas.getContext("2d"),M=o.metaData.get("generalSeriesModule",r.imageId),y=o.metaData.get("imagePlaneModule",r.imageId),x=void 0,O=void 0,_=void 0;y?(O=y.rowPixelSpacing||y.rowImagePixelSpacing,_=y.columnPixelSpacing||y.colImagePixelSpacing):(O=r.rowPixelSpacing,_=r.columnPixelSpacing),M&&(x=M.modality),E.setTransform(1,0,0,1,0,0);for(var b=0;b<a.data.length;b++){E.save();var S=a.data[b];if(!1!==S.visible){g&&g.shadow&&(E.shadowColor=g.shadowColor||"#000000",E.shadowOffsetX=g.shadowOffsetX||1,E.shadowOffsetY=g.shadowOffsetY||1);var P=l.default.getColorIfActive(S.active),C=o.pixelToCanvas(f,S.handles.start),I=o.pixelToCanvas(f,S.handles.end),w=Math.min(C.x,I.x),L=Math.min(C.y,I.y),D=Math.abs(C.x-I.x),U=Math.abs(C.y-I.y);if(E.beginPath(),E.strokeStyle=P,E.lineWidth=m,E.rect(w,L,D,U),E.stroke(),g&&g.drawHandlesOnHover)if(!0===S.active)(0,d.default)(E,t,S.handles,P);else{(0,d.default)(E,t,S.handles,P,{drawHandlesIfActive:!0})}else(0,d.default)(E,t,S.handles,P);var A=void 0,R=void 0,k=void 0;if(!1===S.invalidated)R=S.meanStdDev,k=S.meanStdDevSUV,A=S.area;else{var j={left:Math.min(S.handles.start.x,S.handles.end.x),top:Math.min(S.handles.start.y,S.handles.end.y),width:Math.abs(S.handles.start.x-S.handles.end.x),height:Math.abs(S.handles.start.y-S.handles.end.y)};if(!r.color)R=h(o.getPixels(f,j.left,j.top,j.width,j.height),j),"PT"===x&&(k={mean:(0,s.default)(r,(R.mean-r.intercept)/r.slope),stdDev:(0,s.default)(r,(R.stdDev-r.intercept)/r.slope)}),R&&!isNaN(R.mean)&&(S.meanStdDev=R,S.meanStdDevSUV=k);A=j.width*(_||1)*(j.height*(O||1)),isNaN(A)||(S.area=A),S.invalidated=!1}var H=[];if(R&&R.mean){var N="";"CT"===x&&(N=" HU");var V="Mean: "+p(R.mean.toFixed(2))+N,B="StdDev: "+p(R.stdDev.toFixed(2))+N;if(k&&void 0!==k.mean){V+=" SUV: "+p(k.mean.toFixed(2)),B+=" SUV: "+p(k.stdDev.toFixed(2))}H.push(V),H.push(B)}if(A){var W=" mm"+String.fromCharCode(178);O&&_||(W=" pixels"+String.fromCharCode(178));var G="Area: "+p(A.toFixed(2))+W;H.push(G)}S.handles.textBox.hasMoved||(S.handles.textBox.x=Math.max(S.handles.start.x,S.handles.end.x),S.handles.textBox.y=(S.handles.start.y+S.handles.end.y)/2);var F=o.pixelToCanvas(f,S.handles.textBox),Y=(0,u.default)(E,H,F.x,F.y,P,{centering:{x:!1,y:!0}});if(S.handles.textBox.boundingBox=Y,S.handles.textBox.hasMoved){var z={start:{},end:{x:F.x,y:F.y}},K=[{x:w+D/2,y:L},{x:w,y:L+U/2},{x:w+D/2,y:L+U},{x:w+D,y:L+U/2}];z.start=n.default.cornerstoneMath.point.findClosestPoint(K,z.end);var q=[{x:Y.left+Y.width/2,y:Y.top},{x:Y.left,y:Y.top+Y.height/2},{x:Y.left+Y.width/2,y:Y.top+Y.height},{x:Y.left+Y.width,y:Y.top+Y.height/2}];z.end=n.default.cornerstoneMath.point.findClosestPoint(q,z.start),E.beginPath(),E.strokeStyle=P,E.lineWidth=m,E.setLineDash([2,3]),E.moveTo(z.start.x,z.start.y),E.lineTo(z.end.x,z.end.y),E.stroke()}E.restore()}}}}var T=(0,o.default)({createNewMeasurement:m,onImageRendered:E,pointNearTool:g,toolType:v}),M=(0,r.default)({createNewMeasurement:m,onImageRendered:E,pointNearTool:g,toolType:v});t.rectangleRoi=T,t.rectangleRoiTouch=M},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.probeTouch=t.probe=void 0;var n=v(a(0)),o=v(a(10)),r=v(a(11)),i=v(a(6)),l=v(a(14)),d=v(a(9)),u=v(a(7)),s=v(a(34)),c=v(a(18)),f=a(2);function v(e){return e&&e.__esModule?e:{default:e}}var m="probe";function g(e){return{visible:!0,active:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function h(e,t,a){if(!1===t.visible)return!1;var o=n.default.cornerstone.pixelToCanvas(e,t.handles.end);return n.default.cornerstoneMath.point.distance(o,a)<5}function p(e){var t=e.detail,a=(0,f.getToolState)(e.currentTarget,m);if(a){var o=n.default.cornerstone,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);for(var v=void 0,g=l.default.getFont(),h=l.default.getFontSize(),p=0;p<a.data.length;p++){r.save();var E=a.data[p];if(!1!==E.visible){v=E.active?i.default.getActiveColor():i.default.getToolColor(),(0,d.default)(r,t,E.handles,v);var T=Math.round(E.handles.end.x),M=Math.round(E.handles.end.y),y=void 0,x=void 0,O=void 0;if(T<0||M<0||T>=t.image.columns||M>=t.image.rows)return;if(t.image.color)x=T+", "+M,O="R: "+(y=(0,s.default)(t.element,T,M,1,1))[0]+" G: "+y[1]+" B: "+y[2];else{var _=(y=o.getStoredPixels(t.element,T,M,1,1))[0],b=_*t.image.slope+t.image.intercept,S=(0,c.default)(t.image,_);x=T+", "+M,O="SP: "+_+" MO: "+parseFloat(b.toFixed(3)),S&&(O+=" SUV: "+parseFloat(S.toFixed(3)))}var P={x:E.handles.end.x+3,y:E.handles.end.y-3},C=o.pixelToCanvas(t.element,P);r.font=g,r.fillStyle=v,(0,u.default)(r,O,C.x,C.y+h+5,v),(0,u.default)(r,x,C.x,C.y,v),r.restore()}}}}var E=(0,o.default)({createNewMeasurement:g,onImageRendered:p,pointNearTool:h,toolType:m}),T=(0,r.default)({createNewMeasurement:g,onImageRendered:p,pointNearTool:h,toolType:m});t.probe=E,t.probeTouch=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}var r=(0,o(a(29)).default)(function(e){var t=e.detail,a=r.getConfiguration();a&&a.testPointers(t)&&(t.viewport.translation.x+=t.deltaPoints.page.x/t.viewport.scale,t.viewport.translation.y+=t.deltaPoints.page.y/t.viewport.scale,n.default.cornerstone.setViewport(t.element,t.viewport),e.preventDefault(),e.stopPropagation())});r.setConfiguration({testPointers:function(e){return e.numPointers>=2}}),t.default=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.panTouchDrag=t.pan=void 0;var n=u(a(1)),o=u(a(0)),r=u(a(15)),i=u(a(16)),l=u(a(4)),d=a(3);function u(e){return e&&e.__esModule?e:{default:e}}var s="pan";function c(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,f),t.removeEventListener(n.default.MOUSE_UP,c),t.removeEventListener(n.default.MOUSE_CLICK,c)}function f(e){var t=e.detail,a=t.viewport.scale,n=t.viewport.scale;t.image.rowPixelSpacing<t.image.columnPixelSpacing?a*=t.image.columnPixelSpacing/t.image.rowPixelSpacing:t.image.columnPixelSpacing<t.image.rowPixelSpacing&&(n*=t.image.rowPixelSpacing/t.image.columnPixelSpacing),t.viewport.translation.x+=t.deltaPoints.page.x/a,t.viewport.translation.y+=t.deltaPoints.page.y/n,o.default.cornerstone.setViewport(t.element,t.viewport),e.preventDefault(),e.stopPropagation()}var v=(0,r.default)(function(e){var t=e.detail,a=t.element,o=(0,d.getToolOptions)(s,a);(0,l.default)(t.which,o.mouseButtonMask)&&(a.addEventListener(n.default.MOUSE_DRAG,f),a.addEventListener(n.default.MOUSE_UP,c),a.addEventListener(n.default.MOUSE_CLICK,c),e.preventDefault(),e.stopPropagation())},s),m=(0,i.default)(f,s);t.pan=v,t.panTouchDrag=m},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(0)),o=d(a(56)),r=d(a(20)),i=d(a(6)),l=d(a(7));function d(e){return e&&e.__esModule?e:{default:e}}var u=(0,r.default)(function(e){var t=e.detail,a=t.element,r=function(e){var t=n.default.cornerstone,a=t.getEnabledElement(e),r=t.metaData.get("imagePlaneModule",a.image.imageId);if(r&&r.rowCosines&&r.columnCosines){var i=o.default.getOrientationString(r.rowCosines),l=o.default.getOrientationString(r.columnCosines),d=o.default.invertOrientationString(i);return{top:o.default.invertOrientationString(l),bottom:l,left:d,right:i}}}(a);if(r){var d=function(e){var t=n.default.cornerstone,a=t.getEnabledElement(e),o=void 0;o={x:a.image.width/2,y:5};var r=t.pixelToCanvas(e,o);o={x:a.image.width/2,y:a.image.height-5};var i=t.pixelToCanvas(e,o);o={x:5,y:a.image.height/2};var l=t.pixelToCanvas(e,o);return o={x:a.image.width-10,y:a.image.height/2},{top:r,bottom:i,left:l,right:t.pixelToCanvas(e,o)}}(a),s=t.canvasContext.canvas.getContext("2d");s.setTransform(1,0,0,1,0,0);var c=i.default.getToolColor(),f=s.measureText(r.top).width,v=s.measureText(r.left).width,m=s.measureText(r.right).width,g=s.measureText(r.bottom).width;(0,l.default)(s,r.top,d.top.x-f/2,d.top.y,c),(0,l.default)(s,r.left,d.left.x-v/2,d.left.y,c);var h=u.getConfiguration();h&&h.drawAllMarkers&&((0,l.default)(s,r.right,d.right.x-m/2,d.right.y,c),(0,l.default)(s,r.bottom,d.bottom.x-g/2,d.bottom.y,c))}});t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.magnifyTouchDrag=t.magnify=void 0;var n=d(a(1)),o=d(a(0)),r=a(28),i=d(a(4)),l=a(3);function d(e){return e&&e.__esModule?e:{default:e}}var u="magnify",s={magnifySize:300,magnificationLevel:5},c=void 0,f=void 0,v=void 0,m=void 0;function g(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.MOUSE_DRAG,M),a.removeEventListener(n.default.MOUSE_UP,g),a.removeEventListener(n.default.MOUSE_CLICK,g),h(t)}function h(e){e.element.querySelector(".magnifyTool").style.display="none",document.body.style.cursor="default",O()}function p(e){var t=e.detail,a=t.element,r=(0,l.getToolOptions)(u,a);(e.isTouchEvent||(0,i.default)(t.which,r.mouseButtonMask))&&(a.addEventListener(n.default.MOUSE_DRAG,M),a.addEventListener(n.default.TOUCH_DRAG,M),a.addEventListener(n.default.MOUSE_UP,g),a.addEventListener(n.default.TOUCH_END,g),a.addEventListener(n.default.MOUSE_CLICK,g),a.addEventListener(n.default.NEW_IMAGE,E),function(e){O();var t=e.enabledElement;void 0===t&&(t=o.default.cornerstone.getEnabledElement(e.element));var a=b.getConfiguration().magnificationLevel,n=t.canvas,r=t.image;(m=document.createElement("div")).width=n.width*a,m.height=n.height*a,o.default.cornerstone.enable(m);var i=o.default.cornerstone.getEnabledElement(m),l=o.default.cornerstone.getViewport(t.element);(v=i.canvas).width=n.width*a,v.height=n.height*a,i.viewport=Object.assign({},l),l.scale*=a,o.default.cornerstone.displayImage(m,r),o.default.cornerstone.setViewport(m,l)}(t),window.requestAnimationFrame(function(){return y(t)}),e.preventDefault(),e.stopPropagation())}function E(e,t){t.currentPoints=f,y(t)}function T(e,t){var a=t.element;a.removeEventListener(n.default.TOUCH_DRAG_END,T),a.removeEventListener(n.default.TOUCH_END,T),a.removeEventListener(n.default.NEW_IMAGE,E),h(t)}function M(e){var t=e.detail,a=t.element;y(t),!0===t.isTouchEvent&&(a.addEventListener(n.default.TOUCH_DRAG_END,T),a.addEventListener(n.default.TOUCH_END,T)),e.preventDefault(),e.stopPropagation()}function y(e){var t=e.element,a=t.querySelector(".magnifyTool");if(a||x(e.element),void 0!==v){var n=b.getConfiguration(),r=n.magnifySize,i=n.magnificationLevel,l=t.querySelector("canvas:not(.magnifyTool)");l.getContext("2d").setTransform(1,0,0,1,0,0);var d=a.getContext("2d");d.setTransform(1,0,0,1,0,0);var u=r,s=o.default.cornerstone.pixelToCanvas(e.element,e.currentPoints.image);s.x=Math.max(s.x,0),s.x=Math.min(s.x,l.width),s.y=Math.max(s.y,0),s.y=Math.min(s.y,l.height),d.clearRect(0,0,r,r),d.fillStyle="transparent",d.fillRect(0,0,r,r);var f={x:s.x*i-.5*u,y:s.y*i-.5*u};"Safari"===c&&(f.x=Math.max(f.x,0),f.y=Math.max(f.y,0)),f.x=Math.min(f.x,v.width),f.y=Math.min(f.y,v.height),d.drawImage(v,f.x,f.y,u,u,0,0,u,u),a.style.top=s.y-.5*r+"px",a.style.left=s.x-.5*r+"px",e.isTouchEvent&&(a.style.top=s.y-.5*r-120+"px"),a.style.display="block",document.body.style.cursor="none"}}function x(e){if(null===e.querySelector(".magnifyTool")){var t=document.createElement("canvas");t.classList.add("magnifyTool");var a=b.getConfiguration();t.width=a.magnifySize,t.height=a.magnifySize,t.style.position="absolute",t.style.display="none",e.appendChild(t)}}function O(){void 0!==m&&(o.default.cornerstone.disable(m),m=void 0,v=void 0)}function _(e){e.removeEventListener(n.default.MOUSE_DOWN,p),function(e){var t=e.querySelector(".magnifyTool");t&&e.removeChild(t)}(e)}var b={enable:function(e){var t=b.getConfiguration(t);if(!c){var a=(0,r.getBrowserInfo)().split(" ");c=a[0]}x(e)},activate:function(e,t){(0,l.setToolOptions)(u,e,{mouseButtonMask:t}),e.removeEventListener(n.default.MOUSE_DOWN,p),e.addEventListener(n.default.MOUSE_DOWN,p),x(e)},deactivate:_,disable:_,getConfiguration:function(){return s},setConfiguration:function(e){s=e}};function S(e){e.removeEventListener(n.default.TOUCH_START,p),e.addEventListener(n.default.TOUCH_START,p)}function P(e){e.removeEventListener(n.default.TOUCH_START,p)}var C={activate:S,deactivate:P,enable:S,disable:P};t.magnify=b,t.magnifyTouchDrag=C},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lengthTouch=t.length=void 0;var n=c(a(0)),o=c(a(10)),r=c(a(11)),i=c(a(7)),l=c(a(8)),d=c(a(6)),u=c(a(9)),s=a(2);function c(e){return e&&e.__esModule?e:{default:e}}var f="length";function v(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function m(e,t,a){if(!1===t.visible)return!1;var o=n.default.cornerstone,r={start:o.pixelToCanvas(e,t.handles.start),end:o.pixelToCanvas(e,t.handles.end)};return n.default.cornerstoneMath.lineSegment.distanceToPoint(r,a)<25}function g(e){var t=e.detail,a=(0,s.getToolState)(e.currentTarget,f);if(a){var o=n.default.cornerstone,r=t.canvasContext.canvas.getContext("2d"),c=t.image,v=t.element;r.setTransform(1,0,0,1,0,0);var m=l.default.getToolWidth(),g=h.getConfiguration(),p=o.metaData.get("imagePlaneModule",c.imageId),E=void 0,T=void 0;p?(E=p.rowPixelSpacing||p.rowImagePixelSpacing,T=p.columnPixelSpacing||p.colImagePixelSpacing):(E=c.rowPixelSpacing,T=c.columnPixelSpacing);for(var M=0;M<a.data.length;M++){r.save(),g&&g.shadow&&(r.shadowColor=g.shadowColor||"#000000",r.shadowOffsetX=g.shadowOffsetX||1,r.shadowOffsetY=g.shadowOffsetY||1);var y=a.data[M];if(!1!==y.visible){var x=d.default.getColorIfActive(y.active),O=o.pixelToCanvas(v,y.handles.start),_=o.pixelToCanvas(v,y.handles.end);r.beginPath(),r.strokeStyle=x,r.lineWidth=m,r.moveTo(O.x,O.y),r.lineTo(_.x,_.y),r.stroke();var b={drawHandlesIfActive:g&&g.drawHandlesOnHover};(0,u.default)(r,t,y.handles,x,b),r.fillStyle=x;var S=(y.handles.end.x-y.handles.start.x)*(E||1),P=(y.handles.end.y-y.handles.start.y)*(T||1),C=Math.sqrt(S*S+P*P);y.length=C;var I=" mm";E&&T||(I=" pixels");var w=""+C.toFixed(2)+I;if(!y.handles.textBox.hasMoved){var L={x:Math.max(y.handles.start.x,y.handles.end.x)};L.x===y.handles.start.x?L.y=y.handles.start.y:L.y=y.handles.end.y,y.handles.textBox.x=L.x,y.handles.textBox.y=L.y}var D=o.pixelToCanvas(t.element,y.handles.textBox);D.x+=10;var U=(0,i.default)(r,w,D.x,D.y,x,{centering:{x:!1,y:!0}});if(y.handles.textBox.boundingBox=U,y.handles.textBox.hasMoved){var A={start:{},end:{}},R=[O,_,{x:(O.x+_.x)/2,y:(O.y+_.y)/2}];A.end.x=D.x,A.end.y=D.y,A.start=n.default.cornerstoneMath.point.findClosestPoint(R,A.end);var k=[{x:U.left+U.width/2,y:U.top},{x:U.left,y:U.top+U.height/2},{x:U.left+U.width/2,y:U.top+U.height},{x:U.left+U.width,y:U.top+U.height/2}];A.end=n.default.cornerstoneMath.point.findClosestPoint(k,A.start),r.beginPath(),r.strokeStyle=x,r.lineWidth=m,r.setLineDash([2,3]),r.moveTo(A.start.x,A.start.y),r.lineTo(A.end.x,A.end.y),r.stroke()}r.restore()}}}}var h=(0,o.default)({createNewMeasurement:v,onImageRendered:g,pointNearTool:m,toolType:f}),p=(0,r.default)({createNewMeasurement:v,onImageRendered:g,pointNearTool:m,toolType:f});t.length=h,t.lengthTouch=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(20)),o=r(a(7));function r(e){return e&&e.__esModule?e:{default:e}}var i=(0,n.default)(function(e){var t=e.detail,a=t.image.stats,n=t.canvasContext.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0);var r=[];Object.keys(a).forEach(function(e){var t=e+" : "+a[e];r.push(t)}),(0,o.default)(n,r,0,0,"orange"),r.forEach(function(e){console.log(e)})});t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightTouch=t.highlight=void 0;var n=s(a(0)),o=s(a(44)),r=s(a(11)),i=s(a(8)),l=s(a(6)),d=s(a(9)),u=a(2);function s(e){return e&&e.__esModule?e:{default:e}}var c="highlight";function f(e){var t=(0,u.getToolState)(e.event.currentTarget,c);if(!(t&&t.data&&t.data.length>0))return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}}}function v(e,t,a){var o=n.default.cornerstone,r=o.pixelToCanvas(e,t.handles.start),i=o.pixelToCanvas(e,t.handles.end),l=Math.min(r.x,i.x),d=Math.min(r.y,i.y),u=Math.abs(r.x-i.x),s=Math.abs(r.y-i.y),c=!1;return a.x>=l&&a.x<=l+u&&a.y>=d&&a.y<=d+s&&(c=!0),c}function m(e,t,a){if(!1===t.visible)return!1;var o=n.default.cornerstone,r=o.pixelToCanvas(e,t.handles.start),i=o.pixelToCanvas(e,t.handles.end),l={left:Math.min(r.x,i.x),top:Math.min(r.y,i.y),width:Math.abs(r.x-i.x),height:Math.abs(r.y-i.y)};return n.default.cornerstoneMath.rect.distanceToPoint(l,a)<5}function g(e){var t=e.detail,a=(0,u.getToolState)(e.currentTarget,c);if(void 0!==a){var o=n.default.cornerstone,r=t.canvasContext.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0);var s=void 0,f=i.default.getToolWidth();r.save();var v=a.data[0];if(!1!==v.visible&&v){s=v.active?l.default.getActiveColor():l.default.getToolColor();var m=o.pixelToCanvas(t.element,v.handles.start),g=o.pixelToCanvas(t.element,v.handles.end),h={left:Math.min(m.x,g.x),top:Math.min(m.y,g.y),width:Math.abs(m.x-g.x),height:Math.abs(m.y-g.y)};r.beginPath(),r.strokeStyle="transparent",r.rect(0,0,r.canvas.clientWidth,r.canvas.clientHeight),r.rect(h.width+h.left,h.top,-h.width,h.height),r.stroke(),r.fillStyle="rgba(0,0,0,0.7)",r.fill(),r.closePath(),r.beginPath(),r.strokeStyle=s,r.lineWidth=f,r.setLineDash([4]),r.strokeRect(h.left,h.top,h.width,h.height),r.setLineDash([]),(0,d.default)(r,t,v.handles,s),r.restore()}}}var h=(0,o.default)({createNewMeasurement:f,onImageRendered:g,pointNearTool:m,pointInsideRect:v,toolType:c},!0),p=(0,r.default)({createNewMeasurement:f,onImageRendered:g,pointNearTool:m,pointInsideRect:v,toolType:c},!0);t.highlight=h,t.highlightTouch=p},function(e,t,a){"use strict";function n(e,t,a,n){for(var i=e.length-1,l=0;l<e.length;l++)if(-1===n.indexOf(l)&&-1===n.indexOf(i)){if(o(t,a,r(e[i]),r(e[l])))return!0;i=l}else i=l;return!1}function o(e,t,a,n){var o=!1,r=[i(e,t,a),i(e,t,n),i(a,n,e),i(a,n,t)];return r[0]!==r[1]&&r[2]!==r[3]||(0===r[0]&&l(e,a,t)?o=!0:0===r[1]&&l(e,n,t)?o=!0:0===r[2]&&l(a,e,n)?o=!0:0===r[3]&&l(a,t,n)&&(o=!0),o)}function r(e){return{x:e.x,y:e.y}}function i(e,t,a){var n=(t.y-e.y)*(a.x-t.x)-(t.x-e.x)*(a.y-t.y);return 0===n?0:n>0?1:2}function l(e,t,a){return t.x<=Math.max(e.x,a.x)&&t.x>=Math.min(e.x,a.x)&&t.y<=Math.max(e.y,a.y)&&t.y>=Math.min(e.y,a.y)}Object.defineProperty(t,"__esModule",{value:!0}),t.freeHandIntersect=function(e,t){var a=t.length-1;return n(t,r(t[a]),r(e),[a])},t.freeHandIntersectEnd=function(e){var t=e.length-1;return n(e,r(e[t]),r(e[0]),[t,0])},t.freeHandIntersectModify=function(e,t){var a=r(e[t]),o=t-1;0===t&&(o=e.length-1);var i=r(e[o]);return!!n(e,a,i,[t,o])||n(e,a,i=r(e[o=t===e.length-1?0:t+1]),[t,o])}},function(e,t,a){"use strict";function n(e,t,a){return t<e&&e<a||a<e&&e<t}function o(e,t,a){if(t.x>e.x&&a.x>e.x)return!0;if(t.x>a.x){var n=t;t=a,a=n}var o=function(e,t,a){var n=(a.y-t.y)/(a.x-t.x);return{value:t.x+n*(e.x-t.x),gradient:n}}(e,t,a);return Math.sign(o.gradient)*e.y>o.value}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var a=!1,r=e.length-1,i=0;i<e.length;i++)n(t.y,e[i].y,e[r].y)&&o(t,e[i],e[r])&&(a=!a),r=i;return a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){for(var n=0,o=0,l=0,d=t.top;d<t.top+t.height;d++)for(var u=t.left;u<t.left+t.width;u++)(0,r.default)(a,{x:u,y:d})&&(n+=e[l],o+=e[l]*e[l],i.count++),l++;return 0===i.count?i:(i.mean=n/i.count,i.variance=o/i.count-i.mean*i.mean,i.stdDev=Math.sqrt(i.variance),i)};var n,o=a(83),r=(n=o)&&n.__esModule?n:{default:n};var i={count:0,mean:0,variance:0,stdDev:0}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=0,n=e.length-1;t=t||1;for(var o=0;o<e.length;o++)a+=(e[n].x+e[o].x)*(e[n].y-e[o].y),n=o;return Math.abs(a*t/2)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.freehand=void 0;var n=E(a(1)),o=E(a(0)),r=E(a(8)),i=E(a(6)),l=E(a(9)),d=E(a(7)),u=E(a(27)),s=E(a(19)),c=E(a(85)),f=E(a(84)),v=a(82),m=E(a(18)),g=E(a(4)),h=a(2),p=a(3);function E(e){return e&&e.__esModule?e:{default:e}}var T="freehand",M={mouseLocation:{handles:{start:{highlight:!0,active:!0}}},freehand:!1,modifying:!1,movingTextBox:!1,currentHandle:0,currentTool:-1};function y(e){var t=(0,h.getToolState)(e.element,T);if(void 0!==t){var a,n,r=D.getConfiguration(),i=t.data[r.currentTool],l={x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,lines:[]};if(i.handles.length){if(a=l,n=i.handles,(0,v.freeHandIntersect)(a,n))return!1;i.handles[r.currentHandle-1].lines.push(e.currentPoints.image)}i.handles.push(l),r.currentHandle+=1,r.freehand=!1,o.default.cornerstone.updateImage(e.element)}}function x(e,t){var a=O(e,t);return!(!a&&0!==a)}function O(e,t){var a=(0,h.getToolState)(e.element,T);if(void 0!==a){var n=a.data[t];if(void 0!==n.handles){if(!1===n.visible)return!1;for(var r=e.currentPoints.canvas,i=0;i<n.handles.length;i++){var l=o.default.cornerstone.pixelToCanvas(e.element,n.handles[i]);if(o.default.cornerstoneMath.point.distance(l,r)<5)return i}return n.textBox&&(0,s.default)(n.textBox,r)?n.textBox:void 0}}}function _(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.MOUSE_UP,_);var r=(0,h.getToolState)(t.element,T);if(void 0!==r){var i=D.getConfiguration();if(!0===i.movingTextBox)return i.movingTextBox=!1,r.data[i.currentTool].invalidated=!0,i.currentHandle=0,i.currentTool=-1,void a.removeEventListener(n.default.MOUSE_DRAG,S);t.event.shiftKey||(i.freehand=!1),o.default.cornerstone.updateImage(t.element)}}function b(e){var t=e.detail,a=(0,h.getToolState)(t.element,T);if(a){var n=D.getConfiguration(),r=n.currentTool;if(r<0){if(!function(e,t){for(var a=!1,n=0;n<t.data.length;n++){var o=e.currentPoints.canvas,r=t.data[n];!0===(0,u.default)(e.element,r.handles,o)&&(a=!0),(x(e,n)&&!r.active||!x(e,n)&&r.active)&&(r.lockedForEditing||(r.active=!r.active,a=!0)),!0===r.textBox&&(0,s.default)(r.textBox,o)&&(r.active=!r.active,r.highlight=!r.highlight,a=!0)}return a}(t,a))return}else{var i=a.data[r],l=n.currentHandle;if(C(t),n.modifying){i.active=!0,i.highlight=!0,i.handles[l].x=n.mouseLocation.handles.start.x,i.handles[l].y=n.mouseLocation.handles.start.y;var d=0===l?i.handles.length-1:l-1,c=i.handles[d].lines.length-1,f=i.handles[d].lines[c];f.x=n.mouseLocation.handles.start.x,f.y=n.mouseLocation.handles.start.y}if(n.freehand)i.handles[l-1].lines.push(t.currentPoints.image);else{var v=O(t,n.currentTool);void 0!==v&&!v.hasBoundingBox&&v<i.handles.length-1&&(n.mouseLocation.handles.start.x=i.handles[v].x,n.mouseLocation.handles.start.y=i.handles[v].y)}}o.default.cornerstone.updateImage(t.element)}}function S(e){var t=e.detail;if((0,h.getToolState)(t.element,T)){var a=D.getConfiguration();if(a.currentTool>=0){C(t);var n=a.currentHandle;a.movingTextBox&&(n.hasMoved=!0,n.x=a.mouseLocation.handles.start.x,n.y=a.mouseLocation.handles.start.y)}o.default.cornerstone.updateImage(t.element)}}function P(e,t){var a=(0,h.getToolState)(e.element,T);if(a){var n=D.getConfiguration(),r=a.data[n.currentTool];r.active=!1,r.highlight=!1,void 0!==t&&r.handles[n.currentHandle-1].lines.push(r.handles[0]),n.modifying&&(n.modifying=!1,r.invalidated=!0),n.currentHandle=0,n.currentTool=-1,o.default.cornerstone.updateImage(e.element)}}function C(e){var t=D.getConfiguration(),a=Math.max(e.currentPoints.image.x,0),n=Math.max(e.currentPoints.image.y,0);a=Math.min(a,e.image.width),t.mouseLocation.handles.start.x=a,n=Math.min(n,e.image.height),t.mouseLocation.handles.start.y=n}function I(e){var t=e.detail,a=t.element,o=(0,p.getToolOptions)(T,a);if((0,g.default)(t.which,o.mouseButtonMask)){var r=(0,h.getToolState)(t.element,T),i=void 0,l=void 0,d=D.getConfiguration(),u=d.currentTool;if(d.modifying)return void((0,v.freeHandIntersectModify)(r.data[u].handles,d.currentHandle)||P(t));if(u<0){var s=function(e){var t=(0,h.getToolState)(e.element,T);if(t)for(var a=void 0,n=0;n<t.data.length;n++)if(void 0!==(a=O(e,n)))return{handleNearby:a,toolIndex:n}}(t);if(s){if(i=s.handleNearby,l=s.toolIndex,i.hasBoundingBox)return a.addEventListener(n.default.MOUSE_UP,_),a.addEventListener(n.default.MOUSE_DRAG,S),d.movingTextBox=!0,d.currentHandle=i,d.currentTool=l,!1;void 0!==i&&(a.addEventListener(n.default.MOUSE_MOVE,b),a.addEventListener(n.default.MOUSE_UP,_),d.modifying=!0,d.currentHandle=i,d.currentTool=l)}else!function(e){var t=e.element;t.addEventListener(n.default.MOUSE_MOVE,b),t.addEventListener(n.default.MOUSE_UP,_);var a={visible:!0,active:!0,invalidated:!0,handles:[],textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}},o=D.getConfiguration();o.mouseLocation.handles.start.x=e.currentPoints.image.x,o.mouseLocation.handles.start.y=e.currentPoints.image.y,(0,h.addToolState)(e.element,T,a);var r=(0,h.getToolState)(e.element,T);o.currentTool=r.data.length-1}(t),y(t)}else if(u>=0&&r.data[u].active){i=O(t,u);var c=r.data[u].handles.length-1;if(0!==i&&i!==c||(0,v.freeHandIntersectEnd)(r.data[u].handles))if(t.event.shiftKey)d.freehand=!0,r.data[u].textBox.freehand=!0;else{if(void 0!==i)return!1;y(t)}else P(t,i)}e.preventDefault(),e.stopPropagation()}}function w(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function L(e){var t=e.detail,a=(0,h.getToolState)(e.currentTarget,T);if(void 0!==a){var n=o.default.cornerstone,u=t.image,s=t.element,v=D.getConfiguration(),g=n.metaData.get("generalSeriesModule",u.imageId),p=void 0;g&&(p=g.modality);var E=t.canvasContext.canvas.getContext("2d");E.setTransform(1,0,0,1,0,0);for(var M=void 0,y=r.default.getToolWidth(),x=i.default.getFillColor(),O=0;O<a.data.length;O++){E.save();var _=a.data[O];if(!1!==_.visible){_.active?(M=i.default.getActiveColor(),x=i.default.getFillColor()):(M=i.default.getToolColor(),x=i.default.getToolColor());var b=void 0;if(_.handles.length)for(var S=0;S<_.handles.length;S++){b=_.handles[S];var P=n.pixelToCanvas(t.element,b);E.beginPath(),E.strokeStyle=M,E.lineWidth=y,E.moveTo(P.x,P.y);for(var C=0;C<_.handles[S].lines.length;C++){var I=n.pixelToCanvas(t.element,_.handles[S].lines[C]);E.lineTo(I.x,I.y),E.stroke()}var L=n.pixelToCanvas(t.element,v.mouseLocation.handles.start);S===_.handles.length-1&&(_.polyBoundingBox||(E.lineTo(L.x,L.y),E.stroke()))}var U={fill:x};_.active&&!_.polyBoundingBox&&(0,l.default)(E,t,v.mouseLocation.handles,M,U),(0,l.default)(E,t,_.handles,M,U);var A=void 0,R=void 0,k=void 0;if(!1===_.invalidated)R=_.meanStdDev,k=_.meanStdDevSUV,A=_.area;else if(!_.active){for(var j={left:_.handles[0].x,right:_.handles[0].x,bottom:_.handles[0].y,top:_.handles[0].x},H=0;H<_.handles.length;H++)j.left=Math.min(j.left,_.handles[H].x),j.right=Math.max(j.right,_.handles[H].x),j.bottom=Math.min(j.bottom,_.handles[H].y),j.top=Math.max(j.top,_.handles[H].y);var N={left:j.left,top:j.bottom,width:Math.abs(j.right-j.left),height:Math.abs(j.top-j.bottom)};if(_.polyBoundingBox=N,!u.color){var V=n.getPixels(s,N.left,N.top,N.width,N.height);R=(0,f.default)(V,N,_.handles),"PT"===p&&(k={mean:(0,m.default)(u,(R.mean-u.intercept)/u.slope),stdDev:(0,m.default)(u,(R.stdDev-u.intercept)/u.slope)}),R&&!isNaN(R.mean)&&(_.meanStdDev=R,_.meanStdDevSUV=k)}var B=(u.columnPixelSpacing||1)*(u.rowPixelSpacing||1);A=(0,c.default)(_.handles,B),isNaN(A)||(_.area=A),_.invalidated=!1}var W=[];if(R&&void 0!==R.mean){var G="";"CT"===p&&(G=" HU");var F="Mean: "+w(R.mean.toFixed(2))+G,Y="StdDev: "+w(R.stdDev.toFixed(2))+G;if(k&&void 0!==k.mean){F+=" SUV: "+w(k.mean.toFixed(2)),Y+=" SUV: "+w(k.stdDev.toFixed(2))}W.push(F),W.push(Y)}if(A){var z=" mm"+String.fromCharCode(178);u.rowPixelSpacing&&u.columnPixelSpacing||(z=" pixels"+String.fromCharCode(178));var K="Area: "+w(A.toFixed(2))+z;W.push(K)}if(_.polyBoundingBox&&!_.textBox.freehand){_.textBox.hasMoved||(_.textBox.x=_.polyBoundingBox.left+_.polyBoundingBox.width,_.textBox.y=_.polyBoundingBox.top+_.polyBoundingBox.height/2);var q=n.pixelToCanvas(s,_.textBox),X=(0,d.default)(E,W,q.x,q.y,M,{centering:{x:!1,y:!0}});if(_.textBox.boundingBox=X,_.textBox.hasMoved){for(var Z={start:{},end:{x:q.x,y:q.y}},J=[],Q=0;Q<_.handles.length;Q++)J.push(n.pixelToCanvas(s,_.handles[Q]));Z.start=o.default.cornerstoneMath.point.findClosestPoint(J,Z.end);var $=[{x:X.left+X.width/2,y:X.top},{x:X.left,y:X.top+X.height/2},{x:X.left+X.width/2,y:X.top+X.height},{x:X.left+X.width,y:X.top+X.height/2}];Z.end=o.default.cornerstoneMath.point.findClosestPoint($,Z.start),E.beginPath(),E.strokeStyle=M,E.lineWidth=y,E.setLineDash([2,3]),E.moveTo(Z.start.x,Z.start.y),E.lineTo(Z.end.x,Z.end.y),E.stroke()}}E.restore()}}}}var D={enable:function(e){e.removeEventListener(n.default.MOUSE_DOWN,I),e.removeEventListener(n.default.MOUSE_UP,_),e.removeEventListener(n.default.MOUSE_MOVE,b),e.removeEventListener(n.default.MOUSE_DRAG,S),e.removeEventListener(n.default.IMAGE_RENDERED,L),e.addEventListener(n.default.IMAGE_RENDERED,L),o.default.cornerstone.updateImage(e)},disable:function(e){e.removeEventListener(n.default.MOUSE_DOWN,I),e.removeEventListener(n.default.MOUSE_UP,_),e.removeEventListener(n.default.MOUSE_MOVE,b),e.removeEventListener(n.default.MOUSE_DRAG,S),e.removeEventListener(n.default.IMAGE_RENDERED,L),o.default.cornerstone.updateImage(e)},activate:function(e,t){(0,p.setToolOptions)(T,e,{mouseButtonMask:t}),e.removeEventListener(n.default.MOUSE_DOWN,I),e.removeEventListener(n.default.MOUSE_UP,_),e.removeEventListener(n.default.MOUSE_MOVE,b),e.removeEventListener(n.default.MOUSE_DRAG,S),e.removeEventListener(n.default.IMAGE_RENDERED,L),e.addEventListener(n.default.IMAGE_RENDERED,L),e.addEventListener(n.default.MOUSE_DOWN,I),o.default.cornerstone.updateImage(e)},deactivate:function(e){e.removeEventListener(n.default.MOUSE_DOWN,I),e.removeEventListener(n.default.MOUSE_UP,_),e.removeEventListener(n.default.MOUSE_MOVE,b),e.removeEventListener(n.default.MOUSE_DRAG,S),e.removeEventListener(n.default.IMAGE_RENDERED,L),e.addEventListener(n.default.IMAGE_RENDERED,L),o.default.cornerstone.updateImage(e)},getConfiguration:function(){return M},setConfiguration:function(e){M=e}};t.freehand=D},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ellipticalRoiTouch=t.ellipticalRoi=void 0;var n=g(a(0)),o=g(a(10)),r=g(a(11)),i=g(a(8)),l=g(a(6)),d=g(a(9)),u=g(a(7)),s=g(a(53)),c=g(a(35)),f=g(a(50)),v=g(a(18)),m=a(2);function g(e){return e&&e.__esModule?e:{default:e}}var h="ellipticalRoi";function p(e){return{visible:!0,active:!0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function E(e,t,a,o){if(!1===t.visible)return!1;var r=n.default.cornerstone,i=r.pixelToCanvas(e,t.handles.start),l=r.pixelToCanvas(e,t.handles.end),d={left:Math.min(i.x,l.x)+o/2,top:Math.min(i.y,l.y)+o/2,width:Math.abs(i.x-l.x)-o,height:Math.abs(i.y-l.y)-o},u={left:Math.min(i.x,l.x)-o/2,top:Math.min(i.y,l.y)-o/2,width:Math.abs(i.x-l.x)+o,height:Math.abs(i.y-l.y)+o},s=(0,c.default)(d,a);return!(!(0,c.default)(u,a)||s)}function T(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function M(e){var t=e.detail,a=(0,m.getToolState)(e.currentTarget,h);if(a){var o=n.default.cornerstone,r=t.image,c=t.element,g=i.default.getToolWidth(),p=y.getConfiguration(),E=t.canvasContext.canvas.getContext("2d"),M=o.metaData.get("generalSeriesModule",r.imageId),x=o.metaData.get("imagePlaneModule",r.imageId),O=void 0,_=void 0,b=void 0;x?(_=x.rowPixelSpacing||x.rowImagePixelSpacing,b=x.columnPixelSpacing||x.colImagePixelSpacing):(_=r.rowPixelSpacing,b=r.columnPixelSpacing),M&&(O=M.modality),E.setTransform(1,0,0,1,0,0);for(var S=0;S<a.data.length;S++){E.save();var P=a.data[S];if(!1!==P.visible){p&&p.shadow&&(E.shadowColor=p.shadowColor||"#000000",E.shadowOffsetX=p.shadowOffsetX||1,E.shadowOffsetY=p.shadowOffsetY||1);var C=l.default.getColorIfActive(P.active),I=o.pixelToCanvas(c,P.handles.start),w=o.pixelToCanvas(c,P.handles.end),L=Math.min(I.x,w.x),D=Math.min(I.y,w.y),U=Math.abs(I.x-w.x),A=Math.abs(I.y-w.y);if(E.beginPath(),E.strokeStyle=C,E.lineWidth=g,(0,s.default)(E,L,D,U,A),E.closePath(),p&&p.drawHandlesOnHover)if(!0===P.active)(0,d.default)(E,t,P.handles,C);else{(0,d.default)(E,t,P.handles,C,{drawHandlesIfActive:!0})}else(0,d.default)(E,t,P.handles,C);var R=void 0,k=void 0,j=void 0;if(!1===P.invalidated)k=P.meanStdDev,j=P.meanStdDevSUV,R=P.area;else{var H={left:Math.round(Math.min(P.handles.start.x,P.handles.end.x)),top:Math.round(Math.min(P.handles.start.y,P.handles.end.y)),width:Math.round(Math.abs(P.handles.start.x-P.handles.end.x)),height:Math.round(Math.abs(P.handles.start.y-P.handles.end.y))};if(!r.color){var N=o.getPixels(c,H.left,H.top,H.width,H.height);k=(0,f.default)(N,H),"PT"===O&&(j={mean:(0,v.default)(r,(k.mean-r.intercept)/r.slope),stdDev:(0,v.default)(r,(k.stdDev-r.intercept)/r.slope)}),k&&!isNaN(k.mean)&&(P.meanStdDev=k,P.meanStdDevSUV=j)}R=Math.PI*(H.width*(b||1)/2)*(H.height*(_||1)/2),isNaN(R)||(P.area=R),P.invalidated=!1}var V=[];if(k&&void 0!==k.mean){var B="";"CT"===O&&(B=" HU");var W="Mean: "+T(k.mean.toFixed(2))+B,G="StdDev: "+T(k.stdDev.toFixed(2))+B;if(j&&void 0!==j.mean){W+=" SUV: "+T(j.mean.toFixed(2)),G+=" SUV: "+T(j.stdDev.toFixed(2))}V.push(W),V.push(G)}if(R){var F=" mm"+String.fromCharCode(178);_&&b||(F=" pixels"+String.fromCharCode(178));var Y="Area: "+T(R.toFixed(2))+F;V.push(Y)}P.handles.textBox.hasMoved||(P.handles.textBox.x=Math.max(P.handles.start.x,P.handles.end.x),P.handles.textBox.y=(P.handles.start.y+P.handles.end.y)/2);var z=o.pixelToCanvas(c,P.handles.textBox),K=(0,u.default)(E,V,z.x,z.y,C,{centering:{x:!1,y:!0}});if(P.handles.textBox.boundingBox=K,P.handles.textBox.hasMoved){var q={start:{},end:{x:z.x,y:z.y}},X=[{x:L+U/2,y:D},{x:L,y:D+A/2},{x:L+U/2,y:D+A},{x:L+U,y:D+A/2}];q.start=n.default.cornerstoneMath.point.findClosestPoint(X,q.end);var Z=[{x:K.left+K.width/2,y:K.top},{x:K.left,y:K.top+K.height/2},{x:K.left+K.width/2,y:K.top+K.height},{x:K.left+K.width,y:K.top+K.height/2}];q.end=n.default.cornerstoneMath.point.findClosestPoint(Z,q.start),E.beginPath(),E.strokeStyle=C,E.lineWidth=g,E.setLineDash([2,3]),E.moveTo(q.start.x,q.start.y),E.lineTo(q.end.x,q.end.y),E.stroke()}E.restore()}}}}var y=(0,o.default)({createNewMeasurement:p,onImageRendered:M,pointNearTool:function(e,t,a){return E(e,t,a,15)},toolType:h}),x=(0,r.default)({createNewMeasurement:p,onImageRendered:M,pointNearTool:function(e,t,a){return E(e,t,a,25)},toolType:h});t.ellipticalRoi=y,t.ellipticalRoiTouch=x},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dragProbeTouch=t.dragProbe=void 0;var n=m(a(1)),o=m(a(0)),r=m(a(15)),i=m(a(16)),l=m(a(14)),d=m(a(6)),u=m(a(7)),s=m(a(34)),c=m(a(18)),f=m(a(4)),v=a(3);function m(e){return e&&e.__esModule?e:{default:e}}var g="dragProbe",h=void 0;function p(e){var t=o.default.cornerstone,a=t.getEnabledElement(e.element).canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);var n=d.default.getActiveColor(),r=l.default.getFont(),i=l.default.getFontSize(),f=y.getConfiguration();a.save(),f&&f.shadow&&(a.shadowColor=f.shadowColor||"#000000",a.shadowOffsetX=f.shadowOffsetX||1,a.shadowOffsetY=f.shadowOffsetY||1);var v=Math.round(e.currentPoints.image.x),m=Math.round(e.currentPoints.image.y),g=void 0,h=void 0,p=void 0;if(!(v<0||m<0||v>=e.image.columns||m>=e.image.rows)){if(e.image.color)h=v+", "+m,p="R: "+(g=(0,s.default)(e.element,v,m,1,1))[0]+" G: "+g[1]+" B: "+g[2]+" A: "+g[3];else{var E=(g=t.getStoredPixels(e.element,v,m,1,1))[0],T=E*e.image.slope+e.image.intercept,M=(0,c.default)(e.image,E);h=v+", "+m,p="SP: "+E+" MO: "+parseFloat(T.toFixed(3)),M&&(p+=" SUV: "+parseFloat(M.toFixed(3)))}var x={x:e.currentPoints.image.x+3,y:e.currentPoints.image.y-3},O=t.pixelToCanvas(e.element,x);a.font=r,a.fillStyle=n,(0,u.default)(a,p,O.x,O.y+i+5,n),(0,u.default)(a,h,O.x,O.y,n),a.restore()}}function E(e){var t=e.detail,a=t.element;a.removeEventListener(n.default.IMAGE_RENDERED,T),a.removeEventListener(n.default.MOUSE_DRAG,M),a.removeEventListener(n.default.MOUSE_UP,E),a.removeEventListener(n.default.MOUSE_CLICK,E),o.default.cornerstone.updateImage(t.element)}function T(){h&&(y.strategy(h),h=null)}function M(e){var t=e.detail,a=t.element;h=t,o.default.cornerstone.updateImage(a),e.preventDefault(),e.stopPropagation()}var y=(0,r.default)(function(e){var t=e.detail,a=t.element,o=(0,v.getToolOptions)(g,a);(0,f.default)(t.which,o.mouseButtonMask)&&(a.addEventListener(n.default.IMAGE_RENDERED,T),a.addEventListener(n.default.MOUSE_DRAG,M),a.addEventListener(n.default.MOUSE_UP,E),a.addEventListener(n.default.MOUSE_CLICK,E),y.strategy(t),e.preventDefault(),e.stopPropagation())},g);y.strategies={default:p,minimal:function(e){var t=o.default.cornerstone,a=e.element,n=t.getEnabledElement(a),r=n.image,i=n.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0);var f=d.default.getActiveColor(),v=l.default.getFont(),m=y.getConfiguration();i.save(),m&&m.shadow&&(i.shadowColor=m.shadowColor||"#000000",i.shadowOffsetX=m.shadowOffsetX||1,i.shadowOffsetY=m.shadowOffsetY||1);var g=t.metaData.get("generalSeriesModule",r.imageId),h=void 0;g&&(h=g.modality);var p=void 0,E=void 0,T="";if(!((p=!0===e.isTouchEvent?t.pageToPixel(a,e.currentPoints.page.x,e.currentPoints.page.y-4*l.default.getFontSize()):t.pageToPixel(a,e.currentPoints.page.x,e.currentPoints.page.y-l.default.getFontSize()/2)).x<0||p.y<0||p.x>=r.columns||p.y>=r.rows)){if(r.color)T="R: "+(E=(0,s.default)(a,p.x,p.y,1,1))[0]+" G: "+E[1]+" B: "+E[2];else{var M=(E=t.getStoredPixels(a,p.x,p.y,1,1))[0],x=M*e.image.slope+e.image.intercept,O=parseFloat(x.toFixed(2));if("CT"===h)T+="HU: "+O;else if("PT"===h){T+=O;var _=(0,c.default)(e.image,M);_&&(T+=" SUV: "+parseFloat(_.toFixed(2)))}else T+=O}var b=t.pixelToCanvas(a,p);i.font=v,i.fillStyle=f;var S=void 0,P=i.measureText(T).width;S=!0===e.isTouchEvent?{x:-P/2-5,y:-l.default.getFontSize()-10-12}:{x:12,y:-(l.default.getFontSize()+10)/2},i.beginPath(),i.strokeStyle=f,i.arc(b.x,b.y,6,0,2*Math.PI),i.stroke(),(0,u.default)(i,T,b.x+S.x,b.y+S.y,f),i.restore()}}},y.strategy=p;var x=(0,i.default)(M,g,{fireOnTouchStart:!0});t.dragProbe=y,t.dragProbeTouch=x},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}function r(e){n.default.cornerstone.fitToWindow(e.element)}var i=(0,o(a(45)).default)(function(e){var t=e.detail;i.strategy(t),e.preventDefault(),e.stopPropagation()});i.strategies={default:r},i.strategy=r,t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crosshairsTouch=t.crosshairs=void 0;var n=c(a(1)),o=c(a(0)),r=c(a(12)),i=a(2),l=c(a(4)),d=a(39),u=c(a(17)),s=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var f="crosshairs";function v(e){var t=e.detail;e.stopImmediatePropagation();var a=(0,i.getToolState)(e.currentTarget,f);if(a){var n=o.default.cornerstone,l=e.currentTarget,s=n.getEnabledElement(l).image.imageId,c=n.metaData.get("imagePlaneModule",s);if(c){var v=t.currentPoints.image,m=(0,d.imagePointToPatientPoint)(v,c);a.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==l){var t=Number.MAX_VALUE,a=-1,o=(0,i.getToolState)(e,"stack");if(void 0!==o){var d=o.data[0];if(d.imageIds.forEach(function(e,o){var r=n.metaData.get("imagePlaneModule",e);if(r&&r.imagePositionPatient&&r.rowCosines&&r.columnCosines){var i=(0,u.default)(r.imagePositionPatient),l=(0,u.default)(r.rowCosines),d=(0,u.default)(r.columnCosines).clone().cross(l.clone()),s=Math.abs(d.clone().dot(i)-d.clone().dot(m));s<t&&(t=s,a=o)}}),a!==d.currentImageIdIndex&&-1!==a&&void 0!==d.imageIds[a]){var s=r.default.getStartLoadHandler(),c=r.default.getEndLoadHandler(),f=r.default.getErrorLoadingHandler();s&&s(e);(!0===d.preventCache?n.loadImage(d.imageIds[a]):n.loadAndCacheImage(d.imageIds[a])).then(function(t){var o=n.getViewport(e);d.currentImageIdIndex=a,n.displayImage(e,t,o),c&&c(e,t)},function(t){var n=d.imageIds[a];f&&f(e,n,t)})}}}})}}}function m(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,h),t.removeEventListener(n.default.MOUSE_UP,m)}function g(e){var t=e.detail,a=t.element,o=(0,s.getToolOptions)(f,a);(0,l.default)(t.which,o.mouseButtonMask)&&(a.addEventListener(n.default.MOUSE_DRAG,h),a.addEventListener(n.default.MOUSE_UP,m),v(e),e.preventDefault(),e.stopPropagation())}function h(e){v(e),e.preventDefault(),e.stopPropagation()}function p(e,t,a){(0,s.setToolOptions)(f,e,{mouseButtonMask:t}),(0,i.clearToolState)(e,f),(0,i.addToolState)(e,f,{synchronizationContext:a}),e.removeEventListener(n.default.MOUSE_DOWN,g),e.addEventListener(n.default.MOUSE_DOWN,g)}function E(e){e.removeEventListener(n.default.MOUSE_DOWN,g)}var T={activate:p,deactivate:E,enable:p,disable:E};function M(e){var t=e.detail.element;t.removeEventListener(n.default.TOUCH_DRAG,x),t.removeEventListener(n.default.TOUCH_DRAG_END,M)}function y(e){var t=e.detail.element;return t.addEventListener(n.default.TOUCH_DRAG,x),t.addEventListener(n.default.TOUCH_DRAG_END,M),v(e),!1}function x(e){v(e),e.preventDefault(),e.stopPropagation()}function O(e,t){(0,i.clearToolState)(e,f),(0,i.addToolState)(e,f,{synchronizationContext:t}),e.removeEventListener(n.default.TOUCH_START,y),e.addEventListener(n.default.TOUCH_START,y)}function _(e){e.removeEventListener(n.default.TOUCH_START,y)}var b={activate:O,deactivate:_,enable:O,disable:_};t.crosshairs=T,t.crosshairsTouch=b},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrowAnnotateTouch=t.arrowAnnotate=void 0;var n=M(a(1)),o=M(a(0)),r=M(a(10)),i=M(a(11)),l=M(a(7)),d=M(a(8)),u=M(a(14)),s=M(a(6)),c=M(a(9)),f=M(a(51)),v=M(a(25)),m=M(a(23)),g=M(a(13)),h=M(a(4)),p=M(a(19)),E=a(2),T=a(3);function M(e){return e&&e.__esModule?e:{default:e}}var y="arrowAnnotate";var x={getTextCallback:function(e){e(prompt("Enter your annotation:"))},changeTextCallback:function(e,t,a){a(prompt("Change your annotation:"))},drawHandles:!1,drawHandlesOnHover:!0,arrowFirst:!0};function O(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}function _(e,t,a){if(!1===t.visible)return!1;var n=o.default.cornerstone,r={start:n.pixelToCanvas(e,t.handles.start),end:n.pixelToCanvas(e,t.handles.end)};return o.default.cornerstoneMath.lineSegment.distanceToPoint(r,a)<25}function b(e){var t=e.detail,a=(0,E.getToolState)(e.currentTarget,y);if(a){var n=t.enabledElement,r=o.default.cornerstone,i=t.canvasContext.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0);for(var v=void 0,m=d.default.getToolWidth(),g=u.default.getFont(),h=S.getConfiguration(),p=0;p<a.data.length;p++){i.save(),h&&h.shadow&&(i.shadowColor=h.shadowColor||"#000000",i.shadowOffsetX=h.shadowOffsetX||1,i.shadowOffsetY=h.shadowOffsetY||1);var T=a.data[p];if(!1!==T.visible){v=T.active?s.default.getActiveColor():s.default.getToolColor();var M=r.pixelToCanvas(t.element,T.handles.start),x=r.pixelToCanvas(t.element,T.handles.end);h.arrowFirst?(0,f.default)(i,x,M,v,m):(0,f.default)(i,M,x,v,m);var O={drawHandlesIfActive:h&&h.drawHandlesOnHover};if(h.drawHandles&&(0,c.default)(i,t,T.handles,v,O),T.text&&""!==T.text){i.font=g;var _=i.measureText(T.text).width+10,b=u.default.getFontSize()+10,P=Math.max(_,b)/2+5;x.x<M.x&&(P=-P);var C=void 0;if(!T.handles.textBox.hasMoved){C=h.arrowFirst?{x:x.x-_/2+P,y:x.y-b/2}:{x:M.x-_/2-P,y:M.y-b/2};var I=r.internal.getTransform(n);I.invert();var w=I.transformPoint(C.x,C.y);T.handles.textBox.x=w.x,T.handles.textBox.y=w.y}C=r.pixelToCanvas(t.element,T.handles.textBox);var L=(0,l.default)(i,T.text,C.x,C.y,v);if(T.handles.textBox.boundingBox=L,T.handles.textBox.hasMoved){var D={start:{},end:{}},U=[M,x,{x:(M.x+x.x)/2,y:(M.y+x.y)/2}];D.end.x=C.x,D.end.y=C.y,D.start=o.default.cornerstoneMath.point.findClosestPoint(U,D.end);var A=[{x:L.left+L.width/2,y:L.top},{x:L.left,y:L.top+L.height/2},{x:L.left+L.width/2,y:L.top+L.height},{x:L.left+L.width,y:L.top+L.height/2}];D.end=o.default.cornerstoneMath.point.findClosestPoint(A,D.start),i.beginPath(),i.strokeStyle=v,i.lineWidth=m,i.setLineDash([2,3]),i.moveTo(D.start.x,D.start.y),i.lineTo(D.end.x,D.end.y),i.stroke()}}i.restore()}}}}var S=(0,r.default)({addNewMeasurement:function(e){var t=e.element,a=O(e),r=o.default.cornerstone;function i(e){null===e?(0,E.removeToolState)(t,y,a):a.text=e,a.active=!1,r.updateImage(t),t.addEventListener(n.default.MOUSE_MOVE,S.mouseMoveCallback),t.addEventListener(n.default.MOUSE_DOWN,S.mouseDownCallback),t.addEventListener(n.default.MOUSE_DOWN_ACTIVATE,S.mouseDownActivateCallback),t.addEventListener(n.default.MOUSE_DOUBLE_CLICK,S.mouseDoubleClickCallback)}(0,E.addToolState)(t,y,a),t.removeEventListener(n.default.MOUSE_MOVE,S.mouseMoveCallback),t.removeEventListener(n.default.MOUSE_DOWN,S.mouseDownCallback),t.removeEventListener(n.default.MOUSE_DOWN_ACTIVATE,S.mouseDownActivateCallback),t.removeEventListener(n.default.MOUSE_DOUBLE_CLICK,S.mouseDoubleClickCallback),r.updateImage(t),(0,v.default)(e,y,a,a.handles.end,function(){(0,g.default)(e,a.handles)&&(0,E.removeToolState)(t,y,a);var n=S.getConfiguration();void 0===a.text&&n.getTextCallback(i),r.updateImage(t)})},createNewMeasurement:O,onImageRendered:b,pointNearTool:_,toolType:y,mouseDoubleClickCallback:function(e){var t=e.detail,a=t.element,n=o.default.cornerstone,r=(0,T.getToolOptions)(y,a),i=void 0;if((0,h.default)(t.which,r.mouseButtonMask)){var l=S.getConfiguration(),d=t.currentPoints.canvas,u=(0,E.getToolState)(a,y);if(u)for(var s=0;s<u.data.length;s++)if(i=u.data[s],_(a,i,d)||(0,p.default)(i.handles.textBox,d))return i.active=!0,n.updateImage(a),l.changeTextCallback(i,t,c),e.stopImmediatePropagation(),!1}function c(e,t,o){!0===o?(0,E.removeToolState)(a,y,e):e.text=t,e.active=!1,n.updateImage(a)}}});S.setConfiguration(x);var P=(0,i.default)({addNewMeasurement:function(e){var t=e.element,a=O(e),r=o.default.cornerstone;function i(e){null===e?(0,E.removeToolState)(t,y,a):a.text=e,a.active=!1,r.updateImage(t),t.addEventListener(n.default.TOUCH_PRESS,P.pressCallback),t.addEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),t.addEventListener(n.default.TAP,P.tapCallback)}(0,E.addToolState)(t,y,a),t.removeEventListener(n.default.TOUCH_PRESS,P.pressCallback),t.removeEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),t.removeEventListener(n.default.TAP,P.tapCallback),r.updateImage(t),(0,m.default)(e,y,a,a.handles.end,function(){r.updateImage(t),(0,g.default)(e,a.handles)&&(0,E.removeToolState)(t,y,a);var n=S.getConfiguration();void 0===a.text&&n.getTextCallback(i)})},createNewMeasurement:O,onImageRendered:b,pointNearTool:_,toolType:y,pressCallback:function(e){var t=e.detail,a=t.element,r=o.default.cornerstone,i=void 0;function l(e,t,o){console.log("pressCallback doneChangingTextCallback"),!0===o?(0,E.removeToolState)(a,y,e):e.text=t,e.active=!1,r.updateImage(a),a.addEventListener(n.default.TOUCH_START,P.touchStartCallback),a.addEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),a.addEventListener(n.default.TAP,P.tapCallback)}var d=S.getConfiguration(),u=t.currentPoints.canvas,s=(0,E.getToolState)(a,y);if(s){if(t.handlePressed)return a.removeEventListener(n.default.TOUCH_START,P.touchStartCallback),a.removeEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),a.removeEventListener(n.default.TAP,P.tapCallback),d.changeTextCallback(t.handlePressed,t,l),e.stopImmediatePropagation(),!1;for(var c=0;c<s.data.length;c++)if(i=s.data[c],_(a,i,u)||(0,p.default)(i.handles.textBox,u))return i.active=!0,r.updateImage(a),a.removeEventListener(n.default.TOUCH_START,P.touchStartCallback),a.removeEventListener(n.default.TOUCH_START_ACTIVE,P.touchDownActivateCallback),a.removeEventListener(n.default.TAP,P.tapCallback),d.changeTextCallback(i,t,l),e.stopImmediatePropagation(),!1;e.preventDefault(),e.stopPropagation()}}});t.arrowAnnotate=S,t.arrowAnnotateTouch=P},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.angleTouch=t.angle=void 0;var n=v(a(0)),o=v(a(10)),r=v(a(11)),i=v(a(7)),l=v(a(36)),d=v(a(8)),u=v(a(14)),s=v(a(6)),c=v(a(9)),f=a(2);function v(e){return e&&e.__esModule?e:{default:e}}var m="angle";function g(e){return{visible:!0,active:!0,handles:{start:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x-20,y:e.currentPoints.image.y+10,highlight:!0,active:!1},end2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y+20,highlight:!0,active:!1}}}}function h(e,t,a){if(!1===t.visible)return!1;var o=n.default.cornerstone,r={start:o.pixelToCanvas(e,t.handles.start),end:o.pixelToCanvas(e,t.handles.end)},i=n.default.cornerstoneMath.lineSegment.distanceToPoint(r,a);return i<5||(r.start=o.pixelToCanvas(e,t.handles.start2),r.end=o.pixelToCanvas(e,t.handles.end2),(i=n.default.cornerstoneMath.lineSegment.distanceToPoint(r,a))<5)}function p(e){var t=e.detail,a=(0,f.getToolState)(e.currentTarget,m);if(void 0!==a){var o=t.canvasContext.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0);for(var r=void 0,v=d.default.getToolWidth(),g=u.default.getFont(),h=E.getConfiguration(),p=n.default.cornerstone,T=0;T<a.data.length;T++){o.save(),h&&h.shadow&&(o.shadowColor=h.shadowColor||"#000000",o.shadowOffsetX=h.shadowOffsetX||1,o.shadowOffsetY=h.shadowOffsetY||1);var M=a.data[T];if(!1!==M.visible){r=M.active?s.default.getActiveColor():s.default.getToolColor(),o.beginPath(),o.strokeStyle=r,o.lineWidth=v;var y=p.pixelToCanvas(t.element,M.handles.start),x=p.pixelToCanvas(t.element,M.handles.end);o.moveTo(y.x,y.y),o.lineTo(x.x,x.y),y=p.pixelToCanvas(t.element,M.handles.start2),x=p.pixelToCanvas(t.element,M.handles.end2),o.moveTo(y.x,y.y),o.lineTo(x.x,x.y),o.stroke(),(0,c.default)(o,t,M.handles),o.fillStyle=r;var O=(Math.ceil(M.handles.start.x)-Math.ceil(M.handles.end.x))*t.image.columnPixelSpacing,_=(Math.ceil(M.handles.start.y)-Math.ceil(M.handles.end.y))*t.image.rowPixelSpacing,b=(Math.ceil(M.handles.start2.x)-Math.ceil(M.handles.end2.x))*t.image.columnPixelSpacing,S=(Math.ceil(M.handles.start2.y)-Math.ceil(M.handles.end2.y))*t.image.rowPixelSpacing,P=Math.acos(Math.abs((O*b+_*S)/(Math.sqrt(O*O+_*_)*Math.sqrt(b*b+S*S))));P*=180/Math.PI;var C=(0,l.default)(P,2).toString()+String.fromCharCode(parseInt("00B0",16)),I=(y.x+x.x)/2,w=(y.y+x.y)/2;o.font=g,(0,i.default)(o,C,I,w,r),o.restore()}}}}var E=(0,o.default)({createNewMeasurement:g,onImageRendered:p,pointNearTool:h,toolType:m}),T=(0,r.default)({createNewMeasurement:g,onImageRendered:p,pointNearTool:h,toolType:m});t.angle=E,t.angleTouch=T},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(1)),o=u(a(0)),r=u(a(33)),i=u(a(46)),l=u(a(5)),d=a(3);function u(e){return e&&e.__esModule?e:{default:e}}var s=void 0,c=void 0,f=void 0,v=void 0,m=void 0,g=void 0,h=void 0,p=void 0,E=1,T=0,M=!1,y=!1,x=void 0,O=700,_=5,b="touchInput";function S(e){var t=o.default.cornerstone,a=e.currentTarget||e.srcEvent.currentTarget,i=t.getEnabledElement(a);if(i.image){var d=void 0,u=void 0,b=void 0,S=void 0;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(y=!1,clearTimeout(h)),e.type){case"tap":y=!1,clearTimeout(h),(c={page:o.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,c.image),d=n.default.TAP,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,currentPoints:c,type:d,isTouchEvent:!0},(0,l.default)(a,d,m);break;case"doubletap":y=!1,clearTimeout(h),(c={page:o.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,c.image),d=n.default.DOUBLE_TAP,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,currentPoints:c,type:d,isTouchEvent:!0},(0,l.default)(a,d,m);break;case"pinchstart":y=!1,clearTimeout(h),E=1;break;case"pinchmove":if(y=!1,clearTimeout(h),!0===M){E=e.scale,M=!1;break}u=(e.scale-E)/E,(s={page:e.center,image:t.pageToPixel(a,e.center.x,e.center.y)}).canvas=t.pixelToCanvas(a,s.image),d=n.default.TOUCH_PINCH,m={event:e,startPoints:s,viewport:t.getViewport(a),image:i.image,element:a,direction:e.scale<1?1:-1,scaleChange:u,type:d,isTouchEvent:!0},(0,l.default)(a,d,m),E=e.scale;break;case"touchstart":E=1,clearTimeout(h),clearTimeout(g),g=setTimeout(function(){(s={page:o.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:t.pageToPixel(a,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=t.pixelToCanvas(a,s.image),d=n.default.TOUCH_START,e.touches.length>1&&(d=n.default.MULTI_TOUCH_START),m={event:e,viewport:t.getViewport(a),image:i.image,element:a,startPoints:s,currentPoints:s,type:d,isTouchEvent:!0},!0===(0,l.default)(a,d,m)&&(d=n.default.TOUCH_START_ACTIVE,e.touches.length>1&&(d=n.default.MULTI_TOUCH_START_ACTIVE),m.type=d,(0,l.default)(a,d,m)),f=(0,r.default)(s)},50),y=!0,p=0,h=setTimeout(function(){y&&((c={page:o.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:t.pageToPixel(a,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=t.pixelToCanvas(a,s.image),d=n.default.TOUCH_PRESS,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,currentPoints:c,type:d,isTouchEvent:!0},(0,l.default)(a,d,m))},O);break;case"touchend":E=1,y=!1,clearTimeout(h),setTimeout(function(){(s={page:o.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:t.pageToPixel(a,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=t.pixelToCanvas(a,s.image),d=n.default.TOUCH_END,m={event:e,viewport:t.getViewport(a),image:i.image,element:a,startPoints:s,currentPoints:s,type:d,isTouchEvent:!0},(0,l.default)(a,d,m)},50);break;case"panmove":b={x:e.deltaX-x.x,y:e.deltaY-x.y},x={x:e.deltaX,y:e.deltaY},(c={page:{x:f.page.x+b.x,y:f.page.y+b.y},image:t.pageToPixel(a,f.page.x+b.x,f.page.y+b.y),client:{x:f.client.x+b.x,y:f.client.y+b.y}}).canvas=t.pixelToCanvas(a,c.image),v={page:o.default.cornerstoneMath.point.subtract(c.page,f.page),image:o.default.cornerstoneMath.point.subtract(c.image,f.image),client:o.default.cornerstoneMath.point.subtract(c.client,f.client),canvas:o.default.cornerstoneMath.point.subtract(c.canvas,f.canvas)},(p+=Math.sqrt(v.page.x*v.page.x+v.page.y*v.page.y))>_&&(y=!1,clearTimeout(h)),d=n.default.TOUCH_DRAG,e.pointers.length>1&&(d=n.default.MULTI_TOUCH_DRAG),m={viewport:t.getViewport(a),image:i.image,element:a,startPoints:s,lastPoints:f,currentPoints:c,deltaPoints:v,numPointers:e.pointers.length,type:d,isTouchEvent:!0},(0,l.default)(a,d,m),f=(0,r.default)(c);break;case"panstart":x={x:e.deltaX,y:e.deltaY},(c={page:o.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,c.image),f=(0,r.default)(c);break;case"panend":if(y=!1,clearTimeout(h),!f)return!1;(c={page:o.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:t.pageToPixel(a,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=t.pixelToCanvas(a,c.image),v={page:o.default.cornerstoneMath.point.subtract(c.page,f.page),image:o.default.cornerstoneMath.point.subtract(c.image,f.image),client:o.default.cornerstoneMath.point.subtract(c.client,f.client),canvas:o.default.cornerstoneMath.point.subtract(c.canvas,f.canvas)},d=n.default.TOUCH_DRAG_END,m={event:e.srcEvent,viewport:t.getViewport(a),image:i.image,element:a,startPoints:s,lastPoints:f,currentPoints:c,deltaPoints:v,type:d,isTouchEvent:!0},(0,l.default)(a,d,m),2===e.pointers.length-e.changedPointers.length&&(M=!0);break;case"rotatemove":y=!1,clearTimeout(h),S=e.rotation-T,T=e.rotation,d=n.default.TOUCH_ROTATE,m={event:e.srcEvent,viewport:t.getViewport(a),image:i.image,element:a,rotation:S,type:d},(0,l.default)(a,d,m)}return!1}}function P(e){i.default.disable(e);["touchstart","touchend"].forEach(function(t){e.removeEventListener(t,S)});var t=(0,d.getToolOptions)(b,e).hammer;t&&t.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",S)}var C={enable:function(e){P(e);var t=o.default.Hammer,a={inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput},n=new t.Manager(e,a),r={pointers:0,direction:t.DIRECTION_ALL,threshold:0},l=new t.Pan(r),u=new t.Pinch({threshold:0}),s=new t.Rotate({threshold:0});u.recognizeWith(l),u.recognizeWith(s),s.recognizeWith(l);var c=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});c.recognizeWith(l),n.add([c,l,s,u]),n.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",S),i.default.enable(e),["touchstart","touchend"].forEach(function(t){e.addEventListener(t,S)});var f=(0,d.getToolOptions)(b,e);f.hammer=n,(0,d.setToolOptions)(b,e,f)},disable:P};t.default=C},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=o.default.cornerstone,a=e.currentTarget,i=t.getEnabledElement(a);if(i.image&&!("mousewheel"===e.type&&0===e.wheelDeltaY||"DOMMouseScroll"===e.type&&1===e.axis)){e.preventDefault();var l=void 0,d=void 0;void 0!==e.pageX&&void 0!==e.pageY?(l=e.pageX,d=e.pageY):(l=e.x,d=e.y);var u=t.pageToPixel(a,l,d),s=((e=window.event&&window.event.wheelDelta?window.event:e).wheelDelta?e.wheelDelta:e.deltaY?-e.deltaY:e.detail?-e.detail:e.wheelDelta)<0?-1:1,c={element:a,viewport:t.getViewport(a),image:i.image,direction:s,pageX:l,pageY:d,imageX:u.x,imageY:u.y};(0,r.default)(a,n.default.MOUSE_WHEEL,c)}}var d=["mousewheel","DOMMouseScroll"];function u(e){d.forEach(function(t){e.removeEventListener(t,l)})}var s={enable:function(e){u(e),d.forEach(function(t){e.addEventListener(t,l)})},disable:u};t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),o=l(a(0)),r=l(a(33)),i=l(a(5));function l(e){return e&&e.__esModule?e:{default:e}}var d=!0,u=void 0,s=200;function c(e){return"number"!=typeof e.buttons?e.which:0===e.buttons?0:e.buttons%2==1?1:e.buttons%4==2?3:e.buttons%8==4?2:0}function f(){d=!1}function v(e){var t=o.default.cornerstone,a=e.currentTarget,l=t.getEnabledElement(a);if(l.image){var d=n.default.MOUSE_DOUBLE_CLICK,u={page:o.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};u.canvas=t.pixelToCanvas(a,u.image);var s=(0,r.default)(u),c={event:e,which:e.which,viewport:t.getViewport(a),image:l.image,element:a,startPoints:u,lastPoints:s,currentPoints:u,deltaPoints:{x:0,y:0},type:d};(0,i.default)(a,d,c)}}function m(e){var t=o.default.cornerstone,a=e.currentTarget,l=t.getEnabledElement(a);if(l.image){u=setTimeout(f,s);var v=n.default.MOUSE_DOWN;a.removeEventListener("mousemove",g);var m={page:o.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};m.canvas=t.pixelToCanvas(a,m.image);var h=(0,r.default)(m),p={event:e,which:c(e),viewport:t.getViewport(a),image:l.image,element:a,startPoints:m,lastPoints:h,currentPoints:m,deltaPoints:{x:0,y:0},type:v};(0,i.default)(p.element,v,p)&&(p.type=n.default.MOUSE_DOWN_ACTIVATE,(0,i.default)(p.element,n.default.MOUSE_DOWN_ACTIVATE,p));var E=c(e);document.addEventListener("mousemove",T),document.addEventListener("mouseup",function e(r){clearTimeout(u);var s=n.default.MOUSE_UP;d&&(s=n.default.MOUSE_CLICK);var c={page:o.default.cornerstoneMath.point.pageToPoint(r),image:t.pageToPixel(a,r.pageX,r.pageY),client:{x:r.clientX,y:r.clientY}};c.canvas=t.pixelToCanvas(a,c.image);var f={page:o.default.cornerstoneMath.point.subtract(c.page,h.page),image:o.default.cornerstoneMath.point.subtract(c.image,h.image),client:o.default.cornerstoneMath.point.subtract(c.client,h.client),canvas:o.default.cornerstoneMath.point.subtract(c.canvas,h.canvas)},v={event:r,which:E,viewport:t.getViewport(a),image:l.image,element:a,startPoints:m,lastPoints:h,currentPoints:c,deltaPoints:f,type:s};(0,i.default)(v.element,s,v),document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",e),a.addEventListener("mousemove",g),d=!0})}function T(e){var d=n.default.MOUSE_DRAG,u={page:o.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};u.canvas=t.pixelToCanvas(a,u.image);var s={page:o.default.cornerstoneMath.point.subtract(u.page,h.page),image:o.default.cornerstoneMath.point.subtract(u.image,h.image),client:o.default.cornerstoneMath.point.subtract(u.client,h.client),canvas:o.default.cornerstoneMath.point.subtract(u.canvas,h.canvas)},c={which:E,viewport:t.getViewport(a),image:l.image,element:a,startPoints:m,lastPoints:h,currentPoints:u,deltaPoints:s,type:d,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};(0,i.default)(c.element,d,c),h=(0,r.default)(u)}}function g(e){var t=o.default.cornerstone,a=e.currentTarget,l=t.getEnabledElement(a);if(l.image){var d=n.default.MOUSE_MOVE,u={page:o.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};u.canvas=t.pixelToCanvas(a,u.image);var s=(0,r.default)(u),c={page:o.default.cornerstoneMath.point.pageToPoint(e),image:t.pageToPixel(a,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};c.canvas=t.pixelToCanvas(a,c.image);var f={page:o.default.cornerstoneMath.point.subtract(c.page,s.page),image:o.default.cornerstoneMath.point.subtract(c.image,s.image),client:o.default.cornerstoneMath.point.subtract(c.client,s.client),canvas:o.default.cornerstoneMath.point.subtract(c.canvas,s.canvas)},v={viewport:t.getViewport(a),image:l.image,element:a,startPoints:u,lastPoints:s,currentPoints:c,deltaPoints:f,type:d};(0,i.default)(a,d,v),s=(0,r.default)(c)}}function h(e){e.removeEventListener("mousedown",m),e.removeEventListener("mousemove",g),e.removeEventListener("dblclick",v)}var p={enable:function(e){h(e),e.addEventListener("mousedown",m),e.addEventListener("mousemove",g),e.addEventListener("dblclick",v)},disable:h};t.default=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}var l=void 0,d=void 0;function u(e){var t=o.default.cornerstone,a=e.currentTarget,i=t.getEnabledElement(a);if(i.image){var u={event:window.event||e,element:a,viewport:t.getViewport(a),image:i.image,currentPoints:{page:{x:l,y:d},image:t.pageToPixel(a,l,d)},keyCode:e.keyCode,which:e.which};u.currentPoints.canvas=t.pixelToCanvas(a,u.currentPoints.image);var s={keydown:n.default.KEY_DOWN,keypress:n.default.KEY_PRESS,keyup:n.default.KEY_UP};(0,r.default)(a,s[e.type],u)}}function s(e){l=e.pageX,d=e.pageY}var c=["keydown","keypress","keyup"];var f={enable:function(e){c.forEach(function(t){e.removeEventListener(t,u),e.addEventListener(t,u)}),e.removeEventListener("mousemove",s),e.addEventListener("mousemove",s)},disable:function(e){c.forEach(function(t){e.removeEventListener(t,u)}),e.removeEventListener("mousemove",s)}};t.default=f},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stopClip=t.playClip=void 0;var n=d(a(1)),o=d(a(0)),r=d(a(12)),i=a(2),l=d(a(5));function d(e){return e&&e.__esModule?e:{default:e}}var u="playClip";function s(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}t.playClip=function(e,t){var a=void 0,d=void 0;if(void 0===e)throw new Error("playClip: element must not be undefined");var c=(0,i.getToolState)(e,"stack");if(c&&c.data&&c.data.length){var f=o.default.cornerstone,v=void 0;if(c.data.length>1){var m=(0,i.getToolState)(e,"stackRenderer");m&&m.data&&m.data.length&&(v=m.data[0])}var g=c.data[0],h=(0,i.getToolState)(e,u);h&&h.data&&h.data.length?s(a=h.data[0]):(a={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},(0,i.addToolState)(e,u,a)),(t<0||t>0)&&(a.framesPerSecond=Number(t),a.reverse=a.framesPerSecond<0,a.ignoreFrameTimeVector=!0),!0!==a.ignoreFrameTimeVector&&a.frameTimeVector&&a.frameTimeVector.length===g.imageIds.length&&(d=function(e,t){var a=void 0,n=void 0,o=void 0,r=0,i=e.length,l=[];for(l.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),a=1;a<i;a++)o=Number(e[a])/t|0,l.push(o),1===a?n=o:o!==n&&(l.isTimeVarying=!0),r+=o;return l.length>0&&(o=l.isTimeVarying?r/l.length|0:l[0],l.push(o)),l}(a.frameTimeVector,a.speed));var p=function(){var t=void 0,o=void 0,i=void 0,d=g.currentImageIdIndex,u=g.imageIds.length;if(a.reverse?d--:d++,!a.loop&&(d<0||d>=u))return s(a),void function(e){var t={element:e};(0,l.default)(e,n.default.CLIP_STOPPED,t)}(e);d>=u&&(d=0),d<0&&(d=u-1),d!==g.currentImageIdIndex&&(t=r.default.getStartLoadHandler(),o=r.default.getEndLoadHandler(),i=r.default.getErrorLoadingHandler(),t&&t(e),(!0===g.preventCache?f.loadImage(g.imageIds[d]):f.loadAndCacheImage(g.imageIds[d])).then(function(t){try{g.currentImageIdIndex=d,v?(v.currentImageIdIndex=d,v.render(e,c.data)):f.displayImage(e,t),o&&o(e,t)}catch(e){return}},function(t){var a=g.imageIds[d];i&&i(e,a,t)}))};d&&d.length>0&&d.isTimeVarying?(a.usingFrameTimeVector=!0,a.intervalId=setTimeout(function e(){a.intervalId=setTimeout(e,d[g.currentImageIdIndex]),p()},0)):(a.usingFrameTimeVector=!1,a.intervalId=setInterval(p,1e3/Math.abs(a.framesPerSecond)))}},t.stopClip=function(e){var t=(0,i.getToolState)(e,u);t&&t.data&&t.data.length&&s(t.data[0])}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),i=(n=r)&&n.__esModule?n:{default:n},l=a(2);var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return o(e,[{key:"render",value:function(e,t){var a=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");t||(t=(0,l.getToolState)(e,"stack").data);var n=i.default.cornerstone,o=t[0],r=o.imageIds[this.currentImageIdIndex],d=t.slice(1,t.length);n.loadAndCacheImage(r).then(function(t){var i=a.layerIds[0];i?n.setLayerImage(e,t,i):(i=n.addLayer(e,t,o.options),a.layerIds.push(i)),n.displayImage(e,t),d.forEach(function(t,o){var l=a.findImageFn(t.imageIds,r),d=o+1,u=a.layerIds[d];u||(u=n.addLayer(e,void 0,t.options),a.layerIds.push(u)),l?n.loadAndCacheImage(l).then(function(t){n.setLayerImage(e,t,u),n.updateImage(e)}):(n.setLayerImage(e,void 0,u),n.setActiveLayer(e,i),n.updateImage(e))})})}}]),e}();t.default=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(98),r=(n=o)&&n.__esModule?n:{default:n};var i={};i.FusionRenderer=r.default,t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(20),r=(n=o)&&n.__esModule?n:{default:n},i=a(2);var l=6;var d=(0,r.default)(function(e){var t=e.detail,a=t.element,n=t.enabledElement.canvas.width,o=t.enabledElement.canvas.height;if(!n||!o)return!1;var r=t.enabledElement.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.save();var u=d.getConfiguration();r.fillStyle=u.backgroundColor,"horizontal"===u.orientation?r.fillRect(0,o-l,n,l):r.fillRect(0,0,l,o);var s=(0,i.getToolState)(a,"stack");if(s&&s.data&&s.data.length){var c=s.data[0].imageIds,f=s.data[0].currentImageIdIndex,v=n/c.length,m=o/c.length,g=v*f,h=m*f;r.fillStyle=u.fillColor,"horizontal"===u.orientation?r.fillRect(g,o-l,v,l):r.fillRect(0,h,l,m),r.restore()}});d.setConfiguration({backgroundColor:"rgb(19, 63, 141)",fillColor:"white",orientation:"horizontal"}),t.default=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(1)),o=u(a(0)),r=u(a(38)),i=u(a(12)),l=a(2),d=a(28);function u(e){return e&&e.__esModule?e:{default:e}}var s="stackPrefetch",c="prefetch",f={maxImagesToPrefetch:1/0},v=void 0,m=10;var g=function(e){return Math.max.apply(null,e)},h=function(e){return Math.min.apply(null,e)};function p(e){var t=(0,l.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var a=t.data[0],n=(0,l.getToolState)(e,s);if(n){var d=n.data[0]||{};if(d.indicesToRequest&&d.indicesToRequest.length||(d.enabled=!1),!1!==d.enabled)if(n.data[0].indicesToRequest.sort(function(e,t){return e-t}),d.indicesToRequest.slice().forEach(function(e){var t=a.imageIds[e];t&&(o.default.cornerstone.imageCache.getImageLoadObject(t)&&I(e))}),d.indicesToRequest.length){r.default.clearRequestStack(c);for(var u,v,m,p,E=(u=d.indicesToRequest,v=a.currentImageIdIndex,m=[],p=[],u.forEach(function(e){e<v?m.push(e):e>v&&p.push(e)}),{low:u.indexOf(g(m)),high:u.indexOf(h(p))}),T=void 0,M=void 0,y=i.default.getErrorLoadingHandler(),x=E.low,O=E.high;x>=0||O<d.indicesToRequest.length;){var _=a.currentImageIdIndex,b=_-d.indicesToRequest[x]>f.maxImagesToPrefetch,S=d.indicesToRequest[O]-_>f.maxImagesToPrefetch,P=!b&&x>=0,C=!S&&O<d.indicesToRequest.length;if(!C&&!P)break;P&&(M=d.indicesToRequest[x--],T=a.imageIds[M],r.default.addRequest(e,T,c,!1,w,L)),C&&(M=d.indicesToRequest[O++],T=a.imageIds[M],r.default.addRequest(e,T,c,!1,w,L))}r.default.startGrabbing()}}}function I(e){var t=d.indicesToRequest.indexOf(e);t>-1&&d.indicesToRequest.splice(t,1)}function w(e){I(a.imageIds.indexOf(e.imageId))}function L(t){console.log("prefetch errored: "+t),y&&y(e,T,t,"stackPrefetch")}}function E(e){return function(t){var a=t.detail,n=void 0;try{n=(0,l.getToolState)(e,"stack")}catch(e){return}if(n&&n.data&&n.data.length){var o=n.data[0].imageIds.indexOf(a.imageId);if(!(o<0)){var r=(0,l.getToolState)(e,s);r&&r.data&&r.data.length&&r.data[0].indicesToRequest.push(o)}}}}function T(e){clearTimeout(v),v=setTimeout(function(){var t=e.target;try{p(t)}catch(e){return}},m)}var M={enable:function(e){(0,l.getToolState)(e,s).data=[];var t=(0,l.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var a=t.data[0];if(!0!==a.preventCache){var r={indicesToRequest:function(e,t){e=Math.round(e)||0;var a=[],n=(t=Math.round(t)||0)-e+1;if(n<=0)return a;for(;n--;)a[n]=t--;return a}(0,a.imageIds.length-1),enabled:!0,direction:1},i=r.indicesToRequest.indexOf(a.currentImageIdIndex);r.indicesToRequest.splice(i,1),(0,l.addToolState)(e,s,r),p(e),e.removeEventListener(n.default.NEW_IMAGE,T),e.addEventListener(n.default.NEW_IMAGE,T);var d=E(e);o.default.cornerstone.events.removeEventListener(n.default.IMAGE_CACHE_PROMISE_REMOVED,d),o.default.cornerstone.events.addEventListener(n.default.IMAGE_CACHE_PROMISE_REMOVED,d)}else console.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(e){clearTimeout(v),e.removeEventListener(n.default.NEW_IMAGE,T);var t=E(e);o.default.cornerstone.events.removeEventListener(n.default.IMAGE_CACHE_PROMISE_REMOVED,t);var a=(0,l.getToolState)(e,s);a&&a.data.length&&(a.data[0].enabled=!1,r.default.clearRequestStack(c))},getConfiguration:function(){return f},setConfiguration:function(e){f=e,e.maxSimultaneousRequests&&(0,d.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}};t.default=M},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackScrollMultiTouch=t.stackScrollTouchDrag=t.stackScrollWheel=t.stackScroll=void 0;var n=f(a(1)),o=f(a(16)),r=f(a(29)),i=f(a(15)),l=f(a(24)),d=f(a(4)),u=f(a(37)),s=a(2),c=a(3);function f(e){return e&&e.__esModule?e:{default:e}}var v="stackScroll";function m(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,g),t.removeEventListener(n.default.MOUSE_UP,m),t.removeEventListener(n.default.MOUSE_CLICK,m)}function g(e){var t=e.detail,a=t.element,n=(0,s.getToolState)(a,"stack");if(n&&n.data&&n.data.length){var o=n.data[0],r=h.getConfiguration(),i=!0;r&&void 0!==r.allowSkipping&&(i=r.allowSkipping);var l=Math.max(2,a.offsetHeight/Math.max(o.imageIds.length,8));r&&r.stackScrollSpeed&&(l=r.stackScrollSpeed);var d=(0,c.getToolOptions)(v,a),f=d.deltaY||0;if(f+=t.deltaPoints.page.y,Math.abs(f)>=l){var m=Math.round(f/l);(0,u.default)(a,m,!1,i),d.deltaY=f%l}else d.deltaY=f;(0,c.setToolOptions)(v,a,d),e.preventDefault(),e.stopPropagation()}}var h=(0,i.default)(function(e){var t=e.detail,a=t.element,o=(0,c.getToolOptions)(v,a);if((0,d.default)(t.which,o.mouseButtonMask))return o.deltaY=0,(0,c.setToolOptions)(v,a,o),a.addEventListener(n.default.MOUSE_DRAG,g),a.addEventListener(n.default.MOUSE_UP,m),a.addEventListener(n.default.MOUSE_CLICK,m),e.stopImmediatePropagation(),!1},v),p=(0,l.default)(function(e){var t=e.detail,a=-t.direction,n=h.getConfiguration(),o=!1,r=!0;n&&(o=void 0!==n.loop&&n.loop,r=void 0===n.allowSkipping||n.allowSkipping),(0,u.default)(t.element,a,o,r)}),E={eventData:{deltaY:0}},T=(0,o.default)(g,"stackScrollTouchDrag",E);var M=(0,r.default)(function(e){var t=e.detail,a=M.getConfiguration();a&&a.testPointers(t)&&g(e)},E);M.setConfiguration({testPointers:function(e){return e.numPointers>=3}}),t.stackScroll=h,t.stackScrollWheel=p,t.stackScrollTouchDrag=T,t.stackScrollMultiTouch=M},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(37));function o(e){return e&&e.__esModule?e:{default:e}}var r={UP:38,DOWN:40};var i=(0,o(a(49)).default)(function(e){var t=e.detail,a=t.keyCode;if(a===r.UP||a===r.DOWN){var o=1;a===r.DOWN&&(o=-1),(0,n.default)(t.element,o)}});t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n},i=a(22),l=a(2);var d={save:function(e){var t={imageIdToolState:i.globalImageIdSpecificToolStateManager.saveToolState(),elementToolState:{},elementViewport:{}};return e.forEach(function(e){var a=(0,l.getElementToolStateManager)(e);a!==i.globalImageIdSpecificToolStateManager&&(t.elementToolState[e.id]=a.saveToolState(),t.elementViewport[e.id]=r.default.cornerstone.getViewport(e))}),t},restore:function(e){if(e.hasOwnProperty("imageIdToolState")&&e.hasOwnProperty("elementToolState")&&e.hasOwnProperty("elementViewport")){var t=r.default.cornerstone;return i.globalImageIdSpecificToolStateManager.restoreToolState(e.imageIdToolState),Object.keys(e.elementViewport).forEach(function(a){var n=document.getElementById(a);if(n&&e.elementToolState.hasOwnProperty(a)){var o=(0,l.getElementToolStateManager)(n);if(o!==i.globalImageIdSpecificToolStateManager){o.restoreToolState(e.elementToolState[a]);var r=e.elementViewport[a];t.setViewport(n,r),t.updateImage(n)}}}),e}}};t.default=d},function(e,t,a){"use strict";function n(){var e={};return{get:function(t,a){if(!1!==e.hasOwnProperty(t)){var n=e[t];if(!1!==n.hasOwnProperty(a))return n[a]}},add:function(t,a,n){!1===e.hasOwnProperty(t)&&(e[t]={});var o=e[t];!1===o.hasOwnProperty(a)&&(o[a]={data:[]}),o[a].data.push(n)},remove:function(t,a,n){if(!1!==e.hasOwnProperty(t)){var o=e[t];if(!1!==o.hasOwnProperty(a)){for(var r=o[a],i=-1,l=0;l<r.data.length;l++)r.data[l]===n&&(i=l);-1!==i&&r.data.splice(i,1)}}}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n();t.newFrameOfReferenceSpecificToolStateManager=n,t.globalFrameOfReferenceSpecificToolStateManager=o},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addStackStateManager=t.newStackSpecificToolStateManager=t.stackSpecificStateManager=void 0;var n=a(22),o=a(2);function r(e,t){var a={};return{get:function(n,o){return e.indexOf(o)>=0?(!1===a.hasOwnProperty(o)&&(a[o]={data:[]}),a[o]):t.get(n,o)},add:function(n,o,r){if(!(e.indexOf(o)>=0))return t.add(n,o,r);!1===a.hasOwnProperty(o)&&(a[o]={data:[]}),a[o].data.push(r)},saveToolState:function(){return a},restoreToolState:function(e){a=e},toolState:a}}var i=[];function l(e,t){var a=(0,o.getElementToolStateManager)(e);a||(a=n.globalImageIdSpecificToolStateManager);var l=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(l=l.concat(t));var d=r(l,a);i.push(d),(0,o.setElementToolStateManager)(e,d)}var d={newStackSpecificToolStateManager:r,addStackStateManager:l};t.stackSpecificStateManager=d,t.newStackSpecificToolStateManager=r,t.addStackStateManager=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newTimeSeriesSpecificToolStateManager=t.addTimeSeriesStateManager=void 0;var n=a(22),o=a(2);function r(e,t){var a={};return{get:function(n,o){return e.indexOf(o)>=0?(!1===a.hasOwnProperty(o)&&(a[o]={data:[]}),a[o]):t.get(n,o)},add:function(n,o,r){if(!(e.indexOf(o)>=0))return t.add(n,o,r);!1===a.hasOwnProperty(o)&&(a[o]={data:[]}),a[o].data.push(r)}}}var i=[];t.addTimeSeriesStateManager=function(e,t){t=t||["timeSeries"];var a=(0,o.getElementToolStateManager)(e);void 0===a&&(a=n.globalImageIdSpecificToolStateManager);var l=r(t,a);i.push(l),(0,o.setElementToolStateManager)(e,l)},t.newTimeSeriesSpecificToolStateManager=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var n=r.default.cornerstone,o=n.getViewport(t),i=n.getViewport(a);i.scale===o.scale&&i.translation.x===o.translation.x&&i.translation.y===o.translation.y||(i.scale=o.scale,i.translation.x=o.translation.x,i.translation.y=o.translation.y,e.setViewport(a,i))}};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var i=n.default.cornerstone,l=(0,o.getToolState)(t,"stack").data[0],d=(0,o.getToolState)(a,"stack").data[0],u=l.currentImageIdIndex;if((u=Math.min(Math.max(u,0),d.imageIds.length-1))!==d.currentImageIdIndex){var s=r.default.getStartLoadHandler(),c=r.default.getEndLoadHandler(),f=r.default.getErrorLoadingHandler();s&&s(a);(!0===d.preventCache?i.loadImage(d.imageIds[u]):i.loadAndCacheImage(d.imageIds[u])).then(function(t){var n=i.getViewport(a);d.currentImageIdIndex=u,e.displayImage(a,t,n),c&&c(a,t)},function(e){var t=d.imageIds[u];f&&f(a,t,e)})}}};var n=i(a(0)),o=a(2),r=i(a(12));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,l,d){if(a!==t){var u=n.default.cornerstone,s=u.getEnabledElement(t),c=u.metaData.get("imagePlaneModule",s.image.imageId),f=(0,i.default)(c.imagePositionPatient),v=(0,o.getToolState)(a,"stack").data[0],m=Number.MAX_VALUE,g=-1;if(d){var h=f.clone().add(d);if(v.imageIds.forEach(function(e,t){var a=u.metaData.get("imagePlaneModule",e),n=(0,i.default)(a.imagePositionPatient),o=h.distanceToSquared(n);o<m&&(m=o,g=t)}),g!==v.currentImageIdIndex&&-1!==g){var p=r.default.getStartLoadHandler(),E=r.default.getEndLoadHandler(),T=r.default.getErrorLoadingHandler();p&&p(a);(!0===v.preventCache?u.loadImage(v.imageIds[g]):u.loadAndCacheImage(v.imageIds[g])).then(function(t){var n=u.getViewport(a);v.currentImageIdIndex=g,e.displayImage(a,t,n),E&&E(a,t)},function(e){var t=v.imageIds[g];T&&T(a,t,e)})}}}};var n=l(a(0)),o=a(2),r=l(a(12)),i=l(a(17));function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var l=n.default.cornerstone,d=l.getEnabledElement(t).image,u=l.metaData.get("imagePlaneModule",d.imageId);if(void 0!==u&&void 0!==u.imagePositionPatient){var s=(0,i.default)(u.imagePositionPatient),c=(0,o.getToolState)(a,"stack").data[0],f=Number.MAX_VALUE,v=-1;if(c.imageIds.forEach(function(e,t){var a=l.metaData.get("imagePlaneModule",e);if(void 0!==a&&void 0!==a.imagePositionPatient){var n=(0,i.default)(a.imagePositionPatient).distanceToSquared(s);n<f&&(f=n,v=t)}}),v!==c.currentImageIdIndex){var m=r.default.getStartLoadHandler(),g=r.default.getEndLoadHandler(),h=r.default.getErrorLoadingHandler();if(m&&m(a),-1!==v){(!0===c.preventCache?l.loadImage(c.imageIds[v]):l.loadAndCacheImage(c.imageIds[v])).then(function(t){var n=l.getViewport(a);c.currentImageIdIndex=v,e.displayImage(a,t,n),g&&g(a,t)},function(e){var t=c.imageIds[v];h&&h(a,t,e)})}}}}};var n=l(a(0)),o=a(2),r=l(a(12)),i=l(a(17));function l(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,i){if(t!==a&&i&&i.direction){var l=n.default.cornerstone,d=(0,o.getToolState)(a,"stack").data[0],u=d.currentImageIdIndex+i.direction;if(u=Math.min(Math.max(u,0),d.imageIds.length-1),d.currentImageIdIndex!==u){var s=r.default.getStartLoadHandler(),c=r.default.getEndLoadHandler(),f=r.default.getErrorLoadingHandler();s&&s(a);(!0===d.preventCache?l.loadImage(d.imageIds[u]):l.loadAndCacheImage(d.imageIds[u])).then(function(t){var n=l.getViewport(a);d.currentImageIdIndex=u,e.displayImage(a,t,n),c&&c(a,t)},function(e){var t=d.imageIds[u];f&&f(a,t,e)})}}};var n=i(a(0)),o=a(2),r=i(a(12));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),o=l(a(0)),r=l(a(17)),i=a(3);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){return e.filter(function(e,t,a){return a.indexOf(e)===t})}t.default=function(e,t){var a=o.default.cornerstone,l=this,u=[],s=[],c=!1,f={},v=t;function m(e,t){u.length&&s.length&&(c=!0,s.forEach(function(a){var n=s.indexOf(a);if(-1!==n){var o=f.imageIds.targetElements[n],r=u.indexOf(e);if(-1!==r){var i=f.imageIds.sourceElements[r],d=void 0;i===o?d=0:void 0!==f.distances[i]&&(d=f.distances[i][o]),v(l,e,a,t,d)}}}),c=!1)}function g(e){var t=e.detail;!0!==c&&m(e.currentTarget,t)}function h(e){var t=e.detail.element;l.remove(t),(0,i.clearToolOptionsByElement)(t)}this.setHandler=function(e){v=e},this.getHandler=function(){return v},this.getDistances=function(){u.length&&s.length&&(f.distances={},f.imageIds={sourceElements:[],targetElements:[]},u.forEach(function(e){var t=a.getEnabledElement(e);if(t&&t.image){var n=t.image.imageId,o=a.metaData.get("imagePlaneModule",n);if(o&&o.imagePositionPatient){var i=(0,r.default)(o.imagePositionPatient);f.hasOwnProperty(t)||(f.distances[n]={},f.imageIds.sourceElements.push(n),s.forEach(function(t){var o=a.getEnabledElement(t);if(o&&o.image){var l=o.image.imageId;if(f.imageIds.targetElements.push(l),e!==t&&n!==l&&!f.distances[n].hasOwnProperty(l)){var d=a.metaData.get("imagePlaneModule",l);if(d&&d.imagePositionPatient){var u=(0,r.default)(d.imagePositionPatient);f.distances[n][l]=u.clone().sub(i)}}}}),Object.keys(f.distances[n]).length||delete f.distances[n])}}}))},this.addSource=function(t){-1===u.indexOf(t)&&(u.push(t),e.split(" ").forEach(function(e){t.addEventListener(e,g)}),l.getDistances(),l.updateDisableHandlers())},this.addTarget=function(e){-1===s.indexOf(e)&&(s.push(e),l.getDistances(),v(l,e,e,0),l.updateDisableHandlers())},this.add=function(e){l.addSource(e),l.addTarget(e)},this.removeSource=function(t){var a=u.indexOf(t);-1!==a&&(u.splice(a,1),e.split(" ").forEach(function(e){t.removeEventListener(e,g)}),l.getDistances(),m(t),l.updateDisableHandlers())},this.removeTarget=function(e){var t=s.indexOf(e);-1!==t&&(s.splice(t,1),l.getDistances(),v(l,e,e,0),l.updateDisableHandlers())},this.remove=function(e){l.removeTarget(e),l.removeSource(e)},this.getSourceElements=function(){return u},this.getTargetElements=function(){return s},this.displayImage=function(e,t,n){c=!0,a.displayImage(e,t,n),c=!1},this.setViewport=function(e,t){c=!0,a.setViewport(e,t),c=!1},this.updateDisableHandlers=function(){d(u.concat(s)).forEach(function(e){e.removeEventListener(n.default.ELEMENT_DISABLED,h),e.addEventListener(n.default.ELEMENT_DISABLED,h)})},this.destroy=function(){d(u.concat(s)).forEach(function(e){l.remove(e)})}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){a!==t&&r.default.cornerstone.updateImage(a)};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){if(a!==t){var n=r.default.cornerstone,o=n.getViewport(t),i=n.getViewport(a);i.voi.windowWidth===o.voi.windowWidth&&i.voi.windowCenter===o.voi.windowCenter&&i.invert===o.invert||(i.voi.windowWidth=o.voi.windowWidth,i.voi.windowCenter=o.voi.windowCenter,i.invert=o.invert,e.setViewport(a,i))}};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeSeriesScrollTouchDrag=t.timeSeriesScrollWheel=t.timeSeriesScroll=void 0;var n=c(a(1)),o=c(a(15)),r=c(a(16)),i=c(a(24)),l=c(a(30)),d=c(a(4)),u=a(2),s=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var f="timeSeriesScroll";function v(e){var t=e.detail.element;t.removeEventListener(n.default.MOUSE_DRAG,m),t.removeEventListener(n.default.MOUSE_UP,v),t.removeEventListener(n.default.MOUSE_CLICK,v)}function m(e){var t=e.detail,a=t.element;e.data.deltaY+=t.deltaPoints.page.y;var n=(0,u.getToolState)(t.element,"timeSeries");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){var o=n.data[0],r=a.offsetHeight/o.stacks.length;if(void 0!==e.data.options&&void 0!==e.data.options.timeSeriesScrollSpeed&&(r=e.data.options.timeSeriesScrollSpeed),e.data.deltaY>=r||e.data.deltaY<=-r){var i=Math.round(e.data.deltaY/r),d=e.data.deltaY%r;(0,l.default)(t.element,i),e.data.deltaY=d}return!1}}var g=(0,o.default)(function(e){var t=e.detail,a=t.element,o=(0,s.getToolOptions)(f,a);if((0,d.default)(t.which,o.mouseButtonMask))return o.deltaY=0,(0,s.setToolOptions)(f,a,o),a.addEventListener(n.default.MOUSE_DRAG,m),a.addEventListener(n.default.MOUSE_UP,v),a.addEventListener(n.default.MOUSE_CLICK,v),e.stopImmediatePropagation(),!1},f),h=(0,i.default)(function(e){var t=e.detail,a=-t.direction;(0,l.default)(t.element,a)}),p=(0,r.default)(function(e){var t=e.originalEvent.detail,a={deltaY:0};a.deltaY+=t.deltaPoints.page.y;var n=(0,u.getToolState)(t.element,"stack");if(void 0!==n&&void 0!==n.data&&0!==n.data.length){if(a.deltaY>=3||a.deltaY<=-3){var o=a.deltaY/3,r=a.deltaY%3;(0,l.default)(a.element,o),a.deltaY=r}return!1}});t.timeSeriesScroll=g,t.timeSeriesScrollWheel=h,t.timeSeriesScrollTouchDrag=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(2),r=a(30),i=(n=r)&&n.__esModule?n:{default:n};var l="timeSeriesPlayer";var d={start:function(e,t){if(void 0===e)throw new Error("playClip: element must not be undefined");void 0===t&&(t=30);var a=(0,o.getToolState)(e,"timeSeries");if(void 0!==a&&void 0!==a.data&&0!==a.data.length){var n=(0,o.getToolState)(e,l),r=void 0;void 0===n||0===n.data.length?(r={intervalId:void 0,framesPerSecond:t,lastFrameTimeStamp:void 0,frameRate:0},(0,o.addToolState)(e,l,r)):(r=n.data[0]).framesPerSecond=t,void 0===r.intervalId&&(r.intervalId=setInterval(function(){r.framesPerSecond>0?(0,i.default)(e,1,!0):(0,i.default)(e,-1,!0)},1e3/Math.abs(r.framesPerSecond)))}},stop:function(e){var t=(0,o.getToolState)(e,l);if(t&&t.data&&t.data.length){var a=t.data[0];clearInterval(a.intervalId),a.intervalId=void 0}}};t.default=d},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=o.default.cornerstone,t=this;t.samples=[],this.set=function(a){t.samples=a,(0,r.default)(e.events,n.default.LINE_SAMPLE_UPDATED)}};var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(1)),o=i(a(0)),r=i(a(5));function i(e){return e&&e.__esModule?e:{default:e}}var l=new function(){var e=o.default.cornerstone,t=this;t.measurements=[],this.add=function(a){var o={index:t.measurements.push(a),measurement:a};(0,r.default)(e.events,n.default.MEASUREMENT_ADDED,o)},this.remove=function(a){var o=t.measurements[a];t.measurements.splice(a,1);var i={index:a,measurement:o};(0,r.default)(e.events,n.default.MEASUREMENT_REMOVED,i)}};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(0)),o=c(a(10)),r=c(a(9)),i=a(2),l=c(a(119)),d=c(a(118)),u=c(a(14)),s=c(a(7));function c(e){return e&&e.__esModule?e:{default:e}}var f="probe4D";var v=(0,o.default)({createNewMeasurement:function(e){var t=(0,i.getToolState)(e.element,"timeSeries");if(void 0!==t&&void 0!==t.data&&0!==t.data.length){var a=t.data[0],o={timeSeries:a,lineSample:new d.default,imageIdIndex:a.stacks[a.currentStackIndex].currentImageIdIndex,visible:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};return function(e){var t=n.default.cornerstone,a=[];e.timeSeries.stacks.forEach(function(n){(!0===n.preventCache?t.loadImage(n.imageIds[e.imageIdIndex]):t.loadAndCacheImage(n.imageIds[e.imageIdIndex])).then(function(t){var n=Math.round(e.handles.end.x)+Math.round(e.handles.end.y)*t.width,o=t.getPixelData()[n];a.push(o)})}),e.lineSample.set(a)}(o),l.default.add(o),o}},onImageRendered:function(e){var t=n.default.cornerstone,a=e.detail,o=(0,i.getToolState)(e.currentTarget,f);if(o){var l=a.canvasContext;l.setTransform(1,0,0,1,0,0);for(var d=u.default.getFont(),c=0;c<o.data.length;c++){l.save();var v=o.data[c];l.beginPath(),(0,r.default)(l,a,v.handles,"white"),l.stroke(),l.font=d;var m={x:v.handles.end.x+3,y:v.handles.end.y-3},g=t.pixelToCanvas(a.element,m);l.fillStyle="white",(0,s.default)(l,v.handles.end.x+", "+v.handles.end.y,g.x,g.y,"white"),l.restore()}}},toolType:f});t.default=v},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.style.webkitUserSelect="none",e.style.webkitTouchCallout="none",e.style.mozUserSelect="none",e.style.msUserSelect="none",e.style.oUserSelect="none",e.style.khtmlUserSelect="none",e.style.userSelect="none",e.unselectable="on",e.oncontextmenu=function(){return!1},!0===t&&(e.style.pointerEvents="none")}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){return r.default.cornerstone.setToPixelCoordinateSystem(e,t,.1),{fontSize:a/e.viewport.scale/.1,lineHeight:a/e.viewport.scale/.1,fontScale:.1}};var n,o=a(0),r=(n=o)&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace("H","f");return t=(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=(0,o.default)(e),a="",r=t.x<0?"R":"L",i=t.y<0?"A":"P",l=t.z<0?"F":"H",d=new n.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),u=0;u<3;u++)if(d.x>1e-4&&d.x>d.y&&d.x>d.z)a+=r,d.x=0;else if(d.y>1e-4&&d.y>d.x&&d.y>d.z)a+=i,d.y=0;else{if(!(d.z>1e-4&&d.z>d.x&&d.z>d.y))break;a+=l,d.z=0}return a};var n=r(a(0)),o=r(a(17));function r(e){return e&&e.__esModule?e:{default:e}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(1)),o=l(a(0)),r=a(2),i=l(a(57));function l(e){return e&&e.__esModule?e:{default:e}}var d="referenceLines";function u(e){var t=e.detail,a=(0,r.getToolState)(e.currentTarget,d);if(void 0!==a){var n=a.data[0].synchronizationContext.getSourceElements(),i=a.data[0].renderer,l=t.canvasContext.canvas.getContext("2d");o.default.cornerstone.setToPixelCoordinateSystem(t.enabledElement,l),n.forEach(function(a){a!==e.currentTarget&&i(l,t,e.currentTarget,a)})}}var s={enable:function(e,t,a){a=a||i.default,(0,r.addToolState)(e,d,{synchronizationContext:t,renderer:a}),e.removeEventListener(n.default.IMAGE_RENDERED,u),e.addEventListener(n.default.IMAGE_RENDERED,u),o.default.cornerstone.updateImage(e)},disable:function(e){e.removeEventListener(n.default.IMAGE_RENDERED,u),o.default.cornerstone.updateImage(e)}};t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(58)),o=i(a(125)),r=i(a(57));function i(e){return e&&e.__esModule?e:{default:e}}var l={calculateReferenceLine:n.default,tool:o.default,renderActiveReferenceLine:r.default};t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(0);Object.defineProperty(t,"external",{enumerable:!0,get:function(){return ot(n).default}});var o=a(1);Object.defineProperty(t,"EVENTS",{enumerable:!0,get:function(){return ot(o).default}});var r=a(126);Object.defineProperty(t,"referenceLines",{enumerable:!0,get:function(){return ot(r).default}});var i=a(56);Object.defineProperty(t,"orientation",{enumerable:!0,get:function(){return ot(i).default}});var l=a(38);Object.defineProperty(t,"requestPoolManager",{enumerable:!0,get:function(){return ot(l).default}});var d=a(122);Object.defineProperty(t,"setContextToDisplayFontSize",{enumerable:!0,get:function(){return ot(d).default}});var u=a(55);Object.defineProperty(t,"scrollToIndex",{enumerable:!0,get:function(){return ot(u).default}});var s=a(37);Object.defineProperty(t,"scroll",{enumerable:!0,get:function(){return ot(s).default}});var c=a(36);Object.defineProperty(t,"roundToDecimal",{enumerable:!0,get:function(){return ot(c).default}});var f=a(39);Object.defineProperty(t,"projectPatientPointToImagePlane",{enumerable:!0,get:function(){return f.projectPatientPointToImagePlane}}),Object.defineProperty(t,"imagePointToPatientPoint",{enumerable:!0,get:function(){return f.imagePointToPatientPoint}}),Object.defineProperty(t,"planePlaneIntersection",{enumerable:!0,get:function(){return f.planePlaneIntersection}});var v=a(19);Object.defineProperty(t,"pointInsideBoundingBox",{enumerable:!0,get:function(){return ot(v).default}});var m=a(35);Object.defineProperty(t,"pointInEllipse",{enumerable:!0,get:function(){return ot(m).default}});var g=a(121);Object.defineProperty(t,"makeUnselectable",{enumerable:!0,get:function(){return ot(g).default}});var h=a(4);Object.defineProperty(t,"isMouseButtonEnabled",{enumerable:!0,get:function(){return ot(h).default}});var p=a(34);Object.defineProperty(t,"getRGBPixels",{enumerable:!0,get:function(){return ot(p).default}});var E=a(28);Object.defineProperty(t,"getDefaultSimultaneousRequests",{enumerable:!0,get:function(){return E.getDefaultSimultaneousRequests}}),Object.defineProperty(t,"getMaxSimultaneousRequests",{enumerable:!0,get:function(){return E.getMaxSimultaneousRequests}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return E.getBrowserInfo}}),Object.defineProperty(t,"isMobileDevice",{enumerable:!0,get:function(){return E.isMobileDevice}});var T=a(54);Object.defineProperty(t,"getLuminance",{enumerable:!0,get:function(){return ot(T).default}});var M=a(7);Object.defineProperty(t,"drawTextBox",{enumerable:!0,get:function(){return ot(M).default}});var y=a(53);Object.defineProperty(t,"drawEllipse",{enumerable:!0,get:function(){return ot(y).default}});var x=a(52);Object.defineProperty(t,"drawCircle",{enumerable:!0,get:function(){return ot(x).default}});var O=a(51);Object.defineProperty(t,"drawArrow",{enumerable:!0,get:function(){return ot(O).default}});var _=a(33);Object.defineProperty(t,"copyPoints",{enumerable:!0,get:function(){return ot(_).default}});var b=a(18);Object.defineProperty(t,"calculateSUV",{enumerable:!0,get:function(){return ot(b).default}});var S=a(50);Object.defineProperty(t,"calculateEllipseStatistics",{enumerable:!0,get:function(){return ot(S).default}});var P=a(120);Object.defineProperty(t,"probeTool4D",{enumerable:!0,get:function(){return ot(P).default}});var C=a(30);Object.defineProperty(t,"incrementTimePoint",{enumerable:!0,get:function(){return ot(C).default}});var I=a(117);Object.defineProperty(t,"timeSeriesPlayer",{enumerable:!0,get:function(){return ot(I).default}});var w=a(116);Object.defineProperty(t,"timeSeriesScroll",{enumerable:!0,get:function(){return w.timeSeriesScroll}}),Object.defineProperty(t,"timeSeriesScrollWheel",{enumerable:!0,get:function(){return w.timeSeriesScrollWheel}}),Object.defineProperty(t,"timeSeriesScrollTouchDrag",{enumerable:!0,get:function(){return w.timeSeriesScrollTouchDrag}});var L=a(115);Object.defineProperty(t,"wwwcSynchronizer",{enumerable:!0,get:function(){return ot(L).default}});var D=a(114);Object.defineProperty(t,"updateImageSynchronizer",{enumerable:!0,get:function(){return ot(D).default}});var U=a(113);Object.defineProperty(t,"Synchronizer",{enumerable:!0,get:function(){return ot(U).default}});var A=a(112);Object.defineProperty(t,"stackScrollSynchronizer",{enumerable:!0,get:function(){return ot(A).default}});var R=a(111);Object.defineProperty(t,"stackImagePositionSynchronizer",{enumerable:!0,get:function(){return ot(R).default}});var k=a(110);Object.defineProperty(t,"stackImagePositionOffsetSynchronizer",{enumerable:!0,get:function(){return ot(k).default}});var j=a(109);Object.defineProperty(t,"stackImageIndexSynchronizer",{enumerable:!0,get:function(){return ot(j).default}});var H=a(108);Object.defineProperty(t,"panZoomSynchronizer",{enumerable:!0,get:function(){return ot(H).default}});var N=a(8);Object.defineProperty(t,"toolStyle",{enumerable:!0,get:function(){return ot(N).default}});var V=a(2);Object.defineProperty(t,"addToolState",{enumerable:!0,get:function(){return V.addToolState}}),Object.defineProperty(t,"getToolState",{enumerable:!0,get:function(){return V.getToolState}}),Object.defineProperty(t,"removeToolState",{enumerable:!0,get:function(){return V.removeToolState}}),Object.defineProperty(t,"clearToolState",{enumerable:!0,get:function(){return V.clearToolState}}),Object.defineProperty(t,"setElementToolStateManager",{enumerable:!0,get:function(){return V.setElementToolStateManager}}),Object.defineProperty(t,"getElementToolStateManager",{enumerable:!0,get:function(){return V.getElementToolStateManager}});var B=a(32);Object.defineProperty(t,"toolCoordinates",{enumerable:!0,get:function(){return ot(B).default}});var W=a(6);Object.defineProperty(t,"toolColors",{enumerable:!0,get:function(){return ot(W).default}});var G=a(107);Object.defineProperty(t,"addTimeSeriesStateManager",{enumerable:!0,get:function(){return G.addTimeSeriesStateManager}}),Object.defineProperty(t,"newTimeSeriesSpecificToolStateManager",{enumerable:!0,get:function(){return G.newTimeSeriesSpecificToolStateManager}});var F=a(14);Object.defineProperty(t,"textStyle",{enumerable:!0,get:function(){return ot(F).default}});var Y=a(106);Object.defineProperty(t,"stackSpecificStateManager",{enumerable:!0,get:function(){return Y.stackSpecificStateManager}}),Object.defineProperty(t,"newStackSpecificToolStateManager",{enumerable:!0,get:function(){return Y.newStackSpecificToolStateManager}}),Object.defineProperty(t,"addStackStateManager",{enumerable:!0,get:function(){return Y.addStackStateManager}});var z=a(12);Object.defineProperty(t,"loadHandlerManager",{enumerable:!0,get:function(){return ot(z).default}});var K=a(22);Object.defineProperty(t,"newImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return K.newImageIdSpecificToolStateManager}}),Object.defineProperty(t,"globalImageIdSpecificToolStateManager",{enumerable:!0,get:function(){return K.globalImageIdSpecificToolStateManager}});var q=a(105);Object.defineProperty(t,"newFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return q.newFrameOfReferenceSpecificToolStateManager}}),Object.defineProperty(t,"globalFrameOfReferenceSpecificToolStateManager",{enumerable:!0,get:function(){return q.globalFrameOfReferenceSpecificToolStateManager}});var X=a(104);Object.defineProperty(t,"appState",{enumerable:!0,get:function(){return ot(X).default}});var Z=a(103);Object.defineProperty(t,"stackScrollKeyboard",{enumerable:!0,get:function(){return ot(Z).default}});var J=a(102);Object.defineProperty(t,"stackScroll",{enumerable:!0,get:function(){return J.stackScroll}}),Object.defineProperty(t,"stackScrollWheel",{enumerable:!0,get:function(){return J.stackScrollWheel}}),Object.defineProperty(t,"stackScrollTouchDrag",{enumerable:!0,get:function(){return J.stackScrollTouchDrag}}),Object.defineProperty(t,"stackScrollMultiTouch",{enumerable:!0,get:function(){return J.stackScrollMultiTouch}});var Q=a(101);Object.defineProperty(t,"stackPrefetch",{enumerable:!0,get:function(){return ot(Q).default}});var $=a(100);Object.defineProperty(t,"scrollIndicator",{enumerable:!0,get:function(){return ot($).default}});var ee=a(99);Object.defineProperty(t,"stackRenderers",{enumerable:!0,get:function(){return ot(ee).default}});var te=a(97);Object.defineProperty(t,"playClip",{enumerable:!0,get:function(){return te.playClip}}),Object.defineProperty(t,"stopClip",{enumerable:!0,get:function(){return te.stopClip}});var ae=a(13);Object.defineProperty(t,"anyHandlesOutsideImage",{enumerable:!0,get:function(){return ot(ae).default}});var ne=a(9);Object.defineProperty(t,"drawHandles",{enumerable:!0,get:function(){return ot(ne).default}});var oe=a(21);Object.defineProperty(t,"getHandleNearImagePoint",{enumerable:!0,get:function(){return ot(oe).default}});var re=a(27);Object.defineProperty(t,"handleActivator",{enumerable:!0,get:function(){return ot(re).default}});var ie=a(31);Object.defineProperty(t,"moveAllHandles",{enumerable:!0,get:function(){return ot(ie).default}});var le=a(26);Object.defineProperty(t,"moveHandle",{enumerable:!0,get:function(){return ot(le).default}});var de=a(25);Object.defineProperty(t,"moveNewHandle",{enumerable:!0,get:function(){return ot(de).default}});var ue=a(23);Object.defineProperty(t,"moveNewHandleTouch",{enumerable:!0,get:function(){return ot(ue).default}});var se=a(48);Object.defineProperty(t,"touchMoveAllHandles",{enumerable:!0,get:function(){return ot(se).default}});var ce=a(47);Object.defineProperty(t,"touchMoveHandle",{enumerable:!0,get:function(){return ot(ce).default}});var fe=a(96);Object.defineProperty(t,"keyboardInput",{enumerable:!0,get:function(){return ot(fe).default}});var ve=a(95);Object.defineProperty(t,"mouseInput",{enumerable:!0,get:function(){return ot(ve).default}});var me=a(94);Object.defineProperty(t,"mouseWheelInput",{enumerable:!0,get:function(){return ot(me).default}});var ge=a(46);Object.defineProperty(t,"preventGhostClick",{enumerable:!0,get:function(){return ot(ge).default}});var he=a(93);Object.defineProperty(t,"touchInput",{enumerable:!0,get:function(){return ot(he).default}});var pe=a(92);Object.defineProperty(t,"angle",{enumerable:!0,get:function(){return pe.angle}}),Object.defineProperty(t,"angleTouch",{enumerable:!0,get:function(){return pe.angleTouch}});var Ee=a(91);Object.defineProperty(t,"arrowAnnotate",{enumerable:!0,get:function(){return Ee.arrowAnnotate}}),Object.defineProperty(t,"arrowAnnotateTouch",{enumerable:!0,get:function(){return Ee.arrowAnnotateTouch}});var Te=a(90);Object.defineProperty(t,"crosshairs",{enumerable:!0,get:function(){return Te.crosshairs}}),Object.defineProperty(t,"crosshairsTouch",{enumerable:!0,get:function(){return Te.crosshairsTouch}});var Me=a(20);Object.defineProperty(t,"displayTool",{enumerable:!0,get:function(){return ot(Me).default}});var ye=a(45);Object.defineProperty(t,"doubleTapTool",{enumerable:!0,get:function(){return ot(ye).default}});var xe=a(89);Object.defineProperty(t,"doubleTapZoom",{enumerable:!0,get:function(){return ot(xe).default}});var Oe=a(88);Object.defineProperty(t,"dragProbe",{enumerable:!0,get:function(){return Oe.dragProbe}}),Object.defineProperty(t,"dragProbeTouch",{enumerable:!0,get:function(){return Oe.dragProbeTouch}});var _e=a(87);Object.defineProperty(t,"ellipticalRoi",{enumerable:!0,get:function(){return _e.ellipticalRoi}}),Object.defineProperty(t,"ellipticalRoiTouch",{enumerable:!0,get:function(){return _e.ellipticalRoiTouch}});var be=a(86);Object.defineProperty(t,"freehand",{enumerable:!0,get:function(){return be.freehand}});var Se=a(81);Object.defineProperty(t,"highlight",{enumerable:!0,get:function(){return Se.highlight}}),Object.defineProperty(t,"highlightTouch",{enumerable:!0,get:function(){return Se.highlightTouch}});var Pe=a(80);Object.defineProperty(t,"imageStats",{enumerable:!0,get:function(){return ot(Pe).default}});var Ce=a(49);Object.defineProperty(t,"keyboardTool",{enumerable:!0,get:function(){return ot(Ce).default}});var Ie=a(79);Object.defineProperty(t,"length",{enumerable:!0,get:function(){return Ie.length}}),Object.defineProperty(t,"lengthTouch",{enumerable:!0,get:function(){return Ie.lengthTouch}});var we=a(78);Object.defineProperty(t,"magnify",{enumerable:!0,get:function(){return we.magnify}}),Object.defineProperty(t,"magnifyTouchDrag",{enumerable:!0,get:function(){return we.magnifyTouchDrag}});var Le=a(44);Object.defineProperty(t,"mouseButtonRectangleTool",{enumerable:!0,get:function(){return ot(Le).default}});var De=a(10);Object.defineProperty(t,"mouseButtonTool",{enumerable:!0,get:function(){return ot(De).default}});var Ue=a(24);Object.defineProperty(t,"mouseWheelTool",{enumerable:!0,get:function(){return ot(Ue).default}});var Ae=a(29);Object.defineProperty(t,"multiTouchDragTool",{enumerable:!0,get:function(){return ot(Ae).default}});var Re=a(77);Object.defineProperty(t,"orientationMarkers",{enumerable:!0,get:function(){return ot(Re).default}});var ke=a(76);Object.defineProperty(t,"pan",{enumerable:!0,get:function(){return ke.pan}}),Object.defineProperty(t,"panTouchDrag",{enumerable:!0,get:function(){return ke.panTouchDrag}});var je=a(75);Object.defineProperty(t,"panMultiTouch",{enumerable:!0,get:function(){return ot(je).default}});var He=a(74);Object.defineProperty(t,"probe",{enumerable:!0,get:function(){return He.probe}}),Object.defineProperty(t,"probeTouch",{enumerable:!0,get:function(){return He.probeTouch}});var Ne=a(73);Object.defineProperty(t,"rectangleRoi",{enumerable:!0,get:function(){return Ne.rectangleRoi}}),Object.defineProperty(t,"rectangleRoiTouch",{enumerable:!0,get:function(){return Ne.rectangleRoiTouch}});var Ve=a(72);Object.defineProperty(t,"rotate",{enumerable:!0,get:function(){return Ve.rotate}}),Object.defineProperty(t,"rotateTouchDrag",{enumerable:!0,get:function(){return Ve.rotateTouchDrag}});var Be=a(70);Object.defineProperty(t,"rotateTouch",{enumerable:!0,get:function(){return ot(Be).default}});var We=a(69);Object.defineProperty(t,"saveAs",{enumerable:!0,get:function(){return ot(We).default}});var Ge=a(68);Object.defineProperty(t,"scaleOverlayTool",{enumerable:!0,get:function(){return ot(Ge).default}});var Fe=a(67);Object.defineProperty(t,"seedAnnotate",{enumerable:!0,get:function(){return Fe.seedAnnotate}}),Object.defineProperty(t,"seedAnnotateTouch",{enumerable:!0,get:function(){return Fe.seedAnnotateTouch}});var Ye=a(66);Object.defineProperty(t,"simpleAngle",{enumerable:!0,get:function(){return Ye.simpleAngle}}),Object.defineProperty(t,"simpleAngleTouch",{enumerable:!0,get:function(){return Ye.simpleAngleTouch}});var ze=a(15);Object.defineProperty(t,"simpleMouseButtonTool",{enumerable:!0,get:function(){return ot(ze).default}});var Ke=a(65);Object.defineProperty(t,"textMarker",{enumerable:!0,get:function(){return Ke.textMarker}}),Object.defineProperty(t,"textMarkerTouch",{enumerable:!0,get:function(){return Ke.textMarkerTouch}});var qe=a(16);Object.defineProperty(t,"touchDragTool",{enumerable:!0,get:function(){return ot(qe).default}});var Xe=a(43);Object.defineProperty(t,"touchPinchTool",{enumerable:!0,get:function(){return ot(Xe).default}});var Ze=a(11);Object.defineProperty(t,"touchTool",{enumerable:!0,get:function(){return ot(Ze).default}});var Je=a(64);Object.defineProperty(t,"wwwc",{enumerable:!0,get:function(){return Je.wwwc}}),Object.defineProperty(t,"wwwcTouchDrag",{enumerable:!0,get:function(){return Je.wwwcTouchDrag}});var Qe=a(63);Object.defineProperty(t,"wwwcRegion",{enumerable:!0,get:function(){return Qe.wwwcRegion}}),Object.defineProperty(t,"wwwcRegionTouch",{enumerable:!0,get:function(){return Qe.wwwcRegionTouch}});var $e=a(62);Object.defineProperty(t,"zoom",{enumerable:!0,get:function(){return $e.zoom}}),Object.defineProperty(t,"zoomWheel",{enumerable:!0,get:function(){return $e.zoomWheel}}),Object.defineProperty(t,"zoomTouchPinch",{enumerable:!0,get:function(){return $e.zoomTouchPinch}}),Object.defineProperty(t,"zoomTouchDrag",{enumerable:!0,get:function(){return $e.zoomTouchDrag}});var et=a(61);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return et.brush}});var tt=a(60);Object.defineProperty(t,"adaptiveBrush",{enumerable:!0,get:function(){return tt.adaptiveBrush}});var at=a(59);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return ot(at).default}});var nt=a(3);function ot(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"setToolOptions",{enumerable:!0,get:function(){return nt.setToolOptions}}),Object.defineProperty(t,"getToolOptions",{enumerable:!0,get:function(){return nt.getToolOptions}})}])});
//# sourceMappingURL=cornerstoneTools.min.js.map